{"name": "1580_D. Subsequence", "description": "Alice has an integer sequence a of length n and all elements are different. She will choose a subsequence of a of length m, and defines the value of a subsequence a_{b_1},a_{b_2},\u2026,a_{b_m} as $$$\u2211_{i = 1}^m (m \u22c5 a_{b_i}) - \u2211_{i = 1}^m \u2211_{j = 1}^m f(min(b_i, b_j), max(b_i, b_j)), where f(i, j) denotes \\min(a_i, a_{i + 1}, \\ldots, a_j)$$$.\n\nAlice wants you to help her to maximize the value of the subsequence she choose.\n\nA sequence s is a subsequence of a sequence t if s can be obtained from t by deletion of several (possibly, zero or all) elements.\n\nInput\n\nThe first line contains two integers n and m (1 \u2264 m \u2264 n \u2264 4000).\n\nThe second line contains n distinct integers a_1, a_2, \u2026, a_n (1 \u2264 a_i < 2^{31}).\n\nOutput\n\nPrint the maximal value Alice can get.\n\nExamples\n\nInput\n\n\n6 4\n15 2 18 12 13 4\n\n\nOutput\n\n\n100\n\n\nInput\n\n\n11 5\n9 3 7 1 8 12 10 20 15 18 5\n\n\nOutput\n\n\n176\n\n\nInput\n\n\n1 1\n114514\n\n\nOutput\n\n\n0\n\n\nInput\n\n\n2 1\n666 888\n\n\nOutput\n\n\n0\n\nNote\n\nIn the first example, Alice can choose the subsequence [15, 2, 18, 13], which has the value 4 \u22c5 (15 + 2 + 18 + 13) - (15 + 2 + 2 + 2) - (2 + 2 + 2 + 2) - (2 + 2 + 18 + 12) - (2 + 2 + 12 + 13) = 100. In the second example, there are a variety of subsequences with value 176, and one of them is [9, 7, 12, 20, 18].", "tags": ["brute force", "divide and conquer", "dp", "greedy", "trees"], "difficulty": 10, "id": 1580, "sample_io": [{"input": "6 4\n15 2 18 12 13 4\n", "output": ["100\n"]}, {"input": "1 1\n114514\n", "output": ["0\n"]}, {"input": "2 1\n666 888\n", "output": ["0\n"]}, {"input": "11 5\n9 3 7 1 8 12 10 20 15 18 5\n", "output": ["176\n"]}], "test_list": [{"input": "10 4\n1487140772 1794287649 13129572 1810649302 546050039 1119095648 793917425 690286369 113135373 1777353416\n", "output": ["17880739043\n"]}, {"input": "4 2\n1503703198 1592420633 1937648355 1163333781\n", "output": ["774314574\n"]}, {"input": "7 3\n2 10 7 3 6 8 4\n", "output": ["26\n"]}, {"input": "10 10\n8 10 4 7 3 9 6 1 5 2\n", "output": ["293\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 1248976576 1369337134\n", "output": ["1865743947\n"]}, {"input": "4 3\n1503703198 1592420633 1937648355 1163333781\n", "output": ["1548629148\n"]}, {"input": "7 3\n0 10 7 3 6 8 4\n", "output": ["30\n"]}, {"input": "10 10\n8 10 4 13 3 9 6 1 5 2\n", "output": ["347\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 1248976576 605716761\n", "output": ["1865743947\n"]}, {"input": "6 4\n15 2 18 12 1 4\n", "output": ["109\n"]}, {"input": "1 1\n191282\n", "output": ["0\n"]}, {"input": "11 5\n9 3 7 0 8 12 10 20 15 18 5\n", "output": ["188\n"]}, {"input": "4 3\n1503703198 1592420633 1937648355 1062718094\n", "output": ["1749860522\n"]}, {"input": "6 6\n15 2 18 12 1 4\n", "output": ["198\n"]}, {"input": "4 2\n1503703198 1592420633 1937648355 1062718094\n", "output": ["874930261\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 1962366591 1191833267\n", "output": ["2288726920\n"]}, {"input": "10 4\n1487140772 1794287649 13129572 1810649302 546050039 1452219000 793917425 690286369 113135373 1777353416\n", "output": ["18880109099\n"]}, {"input": "3 2\n1503703198 1592420633 1937648355 1163333781\n", "output": ["433945157\n"]}, {"input": "7 5\n2 10 7 3 6 8 4\n", "output": ["66\n"]}, {"input": "6 4\n15 2 18 6 13 4\n", "output": ["112\n"]}, {"input": "3 3\n1503703198 1592420633 1937648355 1163333781\n", "output": ["867890314\n"]}, {"input": "10 10\n8 10 4 13 0 9 6 1 5 2\n", "output": ["434\n"]}, {"input": "5 3\n1407237913 540438792 1539383618 1248976576 605716761\n", "output": ["3731487894\n"]}, {"input": "2 2\n666 1425\n", "output": ["759\n"]}, {"input": "11 5\n9 6 7 0 8 12 10 20 15 18 5\n", "output": ["182\n"]}, {"input": "6 6\n15 2 9 12 1 4\n", "output": ["159\n"]}, {"input": "6 6\n15 2 18 19 1 0\n", "output": ["211\n"]}, {"input": "3 2\n1503703198 1232954195 1937648355 1163333781\n", "output": ["975443163\n"]}, {"input": "7 5\n2 10 7 0 6 8 4\n", "output": ["98\n"]}, {"input": "3 3\n1181699175 1592420633 1937648355 1163333781\n", "output": ["1511898360\n"]}, {"input": "5 3\n1407237913 540438792 292718372 1248976576 605716761\n", "output": ["4141555490\n"]}, {"input": "2 2\n666 1648\n", "output": ["982\n"]}, {"input": "3 2\n1503703198 1232954195 1341199022 1163333781\n", "output": ["378993830\n"]}, {"input": "5 2\n727908733 540438792 1186826553 1962366591 898727019\n", "output": ["1609397740\n"]}, {"input": "3 2\n1503703198 1232954195 1147422227 1163333781\n", "output": ["356280971\n"]}, {"input": "5 2\n727908733 540438792 1186826553 1234898393 898727019\n", "output": ["881929542\n"]}, {"input": "3 2\n1503703198 1232954195 397913400 1163333781\n", "output": ["1105789798\n"]}, {"input": "5 2\n727908733 540438792 1186826553 2028237552 898727019\n", "output": ["1675268701\n"]}, {"input": "3 2\n1503703198 1232954195 105399621 1163333781\n", "output": ["1398303577\n"]}, {"input": "2 2\n727908733 540438792 1186826553 2028237552 898727019\n", "output": ["187469941\n"]}, {"input": "4 2\n727908733 540438792 1186826553 1360298635 898727019\n", "output": ["1007329784\n"]}, {"input": "5 2\n1407237913 465425380 1894537561 543364991 1369337134\n", "output": ["2370924714\n"]}, {"input": "4 3\n727908733 540438792 1186826553 1360298635 898727019\n", "output": ["2014659568\n"]}, {"input": "4 3\n727908733 540438792 214891002 1360298635 898727019\n", "output": ["3316850728\n"]}, {"input": "5 2\n1138365749 465425380 1894537561 543364991 419767329\n", "output": ["2102052550\n"]}, {"input": "4 3\n263495869 540438792 214891002 1360298635 898727019\n", "output": ["2941910846\n"]}, {"input": "4 3\n299375947 569448847 214891002 1360298635 898727019\n", "output": ["2999930956\n"]}, {"input": "4 3\n299375947 538017659 214891002 1360298635 898727019\n", "output": ["2937068580\n"]}, {"input": "4 3\n299375947 538017659 214891002 135467918 898727019\n", "output": ["805099482\n"]}, {"input": "4 3\n555952768 538017659 214891002 135467918 898727019\n", "output": ["840969700\n"]}, {"input": "4 3\n555952768 33522765 214891002 135467918 898727019\n", "output": ["1407596480\n"]}, {"input": "4 3\n555952768 33522765 226348875 68073946 825066423\n", "output": ["1430512226\n"]}, {"input": "10 4\n1487140772 1794287649 13129572 1810649302 546050039 1119095648 793917425 690286369 166598936 1777353416\n", "output": ["17666884791\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 1248976576 1669213333\n", "output": ["1995573662\n"]}, {"input": "6 4\n15 2 18 12 13 7\n", "output": ["100\n"]}, {"input": "11 5\n9 3 7 1 8 12 10 20 15 27 5\n", "output": ["212\n"]}, {"input": "10 10\n12 10 4 13 3 9 6 1 5 2\n", "output": ["379\n"]}, {"input": "6 4\n3 2 18 12 1 4\n", "output": ["73\n"]}, {"input": "2 2\n1503703198 1592420633 1937648355 1062718094\n", "output": ["88717435\n"]}, {"input": "3 3\n1089527545 1592420633 1937648355 1163333781\n", "output": ["1696241620\n"]}, {"input": "7 5\n2 10 14 3 6 8 4\n", "output": ["88\n"]}, {"input": "6 4\n15 2 18 11 13 4\n", "output": ["102\n"]}, {"input": "5 3\n1407237913 744513163 1539383618 1248976576 605716761\n", "output": ["3192783214\n"]}, {"input": "8 5\n9 6 7 0 8 12 10 20 15 18 5\n", "output": ["160\n"]}, {"input": "6 6\n23 2 9 12 1 4\n", "output": ["199\n"]}, {"input": "5 2\n1637630642 540438792 1539383618 1962366591 898727019\n", "output": ["2519119649\n"]}, {"input": "3 2\n1670130509 1232954195 1937648355 1163333781\n", "output": ["1141870474\n"]}, {"input": "6 4\n15 2 36 6 13 7\n", "output": ["166\n"]}, {"input": "3 3\n1503703198 1232954195 1341199022 1163333781\n", "output": ["757987660\n"]}, {"input": "5 2\n727908733 805135562 1186826553 1962366591 898727019\n", "output": ["1234457858\n"]}, {"input": "5 2\n727908733 540438792 1186826553 1982863139 898727019\n", "output": ["1629894288\n"]}, {"input": "5 2\n727908733 783018005 1186826553 2028237552 898727019\n", "output": ["1300328819\n"]}, {"input": "4 2\n37811525 540438792 1186826553 2028237552 898727019\n", "output": ["1990426027\n"]}, {"input": "4 2\n591714606 540438792 1186826553 1360298635 898727019\n", "output": ["871135657\n"]}, {"input": "5 2\n1407237913 187410372 1894537561 543364991 1369337134\n", "output": ["2926954730\n"]}, {"input": "5 2\n1407237913 433301385 1894537561 543364991 419767329\n", "output": ["2435172704\n"]}, {"input": "4 3\n885516074 540438792 214891002 1360298635 898727019\n", "output": ["3632065410\n"]}, {"input": "5 2\n599498911 465425380 1894537561 543364991 419767329\n", "output": ["1563185712\n"]}, {"input": "4 3\n263495869 540438792 214891002 659233274 898727019\n", "output": ["1539780124\n"]}, {"input": "3 3\n299375947 540438792 214891002 1360298635 898727019\n", "output": ["651095580\n"]}, {"input": "4 3\n299375947 1001267396 214891002 1360298635 898727019\n", "output": ["3863568054\n"]}, {"input": "4 3\n299375947 538017659 214891002 263144656 898727019\n", "output": ["742760622\n"]}, {"input": "4 3\n610190261 33522765 214891002 135467918 898727019\n", "output": ["1516071466\n"]}, {"input": "4 3\n555952768 57531821 226348875 68073946 825066423\n", "output": ["1334476002\n"]}, {"input": "10 4\n1487140772 1794287649 13129572 1810649302 546050039 1119095648 793917425 690286369 166598936 1093649441\n", "output": ["15615772866\n"]}, {"input": "6 4\n15 2 33 12 13 7\n", "output": ["145\n"]}, {"input": "11 2\n9 3 7 1 8 12 10 20 15 27 5\n", "output": ["34\n"]}, {"input": "6 4\n3 2 8 12 1 4\n", "output": ["51\n"]}, {"input": "2 2\n666 930\n", "output": ["264\n"]}, {"input": "4 3\n1074300537 1592420633 2852504 1062718094\n", "output": ["5298867438\n"]}, {"input": "7 5\n2 10 14 3 7 8 4\n", "output": ["90\n"]}, {"input": "3 3\n1910876004 1592420633 1937648355 2151782019\n", "output": ["1327366186\n"]}, {"input": "6 4\n15 2 54 6 13 7\n", "output": ["220\n"]}, {"input": "5 2\n727908733 805135562 1186826553 1962366591 364664847\n", "output": ["1597701744\n"]}, {"input": "5 2\n727908733 603358798 1186826553 2028237552 898727019\n", "output": ["1549428689\n"]}, {"input": "5 4\n1407237913 187410372 1894537561 543364991 1369337134\n", "output": ["11614735238\n"]}, {"input": "5 2\n599498911 465425380 1894537561 543364991 305660254\n", "output": ["1588877307\n"]}, {"input": "4 3\n263495869 540438792 135777707 659233274 898727019\n", "output": ["1856233304\n"]}, {"input": "5 2\n628751430 465425380 1894537561 125778642 419767329\n", "output": ["2062747606\n"]}, {"input": "4 2\n299375947 1001267396 214891002 1360298635 898727019\n", "output": ["1931784027\n"]}, {"input": "4 3\n299375947 327913415 214891002 263144656 898727019\n", "output": ["322552134\n"]}, {"input": "10 4\n1487140772 1794287649 13129572 372804952 546050039 1119095648 793917425 690286369 166598936 1093649441\n", "output": ["13070004538\n"]}, {"input": "6 4\n15 2 33 22 13 7\n", "output": ["152\n"]}, {"input": "6 4\n3 2 8 5 1 4\n", "output": ["36\n"]}, {"input": "2 2\n666 803\n", "output": ["137\n"]}, {"input": "4 3\n1737675370 1592420633 2852504 1062718094\n", "output": ["5589376912\n"]}, {"input": "3 2\n1503703198 1592420633 981792769 1062718094\n", "output": ["610627864\n"]}, {"input": "7 5\n2 10 14 3 12 8 4\n", "output": ["108\n"]}, {"input": "6 4\n15 2 54 12 13 7\n", "output": ["208\n"]}, {"input": "3 2\n1503703198 1467780051 235552759 2150777057\n", "output": ["1268150439\n"]}, {"input": "5 3\n727908733 603358798 1186826553 2028237552 898727019\n", "output": ["3098857378\n"]}, {"input": "5 4\n1407237913 187410372 1894537561 769376164 1369337134\n", "output": ["11162712892\n"]}, {"input": "4 3\n885516074 540438792 220824694 1360298635 1158469384\n", "output": ["3608330642\n"]}, {"input": "5 2\n599498911 465425380 1894537561 543364991 276188184\n", "output": ["1618349377\n"]}, {"input": "4 3\n263495869 724553809 135777707 659233274 898727019\n", "output": ["2224463338\n"]}, {"input": "5 4\n628751430 465425380 1894537561 125778642 419767329\n", "output": ["7017867706\n"]}, {"input": "4 2\n299375947 1230326512 214891002 1360298635 898727019\n", "output": ["2160843143\n"]}, {"input": "10 4\n1487140772 1794287649 13129572 372804952 546050039 1119095648 793917425 1169188220 166598936 1093649441\n", "output": ["13220282254\n"]}, {"input": "6 4\n3 2 8 5 0 4\n", "output": ["42\n"]}, {"input": "2 2\n731 803\n", "output": ["72\n"]}, {"input": "4 3\n1737675370 1592420633 4133660 1062718094\n", "output": ["5584252288\n"]}, {"input": "4 3\n1910876004 1592420633 1937648355 1310821610\n", "output": ["1890564232\n"]}, {"input": "5 2\n172836230 805135562 1186826553 1962366591 364664847\n", "output": ["1789530361\n"]}, {"input": "4 2\n28840035 540438792 1908319607 2028237552 898727019\n", "output": ["1999397517\n"]}, {"input": "2 1\n666 1425\n", "output": ["0\n"]}, {"input": "7 0\n0 10 7 3 6 8 4\n", "output": ["0\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 1248976576 1191833267\n", "output": ["1865743947\n"]}, {"input": "1 1\n317144\n", "output": ["0\n"]}, {"input": "2 0\n666 1425\n", "output": ["0\n"]}, {"input": "7 0\n0 10 7 1 6 8 4\n", "output": ["0\n"]}, {"input": "6 6\n15 2 18 12 1 0\n", "output": ["188\n"]}, {"input": "2 0\n666 2098\n", "output": ["0\n"]}, {"input": "6 0\n15 2 18 12 1 0\n", "output": ["0\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 539778010 1369337134\n", "output": ["1865743947\n"]}, {"input": "1 1\n219323\n", "output": ["0\n"]}, {"input": "1 1\n96934\n", "output": ["0\n"]}, {"input": "4 1\n1503703198 1592420633 1937648355 1062718094\n", "output": ["0\n"]}, {"input": "7 0\n0 10 7 3 6 13 4\n", "output": ["0\n"]}, {"input": "5 0\n1407237913 540438792 1539383618 1248976576 1191833267\n", "output": ["0\n"]}, {"input": "1 1\n400750\n", "output": ["0\n"]}, {"input": "2 0\n666 1005\n", "output": ["0\n"]}, {"input": "4 0\n1503703198 1592420633 1937648355 1062718094\n", "output": ["0\n"]}, {"input": "5 0\n0 10 7 1 6 8 4\n", "output": ["0\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 1962366591 898727019\n", "output": ["2288726920\n"]}, {"input": "2 0\n756 2098\n", "output": ["0\n"]}, {"input": "5 1\n1407237913 540438792 1539383618 539778010 1369337134\n", "output": ["0\n"]}, {"input": "6 4\n15 2 18 6 13 7\n", "output": ["112\n"]}, {"input": "1 1\n298030\n", "output": ["0\n"]}, {"input": "4 0\n1503703198 1592420633 1937648355 234732785\n", "output": ["0\n"]}, {"input": "3 0\n0 10 7 3 6 13 4\n", "output": ["0\n"]}, {"input": "6 0\n15 2 9 12 1 4\n", "output": ["0\n"]}, {"input": "1 0\n400750\n", "output": ["0\n"]}, {"input": "2 0\n868 1005\n", "output": ["0\n"]}, {"input": "4 0\n1503703198 1271590979 1937648355 1062718094\n", "output": ["0\n"]}, {"input": "5 2\n1407237913 540438792 1186826553 1962366591 898727019\n", "output": ["2288726920\n"]}, {"input": "5 1\n1407237913 540438792 1539383618 455160833 1369337134\n", "output": ["0\n"]}, {"input": "3 3\n1181699175 1513071694 1937648355 1163333781\n", "output": ["1511898360\n"]}, {"input": "5 0\n1407237913 540438792 292718372 1248976576 605716761\n", "output": ["0\n"]}, {"input": "3 0\n1 10 7 3 6 13 4\n", "output": ["0\n"]}, {"input": "6 0\n15 2 6 12 1 4\n", "output": ["0\n"]}, {"input": "4 1\n1503703198 1271590979 1937648355 1062718094\n", "output": ["0\n"]}, {"input": "5 1\n1407237913 540438792 1539383618 790171268 1369337134\n", "output": ["0\n"]}, {"input": "5 0\n1407237913 263116244 292718372 1248976576 605716761\n", "output": ["0\n"]}, {"input": "3 0\n1 10 7 3 6 0 4\n", "output": ["0\n"]}, {"input": "6 0\n15 2 0 12 1 4\n", "output": ["0\n"]}, {"input": "4 1\n1503703198 1508898747 1937648355 1062718094\n", "output": ["0\n"]}, {"input": "5 1\n1407237913 540438792 1539383618 543364991 1369337134\n", "output": ["0\n"]}, {"input": "3 0\n2 10 7 3 6 0 4\n", "output": ["0\n"]}, {"input": "4 1\n1503703198 1508898747 1937648355 1130718435\n", "output": ["0\n"]}, {"input": "5 1\n1407237913 921135768 1539383618 543364991 1369337134\n", "output": ["0\n"]}, {"input": "3 0\n2 10 7 3 6 0 2\n", "output": ["0\n"]}, {"input": "4 1\n1503703198 918133333 1937648355 1130718435\n", "output": ["0\n"]}, {"input": "5 1\n1407237913 465425380 1539383618 543364991 1369337134\n", "output": ["0\n"]}, {"input": "3 0\n2 10 7 3 6 -1 2\n", "output": ["0\n"]}, {"input": "4 2\n727908733 540438792 1186826553 2028237552 898727019\n", "output": ["1675268701\n"]}, {"input": "5 1\n1407237913 465425380 1894537561 543364991 1369337134\n", "output": ["0\n"]}, {"input": "3 0\n2 9 7 3 6 -1 2\n", "output": ["0\n"]}, {"input": "2 0\n2 9 7 3 6 -1 2\n", "output": ["0\n"]}, {"input": "5 2\n1407237913 465425380 1894537561 543364991 419767329\n", "output": ["2370924714\n"]}, {"input": "2 0\n2 9 7 3 10 -1 2\n", "output": ["0\n"]}, {"input": "2 0\n2 9 10 3 10 -1 2\n", "output": ["0\n"]}, {"input": "5 2\n1138365749 465425380 1894537561 841230151 419767329\n", "output": ["2102052550\n"]}, {"input": "4 3\n299375947 540438792 214891002 1360298635 898727019\n", "output": ["2941910846\n"]}, {"input": "4 3\n555952768 33522765 214891002 135467918 825066423\n", "output": ["1407596480\n"]}, {"input": "4 3\n555952768 33522765 214891002 68073946 825066423\n", "output": ["1407596480\n"]}, {"input": "1 1\n126654\n", "output": ["0\n"]}, {"input": "2 1\n666 25\n", "output": ["0\n"]}, {"input": "7 3\n0 10 7 3 6 8 2\n", "output": ["30\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 1248976576 544176402\n", "output": ["1865743947\n"]}, {"input": "1 1\n225928\n", "output": ["0\n"]}, {"input": "2 1\n666 930\n", "output": ["0\n"]}, {"input": "4 3\n1074300537 1592420633 1937648355 1062718094\n", "output": ["1749860522\n"]}, {"input": "7 0\n0 10 7 3 5 8 4\n", "output": ["0\n"]}, {"input": "5 2\n1407237913 540438792 1539383618 607576621 1191833267\n", "output": ["1865743947\n"]}, {"input": "1 1\n551203\n", "output": ["0\n"]}, {"input": "5 0\n1407237913 540438792 1539383618 1962366591 1191833267\n", "output": ["0\n"]}, {"input": "2 0\n512 2098\n", "output": ["0\n"]}, {"input": "6 0\n15 2 18 4 1 0\n", "output": ["0\n"]}, {"input": "3 3\n1503703198 1592420633 1937648355 2151782019\n", "output": ["867890314\n"]}, {"input": "1 1\n79714\n", "output": ["0\n"]}, {"input": "7 0\n0 10 9 3 6 13 4\n", "output": ["0\n"]}, {"input": "5 0\n1407237913 525172395 1539383618 1248976576 1191833267\n", "output": ["0\n"]}, {"input": "1 1\n282953\n", "output": ["0\n"]}, {"input": "4 0\n1503703198 1592420633 988218684 1062718094\n", "output": ["0\n"]}, {"input": "5 0\n0 3 7 1 6 8 4\n", "output": ["0\n"]}], "source_codes": [""], "responses": ["'gbk' codec can't encode character '\\u22c5' in position 423: illegal multibyte sequence"], "prompt_tokens": [0], "completion_tokens": [0], "no_of_try": 1, "is_solved": false, "language": "Python3", "task_id": 1580}
