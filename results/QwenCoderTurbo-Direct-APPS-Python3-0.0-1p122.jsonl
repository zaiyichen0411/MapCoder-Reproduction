{"name": "2144", "description": "Ujan has a lot of numbers in his boxes. He likes order and balance, so he decided to reorder the numbers.\n\nThere are $k$ boxes numbered from $1$ to $k$. The $i$-th box contains $n_i$ integer numbers. The integers can be negative. All of the integers are distinct. \n\nUjan is lazy, so he will do the following reordering of the numbers exactly once. He will pick a single integer from each of the boxes, $k$ integers in total. Then he will insert the chosen numbers\u00a0\u2014 one integer in each of the boxes, so that the number of integers in each box is the same as in the beginning. Note that he may also insert an integer he picked from a box back into the same box.\n\nUjan will be happy if the sum of the integers in each box is the same. Can he achieve this and make the boxes perfectly balanced, like all things should be?\n\n\n-----Input-----\n\nThe first line contains a single integer $k$ ($1 \\leq k \\leq 15$), the number of boxes. \n\nThe $i$-th of the next $k$ lines first contains a single integer $n_i$ ($1 \\leq n_i \\leq 5\\,000$), the number of integers in box $i$. Then the same line contains $n_i$ integers $a_{i,1}, \\ldots, a_{i,n_i}$ ($|a_{i,j}| \\leq 10^9$), the integers in the $i$-th box. \n\nIt is guaranteed that all $a_{i,j}$ are distinct.\n\n\n-----Output-----\n\nIf Ujan cannot achieve his goal, output \"No\" in a single line. Otherwise in the first line output \"Yes\", and then output $k$ lines. The $i$-th of these lines should contain two integers $c_i$ and $p_i$. This means that Ujan should pick the integer $c_i$ from the $i$-th box and place it in the $p_i$-th box afterwards.\n\nIf there are multiple solutions, output any of those.\n\nYou can print each letter in any case (upper or lower).\n\n\n-----Examples-----\nInput\n4\n3 1 7 4\n2 3 2\n2 8 5\n1 10\n\nOutput\nYes\n7 2\n2 3\n5 1\n10 4\n\nInput\n2\n2 3 -2\n2 -1 5\n\nOutput\nNo\n\nInput\n2\n2 -10 10\n2 0 -20\n\nOutput\nYes\n-10 2\n-20 1\n\n\n\n-----Note-----\n\nIn the first sample, Ujan can put the number $7$ in the $2$nd box, the number $2$ in the $3$rd box, the number $5$ in the $1$st box and keep the number $10$ in the same $4$th box. Then the boxes will contain numbers $\\{1,5,4\\}$, $\\{3, 7\\}$, $\\{8,2\\}$ and $\\{10\\}$. The sum in each box then is equal to $10$.\n\nIn the second sample, it is not possible to pick and redistribute the numbers in the required way.\n\nIn the third sample, one can swap the numbers $-20$ and $-10$, making the sum in each box equal to $-10$.", "difficulty": "competition", "id": 2144, "sample_io": [{"input": "4\n3 1 7 4\n2 3 2\n2 8 5\n1 10\n", "output": ["Yes\n7 2\n2 3\n5 1\n10 4\n"]}, {"input": "2\n2 3 -2\n2 -1 5\n", "output": ["No\n"]}, {"input": "2\n2 -10 10\n2 0 -20\n", "output": ["Yes\n-10 2\n-20 1\n"]}], "test_list": [{"input": "4\n3 1 7 4\n2 3 2\n2 8 5\n1 10\n", "output": ["Yes\n7 2\n2 3\n5 1\n10 4\n"]}, {"input": "2\n2 3 -2\n2 -1 5\n", "output": ["No\n"]}, {"input": "2\n2 -10 10\n2 0 -20\n", "output": ["Yes\n-10 2\n-20 1\n"]}, {"input": "1\n1 0\n", "output": ["Yes\n0 1\n"]}, {"input": "3\n1 20\n2 30 40\n3 50 60 80\n", "output": ["No\n"]}, {"input": "3\n3 1 3 100\n2 4 104\n2 2 102\n", "output": ["No\n"]}, {"input": "4\n3 80 1 10\n3 52 19 24\n3 27 46 29\n3 74 13 25\n", "output": ["No\n"]}, {"input": "2\n5 -1000000000 999999999 -999999998 999999997 0\n5 1000000000 -999999999 999999998 -999999997 4\n", "output": ["Yes\n0 2\n4 1\n"]}, {"input": "5\n10 -251 650 475 -114 364 -75754 -982 -532 -151 -484\n10 -623 -132 -317561 -438 20 -275 -323 -530089 -311 -587\n10 450900 -519 903 -401 -789 -606529 277 -267 -682 -161\n10 -246 873 -641 838 719 234 789 -74 -287288 -772972\n10 186 741 -927 -866 -855 578 -1057019 202 162962 -458\n", "output": ["Yes\n650 3\n-530089 1\n450900 5\n-287288 2\n162962 4\n"]}, {"input": "2\n2 1 2\n10 0 1000000000 999999999 999999998 999999997 999999996 999999995 999999994 999999993 589934621\n", "output": ["No\n"]}], "starter_code": "", "source_codes": ["\nimport sys\nimport itertools\n\ndef main():\n    import sys\n    input = sys.stdin.read\n    data = input().split()\n    \n    idx = 0\n    k = int(data[idx])\n    idx += 1\n    \n    boxes = []\n    for _ in range(k):\n        n_i = int(data[idx])\n        idx += 1\n        numbers = list(map(int, data[idx:idx + n_i]))\n        idx += n_i\n        boxes.append(numbers)\n    \n    # Precompute the sum of each box\n    box_sums = [sum(box) for box in boxes]\n    \n    # Try all possible selections of one number from each box\n    for selected in itertools.product(*boxes):\n        # Create a list of (box_index, value)\n        selected_with_indices = list(enumerate(selected))\n        \n        # Try to redistribute the selected numbers such that all boxes have the same sum\n        # The total sum of all selected numbers is total_selected\n        total_selected = sum(selected)\n        target_sum = total_selected // k\n        \n        # Check if the target sum is possible\n        if total_selected % k != 0:\n            continue\n        \n        # Try to find a permutation of the selected numbers that can be placed in the boxes\n        # such that the sum of each box is target_sum\n        # We will try all permutations of the selected numbers\n        for perm in itertools.permutations(selected):\n            new_box_sums = []\n            for i in range(k):\n                new_sum = box_sums[i] - selected[i] + perm[i]\n                new_box_sums.append(new_sum)\n            \n            if all(s == target_sum for s in new_box_sums):\n                # Found a valid solution\n                print(\"Yes\")\n                for i in range(k):\n                    print(selected_with_indices[i][1], perm[i] + 1)  # +1 for 1-based indexing\n                return\n    \n    print(\"No\")\n\nif __name__ == \"__main__\":\n    main()\n\n\n"], "responses": ["Here's a Python solution to the problem. The approach is to try all possible ways of selecting one number from each box and then checking if the sum of each box can be made equal by swapping those selected numbers.\n\nWe will use backtracking to try all possible selections and then check if a valid swap exists.\n\n```python\nimport sys\nimport itertools\n\ndef main():\n    import sys\n    input = sys.stdin.read\n    data = input().split()\n    \n    idx = 0\n    k = int(data[idx])\n    idx += 1\n    \n    boxes = []\n    for _ in range(k):\n        n_i = int(data[idx])\n        idx += 1\n        numbers = list(map(int, data[idx:idx + n_i]))\n        idx += n_i\n        boxes.append(numbers)\n    \n    # Precompute the sum of each box\n    box_sums = [sum(box) for box in boxes]\n    \n    # Try all possible selections of one number from each box\n    for selected in itertools.product(*boxes):\n        # Create a list of (box_index, value)\n        selected_with_indices = list(enumerate(selected))\n        \n        # Try to redistribute the selected numbers such that all boxes have the same sum\n        # The total sum of all selected numbers is total_selected\n        total_selected = sum(selected)\n        target_sum = total_selected // k\n        \n        # Check if the target sum is possible\n        if total_selected % k != 0:\n            continue\n        \n        # Try to find a permutation of the selected numbers that can be placed in the boxes\n        # such that the sum of each box is target_sum\n        # We will try all permutations of the selected numbers\n        for perm in itertools.permutations(selected):\n            new_box_sums = []\n            for i in range(k):\n                new_sum = box_sums[i] - selected[i] + perm[i]\n                new_box_sums.append(new_sum)\n            \n            if all(s == target_sum for s in new_box_sums):\n                # Found a valid solution\n                print(\"Yes\")\n                for i in range(k):\n                    print(selected_with_indices[i][1], perm[i] + 1)  # +1 for 1-based indexing\n                return\n    \n    print(\"No\")\n\nif __name__ == \"__main__\":\n    main()\n```"], "prompt_tokens": [892], "completion_tokens": [477], "no_of_try": 1, "is_solved": false, "language": "Python3", "task_id": 2144}
