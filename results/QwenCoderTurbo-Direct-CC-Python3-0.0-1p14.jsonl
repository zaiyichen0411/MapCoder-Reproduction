{"name": "1586_G. Omkar and Time Travel", "description": "El Psy Kongroo.\n\nOmkar is watching Steins;Gate.\n\nIn Steins;Gate, Okabe Rintarou needs to complete n tasks (1 \u2264 n \u2264 2 \u22c5 10^5). Unfortunately, he doesn't know when he needs to complete the tasks.\n\nInitially, the time is 0. Time travel will now happen according to the following rules:\n\n  * For each k = 1, 2, \u2026, n, Okabe will realize at time b_k that he was supposed to complete the k-th task at time a_k (a_k < b_k). \n\n  * When he realizes this, if k-th task was already completed at time a_k, Okabe keeps the usual flow of time. Otherwise, he time travels to time a_k then immediately completes the task.\n\n  * If Okabe time travels to time a_k, all tasks completed after this time will become incomplete again. That is, for every j, if a_j>a_k, the j-th task will become incomplete, if it was complete (if it was incomplete, nothing will change).\n\n  * Okabe has bad memory, so he can time travel to time a_k only immediately after getting to time b_k and learning that he was supposed to complete the k-th task at time a_k. That is, even if Okabe already had to perform k-th task before, he wouldn't remember it before stumbling on the info about this task at time b_k again.\n\n\n\n\nPlease refer to the notes for an example of time travelling.\n\nThere is a certain set s of tasks such that the first moment that all of the tasks in s are simultaneously completed (regardless of whether any other tasks are currently completed), a funny scene will take place. Omkar loves this scene and wants to know how many times Okabe will time travel before this scene takes place. Find this number modulo 10^9 + 7. It can be proven that eventually all n tasks will be completed and so the answer always exists.\n\nInput\n\nThe first line contains an integer n (1 \u2264 n \u2264 2 \u22c5 10^5) \u2014 the number of tasks that Okabe needs to complete.\n\nn lines follow. The k-th of these lines contain two integers a_k and b_k (1 \u2264 a_k < b_k \u2264 2n) \u2014 the time at which Okabe needs to complete the k-th task and the time that he realizes this respectively. All 2n of these times are distinct (so every time from 1 to 2n inclusive appears exactly once in the input).\n\nThe next line contains a single integer t (1 \u2264 t \u2264 n) \u2014 the size of the set s of tasks that lead to the funny scene.\n\nThe last line contains t integers s_1, s_2, \u2026, s_t \u2014 (1 \u2264 s_k \u2264 n, the numbers s_1, s_2, \u2026, s_t are distinct) \u2014 the set s of tasks.\n\nOutput\n\nOutput a single integer \u2014 the number of times that Okabe time travels until all tasks in the set s are simultaneously completed, modulo 10^9 + 7.\n\nExamples\n\nInput\n\n\n2\n1 4\n2 3\n2\n1 2\n\n\nOutput\n\n\n3\n\n\nInput\n\n\n2\n1 4\n2 3\n1\n1\n\n\nOutput\n\n\n2\n\n\nInput\n\n\n1\n1 2\n1\n1\n\n\nOutput\n\n\n1\n\n\nInput\n\n\n6\n10 12\n3 7\n4 6\n2 9\n5 8\n1 11\n3\n2 4 6\n\n\nOutput\n\n\n17\n\n\nInput\n\n\n16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n6\n3 8 2 5 12 11\n\n\nOutput\n\n\n138\n\nNote\n\nFor the first sample, all tasks need to be completed in order for the funny scene to occur.\n\nInitially, the time is 0. Nothing happens until time 3, when Okabe realizes that he should have done the 2-nd task at time 2. He then time travels to time 2 and completes the task.\n\nAs the task is done now, he does not time travel again when the time is again 3. However, at time 4, he travels to time 1 to complete the 1-st task.\n\nThis undoes the 2-nd task. This means that the 2-nd task is not currently completed, meaning that the funny scene will not occur at this point even though the 1-st task is currently completed and Okabe had previously completed the 2-nd task.\n\nOnce it is again time 3 he travels back to time 2 once more and does the 2-nd task again.\n\nNow all tasks are complete, with Okabe having time travelled 3 times.\n\nThe second sample has the same tasks for Okabe to complete. However, this time the funny scene only needs the first task to be completed in order to occur. From reading the above sample you can see that this occurs once Okabe has time travelled 2 times.", "tags": ["data structures", "dp", "math"], "difficulty": 13, "id": 1586, "sample_io": [{"input": "6\n10 12\n3 7\n4 6\n2 9\n5 8\n1 11\n3\n2 4 6\n", "output": ["17\n"]}, {"input": "1\n1 2\n1\n1\n", "output": ["1\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n6\n3 8 2 5 12 11\n", "output": ["138\n"]}, {"input": "2\n1 4\n2 3\n2\n1 2\n", "output": ["3\n"]}, {"input": "2\n1 4\n2 3\n1\n1\n", "output": ["2\n"]}], "test_list": [{"input": "50\n38 51\n26 42\n11 22\n9 16\n34 54\n19 49\n36 88\n66 92\n48 87\n23 86\n14 41\n45 81\n30 83\n13 24\n73 82\n10 96\n80 100\n5 97\n47 85\n43 55\n50 52\n3 32\n6 17\n31 89\n37 67\n56 64\n63 91\n33 75\n20 68\n15 27\n18 78\n4 40\n60 65\n69 99\n74 93\n58 94\n35 53\n1 12\n29 95\n46 79\n7 72\n44 76\n2 77\n28 98\n8 39\n57 70\n62 71\n59 84\n21 90\n25 61\n27\n28 40 34 42 2 9 11 50 23 19 46 35 17 27 29 5 32 30 41 39 20 8 48 26 10 14 16\n", "output": ["9235\n"]}, {"input": "20\n10 32\n7 29\n23 26\n4 25\n28 34\n21 38\n13 31\n18 22\n11 14\n9 35\n8 12\n5 40\n1 16\n17 20\n2 3\n27 37\n19 33\n24 30\n6 39\n15 36\n15\n5 8 13 19 9 2 6 10 1 7 11 17 20 3 16\n", "output": ["161\n"]}, {"input": "18\n3 25\n26 30\n2 22\n13 27\n7 31\n19 34\n14 18\n16 28\n32 33\n29 35\n12 17\n15 21\n5 8\n6 23\n1 9\n4 36\n10 11\n20 24\n1\n13\n", "output": ["1\n"]}, {"input": "17\n8 29\n10 16\n11 19\n4 28\n15 25\n9 34\n21 24\n17 32\n3 30\n22 31\n7 18\n2 6\n1 5\n14 33\n13 23\n12 27\n20 26\n8\n9 5 17 11 14 7 3 4\n", "output": ["117\n"]}, {"input": "30\n2 16\n47 60\n28 31\n3 37\n20 34\n25 59\n5 26\n4 8\n39 46\n6 14\n38 42\n27 55\n36 58\n12 48\n18 50\n40 57\n19 29\n11 45\n17 54\n13 22\n1 52\n7 15\n33 56\n21 44\n23 41\n32 43\n24 53\n9 49\n30 35\n10 51\n30\n29 20 9 25 19 15 1 6 27 12 18 23 14 24 28 10 13 26 21 30 2 3 17 16 7 8 11 4 5 22\n", "output": ["641\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n7\n17 5 13 1 3 19 21\n", "output": ["240\n"]}, {"input": "40\n5 35\n8 66\n33 51\n56 70\n43 78\n44 57\n3 20\n25 71\n7 64\n21 40\n24 28\n47 60\n61 72\n38 53\n16 63\n2 58\n41 52\n26 74\n11 48\n14 15\n22 75\n46 68\n29 31\n9 10\n23 77\n19 80\n62 73\n13 37\n6 30\n39 67\n55 59\n50 76\n17 79\n27 54\n18 42\n45 49\n4 34\n12 36\n32 65\n1 69\n20\n23 7 8 35 31 32 37 27 25 40 1 9 18 14 11 29 26 13 12 24\n", "output": ["2526\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n3\n5 1 13\n", "output": ["69\n"]}, {"input": "50\n38 51\n26 42\n11 22\n9 16\n34 54\n19 49\n36 88\n66 92\n48 87\n23 86\n14 41\n45 81\n30 83\n13 24\n73 82\n10 96\n80 100\n5 97\n47 85\n43 55\n50 52\n3 32\n6 17\n31 89\n37 67\n56 64\n63 91\n33 75\n20 68\n15 27\n18 78\n4 40\n60 65\n69 99\n74 93\n58 94\n35 53\n1 12\n29 95\n46 79\n7 72\n44 76\n2 77\n28 98\n8 39\n57 70\n62 71\n59 84\n21 90\n25 61\n27\n28 40 34 22 2 9 11 50 23 19 46 35 17 27 29 5 32 30 41 39 20 8 48 26 10 14 16\n", "output": ["9235\n"]}, {"input": "17\n8 29\n10 16\n11 19\n4 28\n15 25\n9 34\n21 24\n17 32\n3 30\n22 31\n7 18\n2 6\n1 5\n14 33\n13 23\n12 27\n20 26\n8\n8 5 17 11 14 7 3 4\n", "output": ["122\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n3\n5 1 14\n", "output": ["70\n"]}, {"input": "18\n3 25\n26 30\n2 22\n13 27\n7 31\n19 34\n14 18\n16 28\n32 33\n29 35\n12 17\n15 21\n5 8\n6 23\n1 9\n4 36\n10 11\n20 24\n1\n3\n", "output": ["8\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n3\n8 1 14\n", "output": ["64\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n3\n8 2 14\n", "output": ["11\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 3 19 21\n", "output": ["184\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 2 5 12 11\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n6\n3 8 1 5 12 11\n", "output": ["159\n"]}, {"input": "2\n1 4\n2 3\n1\n1 2\n", "output": ["2\n"]}, {"input": "2\n1 4\n2 3\n1\n2\n", "output": ["1\n"]}, {"input": "20\n10 32\n7 29\n23 26\n4 25\n28 34\n21 38\n13 31\n18 22\n11 14\n9 35\n8 12\n5 40\n1 16\n17 20\n2 3\n27 37\n19 33\n24 30\n6 39\n15 36\n15\n5 8 13 19 9 2 6 10 1 7 18 17 20 3 16\n", "output": ["161\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n2\n5 1 14\n", "output": ["69\n"]}, {"input": "18\n3 25\n26 30\n2 22\n13 27\n7 31\n19 34\n14 18\n16 28\n32 33\n29 35\n12 17\n15 21\n5 8\n6 23\n1 9\n4 36\n10 11\n20 24\n1\n2\n", "output": ["38\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 6 1 3 19 38\n", "output": ["143\n"]}, {"input": "6\n10 12\n3 7\n4 6\n2 9\n5 8\n1 11\n2\n2 4 6\n", "output": ["7\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n1\n5 1 14\n", "output": ["32\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 3 13 1 3 19 38\n", "output": ["115\n"]}, {"input": "17\n8 29\n10 16\n11 19\n4 28\n15 25\n9 34\n21 24\n17 32\n3 30\n22 31\n7 18\n2 6\n1 5\n14 33\n13 23\n12 27\n20 26\n8\n8 5 17 11 12 7 3 4\n", "output": ["110\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 9 6 9 12 11\n", "output": ["19\n"]}, {"input": "6\n10 12\n3 7\n4 6\n2 9\n5 8\n1 11\n2\n2 6 6\n", "output": ["12\n"]}, {"input": "40\n5 35\n8 66\n33 51\n56 70\n43 78\n44 57\n3 20\n25 71\n7 64\n21 40\n24 28\n47 60\n61 72\n38 53\n16 63\n2 58\n41 52\n26 74\n11 48\n14 15\n22 75\n46 68\n29 31\n9 10\n23 77\n19 80\n62 73\n13 37\n6 30\n39 67\n55 59\n50 76\n17 79\n27 54\n18 42\n45 49\n4 34\n12 36\n32 65\n1 69\n20\n5 7 8 35 31 32 37 27 25 40 1 9 18 14 11 29 26 13 12 24\n", "output": ["2545\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n3\n17 5 13 1 3 19 21\n", "output": ["181\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n14 5 13 1 3 19 38\n", "output": ["186\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n2\n8 1 14\n", "output": ["62\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 5 6 9 12 11\n", "output": ["79\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n3\n3 5 6 9 12 11\n", "output": ["81\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 9 6 1 3 19 38\n", "output": ["44\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 4 1 4 19 38\n", "output": ["231\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n3\n6 1 14\n", "output": ["64\n"]}, {"input": "50\n38 51\n26 42\n11 22\n9 16\n34 54\n19 49\n36 88\n66 92\n48 87\n23 86\n14 41\n45 81\n30 83\n13 24\n73 82\n10 96\n80 100\n5 97\n47 85\n43 55\n50 52\n3 32\n6 17\n31 89\n37 67\n56 64\n63 91\n33 75\n20 68\n15 27\n18 78\n4 40\n60 65\n69 99\n74 93\n58 94\n35 53\n1 12\n29 95\n46 79\n7 72\n44 76\n2 77\n28 98\n8 39\n57 70\n62 71\n59 84\n21 90\n25 61\n27\n28 40 34 42 2 9 11 50 23 19 46 35 17 27 29 5 32 30 49 39 20 8 48 26 10 14 16\n", "output": ["9235\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n6\n3 8 2 5 14 11\n", "output": ["138\n"]}, {"input": "2\n1 4\n2 3\n1\n1 1\n", "output": ["2\n"]}, {"input": "2\n1 4\n2 3\n1\n2 1\n", "output": ["1\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 3 19 38\n", "output": ["184\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 4 5 12 11\n", "output": ["138\n"]}, {"input": "2\n1 4\n2 3\n1\n2 2\n", "output": ["1\n"]}, {"input": "20\n10 32\n7 29\n23 26\n4 25\n28 34\n21 38\n13 31\n18 22\n11 14\n9 35\n8 12\n5 40\n1 16\n17 20\n2 3\n27 37\n19 33\n24 30\n6 39\n15 36\n15\n5 8 13 19 9 2 6 14 1 7 18 17 20 3 16\n", "output": ["161\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 4 9 12 11\n", "output": ["138\n"]}, {"input": "20\n10 32\n7 29\n23 26\n4 25\n28 34\n21 38\n13 31\n18 22\n11 14\n9 35\n8 12\n5 40\n1 16\n17 20\n2 3\n27 37\n19 33\n24 30\n6 39\n15 36\n15\n5 8 13 19 9 2 6 14 1 7 18 17 20 3 4\n", "output": ["159\n"]}, {"input": "20\n10 32\n7 29\n23 26\n4 25\n28 34\n21 38\n13 31\n18 22\n11 14\n9 35\n8 12\n5 40\n1 16\n17 20\n2 3\n27 37\n19 33\n24 30\n6 39\n15 36\n15\n5 11 13 19 9 2 6 14 1 7 18 17 20 3 16\n", "output": ["161\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 6 9 12 11\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n6 8 2 5 12 11\n", "output": ["138\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n2\n5 1 16\n", "output": ["69\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 1 19 21\n", "output": ["184\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 2 5 12 19\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n4 8 4 5 12 11\n", "output": ["138\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 6 1 4 19 38\n", "output": ["143\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 3 6 1 3 19 38\n", "output": ["115\n"]}, {"input": "18\n3 25\n26 30\n2 22\n13 27\n7 31\n19 34\n14 18\n16 28\n32 33\n29 35\n12 17\n15 21\n5 8\n6 23\n1 10\n4 36\n10 11\n20 24\n1\n13\n", "output": ["1\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 3 35 38\n", "output": ["184\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n2 8 4 9 12 11\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n2 8 2 5 12 19\n", "output": ["138\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 3 13 1 3 19 55\n", "output": ["115\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 3 13 1 3 19 110\n", "output": ["115\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 2 5 12 12\n", "output": ["138\n"]}, {"input": "2\n1 4\n2 3\n1\n2 0\n", "output": ["1\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 1 9 12 11\n", "output": ["138\n"]}, {"input": "20\n10 32\n7 29\n23 26\n4 25\n28 34\n21 38\n13 31\n18 22\n11 14\n9 35\n8 12\n5 40\n1 16\n17 20\n2 3\n27 37\n19 33\n24 30\n6 39\n15 36\n15\n5 8 13 19 9 2 6 11 1 7 18 17 20 3 4\n", "output": ["159\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 3 23 38\n", "output": ["184\n"]}, {"input": "50\n38 51\n26 42\n11 22\n9 16\n34 54\n19 49\n36 88\n66 92\n48 87\n23 86\n14 41\n45 81\n30 83\n13 24\n73 82\n10 96\n80 100\n5 97\n47 85\n43 55\n50 52\n3 32\n6 17\n31 89\n37 67\n56 64\n63 91\n33 75\n20 68\n15 27\n18 78\n4 40\n60 65\n69 99\n74 93\n58 94\n35 53\n1 12\n29 95\n46 79\n7 72\n44 76\n2 77\n28 98\n8 39\n57 70\n62 71\n59 84\n21 90\n25 61\n27\n28 40 34 22 2 9 11 50 23 19 46 35 17 38 29 5 32 30 41 39 20 8 48 26 10 14 16\n", "output": ["9235\n"]}, {"input": "50\n38 51\n26 42\n11 22\n9 16\n34 54\n19 49\n36 88\n66 92\n48 87\n23 86\n14 41\n45 81\n30 83\n13 24\n73 82\n10 96\n80 100\n5 97\n47 85\n43 55\n50 52\n3 32\n6 17\n31 89\n37 67\n56 64\n63 91\n33 75\n20 68\n15 27\n18 78\n4 40\n60 65\n69 99\n74 93\n58 94\n35 53\n1 12\n29 95\n46 79\n7 72\n44 76\n2 77\n28 98\n8 39\n57 70\n62 71\n59 84\n21 90\n25 61\n27\n28 40 34 42 2 18 11 50 23 19 46 35 17 27 29 5 32 30 49 39 20 8 48 26 10 14 16\n", "output": ["9235\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 2 5 4 19\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 1 9 7 11\n", "output": ["138\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n3\n17 5 13 1 0 19 21\n", "output": ["181\n"]}, {"input": "50\n38 51\n26 42\n11 22\n9 16\n34 54\n19 49\n36 88\n66 92\n48 87\n23 86\n14 41\n45 81\n30 83\n13 24\n73 82\n10 96\n80 100\n5 97\n47 85\n43 55\n50 52\n3 32\n6 17\n31 89\n37 67\n56 64\n63 91\n33 75\n20 68\n15 27\n18 78\n4 40\n60 65\n69 99\n74 93\n58 94\n35 53\n1 12\n29 95\n46 79\n7 72\n44 76\n2 77\n28 98\n8 39\n57 70\n62 71\n59 84\n21 90\n25 61\n27\n28 40 34 42 2 18 11 50 23 19 46 35 17 27 29 5 32 30 49 47 20 8 48 26 10 14 16\n", "output": ["9235\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n14 5 13 1 3 19 22\n", "output": ["186\n"]}, {"input": "18\n3 25\n26 30\n2 22\n13 27\n7 29\n19 34\n14 18\n16 28\n32 33\n29 35\n12 17\n15 21\n5 8\n6 23\n1 9\n4 36\n10 11\n20 24\n1\n13\n", "output": ["1\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n6\n3 8 2 5 14 12\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 8 5 5 12 11\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n3\n3 8 6 9 12 11\n", "output": ["138\n"]}, {"input": "19\n11 34\n15 21\n12 19\n10 23\n16 30\n5 32\n2 27\n1 13\n14 38\n22 28\n18 33\n36 37\n3 6\n17 20\n25 35\n7 9\n24 31\n4 8\n26 29\n1\n5 0 14\n", "output": ["32\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 3 70 38\n", "output": ["184\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 3 23 12\n", "output": ["184\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n3\n17 5 13 1 2 19 21\n", "output": ["181\n"]}, {"input": "21\n7 18\n19 32\n22 38\n27 39\n4 41\n15 20\n14 35\n3 42\n6 30\n26 34\n25 31\n12 29\n5 37\n9 16\n8 13\n10 33\n1 28\n24 36\n17 40\n11 21\n2 23\n4\n17 5 13 1 3 70 9\n", "output": ["184\n"]}, {"input": "2\n1 4\n2 3\n1\n1 0\n", "output": ["2\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n4\n6 8 2 5 12 11\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n4 8 4 5 12 21\n", "output": ["138\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n3\n3 8 1 9 12 11\n", "output": ["159\n"]}, {"input": "16\n31 32\n3 26\n17 19\n4 24\n1 28\n15 21\n12 16\n18 29\n20 23\n7 8\n11 14\n9 22\n6 30\n5 10\n25 27\n2 13\n2\n3 9 6 9 12 3\n", "output": ["19\n"]}], "source_codes": ["\nimport sys\nimport threading\n\ndef main():\n    import sys\n    sys.setrecursionlimit(1 << 25)\n    input = sys.stdin.read\n    data = input().split()\n    \n    n = int(data[0])\n    a = []\n    b = []\n    for i in range(n):\n        a.append(int(data[1 + 2*i]))\n        b.append(int(data[2 + 2*i]))\n    \n    t = int(data[2*n + 1])\n    s = list(map(int, data[2*n + 2: 2*n + 2 + t]))\n    \n    # Convert s to 0-based\n    s = [x - 1 for x in s]\n    \n    # Sort tasks by b_k\n    tasks = list(zip(b, a, range(n)))\n    tasks.sort()\n    \n    # We need to simulate the time travel process\n    # Keep track of which tasks are completed\n    completed = [False] * n\n    time_traveled = 0\n    current_time = 0\n    # We'll use a set to keep track of completed tasks\n    completed_tasks = set()\n    \n    # We need to track for each time, what task is being considered\n    # So we can simulate the process\n    # We'll process the tasks in order of increasing b_k\n    # and simulate the time travel\n    # We also need to track the current time\n    # and for each time, we process the tasks that have b_k == current_time\n    \n    # To simulate the time flow, we'll track the time step by step\n    # and process the tasks at that time\n    # We'll use a dictionary to map time to list of tasks\n    time_to_tasks = {}\n    for i in range(n):\n        time = b[i]\n        if time not in time_to_tasks:\n            time_to_tasks[time] = []\n        time_to_tasks[time].append(i)\n    \n    # Sort all the times\n    times = sorted(time_to_tasks.keys())\n    \n    # We'll simulate the time flow from 0 to 2n\n    for current_time in range(0, 2 * n + 1):\n        # Process all tasks at this time\n        if current_time in time_to_tasks:\n            for task_idx in time_to_tasks[current_time]:\n                a_k = a[task_idx]\n                b_k = b[task_idx]\n                # Check if task is already completed\n                if completed[task_idx]:\n                    continue\n                # Time travel to a_k\n                time_traveled += 1\n                # Mark all tasks with a_j > a_k as not completed\n                for j in range(n):\n                    if a[j] > a_k:\n                        completed[j] = False\n                # Complete the current task\n                completed[task_idx] = True\n                # Update the set of completed tasks\n                completed_tasks.add(task_idx)\n                # Check if all tasks in s are completed\n                if all(completed[i] for i in s):\n                    print(time_traveled % (10**9 + 7))\n                    return\n    \n    # If not found (shouldn't happen)\n    print(-1)\n\nthreading.Thread(target=main).start()\n\n\n"], "responses": ["```python\nimport sys\nimport threading\n\ndef main():\n    import sys\n    sys.setrecursionlimit(1 << 25)\n    input = sys.stdin.read\n    data = input().split()\n    \n    n = int(data[0])\n    a = []\n    b = []\n    for i in range(n):\n        a.append(int(data[1 + 2*i]))\n        b.append(int(data[2 + 2*i]))\n    \n    t = int(data[2*n + 1])\n    s = list(map(int, data[2*n + 2: 2*n + 2 + t]))\n    \n    # Convert s to 0-based\n    s = [x - 1 for x in s]\n    \n    # Sort tasks by b_k\n    tasks = list(zip(b, a, range(n)))\n    tasks.sort()\n    \n    # We need to simulate the time travel process\n    # Keep track of which tasks are completed\n    completed = [False] * n\n    time_traveled = 0\n    current_time = 0\n    # We'll use a set to keep track of completed tasks\n    completed_tasks = set()\n    \n    # We need to track for each time, what task is being considered\n    # So we can simulate the process\n    # We'll process the tasks in order of increasing b_k\n    # and simulate the time travel\n    # We also need to track the current time\n    # and for each time, we process the tasks that have b_k == current_time\n    \n    # To simulate the time flow, we'll track the time step by step\n    # and process the tasks at that time\n    # We'll use a dictionary to map time to list of tasks\n    time_to_tasks = {}\n    for i in range(n):\n        time = b[i]\n        if time not in time_to_tasks:\n            time_to_tasks[time] = []\n        time_to_tasks[time].append(i)\n    \n    # Sort all the times\n    times = sorted(time_to_tasks.keys())\n    \n    # We'll simulate the time flow from 0 to 2n\n    for current_time in range(0, 2 * n + 1):\n        # Process all tasks at this time\n        if current_time in time_to_tasks:\n            for task_idx in time_to_tasks[current_time]:\n                a_k = a[task_idx]\n                b_k = b[task_idx]\n                # Check if task is already completed\n                if completed[task_idx]:\n                    continue\n                # Time travel to a_k\n                time_traveled += 1\n                # Mark all tasks with a_j > a_k as not completed\n                for j in range(n):\n                    if a[j] > a_k:\n                        completed[j] = False\n                # Complete the current task\n                completed[task_idx] = True\n                # Update the set of completed tasks\n                completed_tasks.add(task_idx)\n                # Check if all tasks in s are completed\n                if all(completed[i] for i in s):\n                    print(time_traveled % (10**9 + 7))\n                    return\n    \n    # If not found (shouldn't happen)\n    print(-1)\n\nthreading.Thread(target=main).start()\n```"], "prompt_tokens": [1207], "completion_tokens": [679], "no_of_try": 1, "is_solved": false, "language": "Python3", "task_id": 1586}
