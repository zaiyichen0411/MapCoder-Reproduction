{"name": "1591_E. Frequency Queries", "description": "Petya has a rooted tree with an integer written on each vertex. The vertex 1 is the root. You are to answer some questions about the tree.\n\nA tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a node v is the next vertex on the shortest path from v to the root.\n\nEach question is defined by three integers v, l, and k. To get the answer to the question, you need to perform the following steps: \n\n  * First, write down the sequence of all integers written on the shortest path from the vertex v to the root (including those written in the v and the root). \n  * Count the number of times each integer occurs. Remove all integers with less than l occurrences. \n  * Replace the sequence, removing all duplicates and ordering the elements by the number of occurrences in the original list in increasing order. In case of a tie, you can choose the order of these elements arbitrary. \n  * The answer to the question is the k-th number in the remaining sequence. Note that the answer is not always uniquely determined, because there could be several orderings. Also, it is possible that the length of the sequence on this step is less than k, in this case the answer is -1. \n\n\n\nFor example, if the sequence of integers on the path from v to the root is [2, 2, 1, 7, 1, 1, 4, 4, 4, 4], l = 2 and k = 2, then the answer is 1.\n\nPlease answer all questions about the tree.\n\nInput\n\nEach test contains multiple test cases. The first line contains the number of test cases t (1 \u2264 t \u2264 10^6). Description of the test cases follows.\n\nThe first line of each test case contains two integers n, q (1 \u2264 n, q \u2264 10^6) \u2014 the number of vertices in the tree and the number of questions.\n\nThe second line contains n integers a_1, a_2, \u2026, a_n (1 \u2264 a_i \u2264 n), where a_i is the number written on the i-th vertex.\n\nThe third line contains n-1 integers p_2, p_3, \u2026, p_n (1 \u2264 p_i \u2264 n), where p_i is the parent of node i. It's guaranteed that the values p define a correct tree.\n\nEach of the next q lines contains three integers v, l, k (1 \u2264 v, l, k \u2264 n) \u2014 descriptions of questions.\n\nIt is guaranteed that the sum of n and the sum of q over all test cases do not exceed 10^6.\n\nOutput\n\nFor each question of each test case print the answer to the question. In case of multiple answers, print any.\n\nExample\n\nInput\n\n\n2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n\n\nOutput\n\n\n1 -1 1 \n1 1 2 1 -1 ", "tags": ["binary search", "data structures", "dfs and similar", "trees", "two pointers"], "difficulty": 11, "id": 1591, "sample_io": [{"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 1 \n1 1 2 1 -1 \n"]}], "test_list": [{"input": "1\n1 1\n1\n\n1 1 1\n", "output": ["1 \n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n1 1 2 1 -1\n"]}, {"input": "1\n1 1\n1\n\n1 1 2\n", "output": ["-1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["2 1 -1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 1\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["2 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n3 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["-1 -1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n3 1 2\n4 1 1\n4 3 1\n4 3 2\n", "output": ["1 -1 1\n1 -1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 2 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["-1 -1 1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 3 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 1\n1 1 1 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 2\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n-1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n1 3 2\n", "output": ["2 1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 2\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 2 -1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 3 2\n", "output": ["2 1 1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 3 1\n4 3 2\n", "output": ["2 1 1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 3 2\n3 1 1\n1 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 1\n1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n-1 -1 2 1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["2 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 4 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n-1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 1\n3 2 1\n5 5\n1 2 1 1 2\n1 1 3 2\n3 1 1\n1 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 1 1\n1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 1 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 3 1\n", "output": ["2 1 2\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n4 1 4\n4 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n4 1 4\n3 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n1 2 1\n2 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n-1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 2 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n-1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n2 1 3\n2 2 1\n5 5\n1 3 2 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["2 -1 -1\n-1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 2\n3 1 2\n4 1 1\n4 3 1\n4 3 2\n", "output": ["1 -1 1\n-1 -1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 3\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 3\n4 3 2\n", "output": ["1 -1 -1\n1 1 3\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n1 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 2\n3 4 1\n2 1 2\n1 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n-1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 3\n2 2 2\n5 5\n1 3 1 1 3\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 3\n4 3 2\n", "output": ["-1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 1 1 1 2\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n-1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 4\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 2\n", "output": ["2 1 -1\n-1 -1 2 1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n3 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n1 1 1\n3 1 2\n3 3 1\n5 0\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 2 2\n4 1 2\n", "output": ["-1 -1 1\n1 1 1 -1 1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 2\n4 2 2\n4 2 2\n", "output": ["1 1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 1 1\n4 3 2\n", "output": ["2 1 1\n1 1 2 2 -1\n"]}, {"input": "2\n3 3\n2 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 2 2\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 2\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 1\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 2 -1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 1\n3 4 1\n2 2 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n-1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 3\n1 3 1 1 2\n1 1 2 5\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n1 1 3\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 4 1\n2 1 2\n1 1 1\n4 2 2\n4 1 2\n", "output": ["-1 -1 1\n-1 1 1 -1 1\n"]}, {"input": "2\n3 3\n2 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 3 1\n1 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 2 2\n-1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 1\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n2 1 2\n4 1 2\n4 2 2\n2 3 2\n", "output": ["2 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 3 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 3\n1 3 1 1 2\n1 1 2 5\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["3 1 -1\n1 1 3\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 1 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 5 3\n4 2 2\n", "output": ["1 1 -1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 2\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n1 1 1 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 2\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 2 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["2 1 -1\n1 1 1 2 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n1 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 2 2\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 3 1\n4 3 2\n", "output": ["1 2 2\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 4\n5 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n1 -1 2 1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n1 2 1\n2 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 1\n-1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 2\n5 1 2\n4 1 1\n4 3 1\n4 3 2\n", "output": ["1 -1 1\n-1 2 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 3\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 2\n4 2 3\n4 3 2\n", "output": ["1 -1 -1\n1 1 1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 2 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n-1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 3\n1 1 1 2\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 1\n", "output": ["1 -1 -1\n1 1 1 -1 1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 2\n4 1 2\n3 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n-1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 2 2 2\n3 2 1\n2 1 2\n1 1 2\n1 2 2\n4 2 2\n", "output": ["2 1 -1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 1 2 1 3\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 2 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["-1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 3\n1 3 1 1 2\n1 1 2 5\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 1\n1 1 3\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 1\n1 1 1 1 3\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 4\n", "output": ["1 -1 -1\n-1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 2\n5 5\n1 1 1 1 3\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 -1\n-1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 2 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 2\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n1 3 2\n", "output": ["2 1 -1\n1 1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 2 2\n3 3 1\n5 5\n1 2 1 2 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["2 -1 -1\n1 1 1 2 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 3 2\n4 2 2\n", "output": ["2 1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 1\n1 1 2 4\n3 1 1\n4 1 1\n5 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 3 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 3\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 1\n4 1 2\n4 2 3\n4 3 2\n", "output": ["1 -1 -1\n1 3 1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 5 2 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n-1 -1 5 -1 -1\n"]}, {"input": "2\n3 3\n1 2 2\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 1\n3 2 2\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 2 -1\n-1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 1\n3 2 1\n5 5\n1 4 1 1 2\n1 1 3 2\n3 1 1\n1 1 2\n3 1 1\n4 2 1\n4 2 2\n", "output": ["2 2 1\n1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n3 1 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 3 2\n4 2 2\n", "output": ["2 1 2\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 2 2\n3 3 1\n5 5\n1 3 2 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n-1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 1\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 1\n4 1 2\n4 2 3\n4 3 2\n", "output": ["1 -1 -1\n1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 2\n3 1 1\n3 2 1\n5 5\n1 4 1 1 2\n1 1 3 2\n3 1 1\n1 1 2\n3 1 1\n4 2 1\n4 2 2\n", "output": ["1 2 1\n1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n1 2 1\n3 1 2\n3 3 1\n5 0\n1 2 1 1 2\n1 1 2 1\n3 2 1\n2 2 0\n4 1 1\n4 2 2\n4 2 2\n", "output": ["-1 -1 1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 1\n1 2 1\n5 5\n1 2 1 2 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 2\n1 2 1\n4 2 2\n", "output": ["1 1 -1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 5\n3 2 1\n2 1 3\n4 1 1\n4 2 2\n3 2 2\n", "output": ["1 -1 -1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 2\n3 1 1\n5 5\n1 3 2 2 2\n1 1 2 2\n3 2 1\n2 2 2\n1 1 1\n2 2 2\n4 2 2\n", "output": ["-1 -1 1\n-1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 2\n4 5\n1 1 1 1 3\n1 1 2 2\n3 1 3\n2 1 4\n4 1 1\n4 2 2\n2 2 4\n", "output": ["1 -1 -1\n-1 -1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 2\n5 5\n1 1 1 1 2\n1 1 2 5\n3 2 1\n2 1 3\n4 1 1\n4 2 2\n3 2 2\n", "output": ["1 -1 -1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 2\n4 2 1\n4 2 2\n", "output": ["2 1 -1\n1 1 1 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 1\n3 2 1\n5 5\n1 3 1 1 2\n1 1 3 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n2 1 3\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["2 -1 -1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n2 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n-1 2 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 2\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n-1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 1\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 3 2\n", "output": ["2 2 1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 3 2\n3 1 1\n1 1 2\n4 1 1\n4 2 1\n4 2 1\n", "output": ["1 -1 1\n1 -1 1 1 1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 4 1\n4 2 2\n", "output": ["1 -1 -1\n-1 -1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 2 2\n4 1 1\n4 2 1\n4 3 1\n", "output": ["2 1 1\n1 -1 2 1 -1\n"]}, {"input": "2\n3 3\n1 2 2\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n4 1 4\n4 1 1\n4 2 2\n3 2 2\n", "output": ["1 2 -1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n1 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["-1 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 3\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 3\n4 3 2\n", "output": ["2 -1 -1\n1 1 3\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 3\n2 2 2\n5 5\n1 3 1 1 3\n1 1 2 4\n3 2 2\n4 1 2\n4 1 1\n4 2 3\n4 3 2\n", "output": ["-1 -1 -1\n-1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 1\n3 2 1\n5 5\n1 4 1 1 2\n1 1 3 2\n3 1 1\n1 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 1 1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n1 2 1\n5 5\n1 2 1 1 2\n1 2 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n3 2 2\n5 0\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 1 1\n3 4 1\n2 2 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n-1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 4 1\n2 1 2\n1 1 1\n4 2 1\n4 1 2\n", "output": ["-1 -1 1\n-1 1 1 1 1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 2 2\n4 1 1\n4 5 3\n4 2 2\n", "output": ["1 1 -1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n1 1 1\n3 1 2\n3 3 1\n5 0\n1 2 1 1 2\n1 1 2 1\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n1 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 3 2\n", "output": ["1 -1 1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n3 1 1\n4 2 2\n4 3 1\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 4\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 4 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 2 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 3 1\n4 3 2\n", "output": ["1 -1 1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n2 1 3\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["2 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 5 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 4\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 3\n4 3 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n1 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n5 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 1 2\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 2 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 3\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 2 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 4\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 3\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 3\n4 3 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 1 2\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 3 1\n", "output": ["2 1 1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 3\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 2 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 4\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 4 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 4\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n-1 -1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 2 1 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 -1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n3 3 2\n", "output": ["2 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 2\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 3 1\n", "output": ["2 1 1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n4 1 2\n4 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 1\n1 1 2 4\n3 1 1\n4 1 4\n3 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n1 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 5\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 2\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n1 1 1\n4 2 2\n4 2 2\n", "output": ["-1 -1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 2\n1 2 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n3 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n3 1 1\n4 2 4\n4 3 2\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 4\n1 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n5 2 2\n", "output": ["1 -1 -1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 4 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 2 2 4\n3 2 1\n2 1 2\n4 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 3 1\n4 3 2\n", "output": ["2 1 1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 5 2\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 2 2 2\n3 2 1\n2 1 2\n1 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 1 2\n3 2 1\n2 1 2\n4 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n1 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 2\n1 2\n3 1 1\n3 1 2\n3 3 1\n5 5\n1 2 1 1 2\n1 1 2 1\n3 1 1\n2 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 2 -1\n1 1 2 1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n2 1 2\n4 1 2\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n1 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 3\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n5 3 1\n4 3 2\n", "output": ["2 1 1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 3\n1 1 1 2\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n1 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 2 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["2 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 1\n3 4 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n-1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 1\n3 1 1\n3 1 2\n3 2 1\n5 5\n1 3 1 1 2\n1 1 2 3\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 1\n3 2 1\n5 5\n1 4 1 1 2\n1 1 3 2\n3 1 1\n1 1 2\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 1 1\n1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 4\n1 1 2 4\n3 1 1\n4 1 4\n3 1 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 5\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 1\n5 5\n1 2 1 1 2\n1 2 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 1\n1 1 2 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n3 2 2\n5 3\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 3\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n2 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 4 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 5 3\n4 2 2\n", "output": ["1 -1 1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 2 2 2\n3 2 1\n2 1 2\n1 1 2\n1 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 3\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n2 1 2\n4 1 2\n4 2 2\n2 3 2\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 1 1 1 3\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 2\n", "output": ["1 -1 -1\n-1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 3\n1 1 1 2\n3 2 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 1 1\n1 2 2\n4 1 1\n4 2 2\n4 2 4\n", "output": ["1 -1 1\n1 -1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 2\n3 2 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n4 1 2\n4 1 1\n4 2 2\n4 3 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 2 1\n1 2\n3 1 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 4\n1 1 2 4\n3 1 1\n4 1 4\n3 2 1\n4 2 2\n3 2 2\n", "output": ["2 1 -1\n1 -1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n1 1 1\n3 1 2\n3 3 1\n5 0\n1 2 1 1 2\n1 1 2 2\n3 1 1\n2 1 2\n4 1 1\n4 2 2\n4 2 2\n", "output": ["1 -1 1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 2 1\n3 1 3\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 4\n3 2 1\n2 1 2\n4 1 2\n4 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n2 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 4 2\n2 2 2\n", "output": ["1 -1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 2 1\n3 1 2\n2 2 1\n5 5\n1 3 1 1 2\n1 1 2 2\n3 2 1\n2 1 2\n4 1 1\n4 5 3\n4 2 2\n", "output": ["1 1 -1\n1 1 3 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 4\n1 2 2 2\n3 2 1\n2 1 2\n1 1 2\n1 2 2\n4 2 2\n", "output": ["1 -1 -1\n1 1 -1 -1 -1\n"]}, {"input": "2\n3 3\n1 1 1\n1 2\n3 1 1\n3 1 2\n1 2 1\n5 5\n1 1 1 1 3\n1 1 2 2\n3 1 2\n2 1 4\n4 1 1\n4 2 1\n4 2 4\n", "output": ["1 -1 -1\n-1 -1 1 1 -1\n"]}, {"input": "2\n3 3\n2 1 1\n1 2\n3 1 1\n3 1 2\n2 2 2\n5 5\n1 3 1 1 3\n1 1 1 2\n3 2 1\n2 1 4\n4 1 1\n4 2 2\n4 2 2\n", "output": ["2 1 -1\n1 -1 1 -1 -1\n"]}], "source_codes": ["\nimport sys\nimport threading\nfrom collections import defaultdict, Counter\ninput = sys.stdin.read\n\ndef main():\n    data = input().split()\n    idx = 0\n    t = int(data[idx])\n    idx += 1\n\n    results = []\n\n    for _ in range(t):\n        n, q = int(data[idx]), int(data[idx + 1])\n        idx += 2\n        a = list(map(int, data[idx:idx + n]))\n        idx += n\n        p = list(map(int, data[idx:idx + n - 1]))\n        idx += n - 1\n\n        # Build the tree\n        tree = [[] for _ in range(n)]\n        for i in range(1, n):\n            parent = p[i - 1] - 1\n            tree[parent].append(i)\n\n        # Precompute path from root to each node\n        path_from_root = [[] for _ in range(n)]\n\n        def dfs(node, path):\n            path.append(a[node])\n            path_from_root[node] = path[:]\n            for child in tree[node]:\n                dfs(child, path[:])\n        \n        dfs(0, [])\n\n        for _ in range(q):\n            v = int(data[idx]) - 1\n            l = int(data[idx + 1])\n            k = int(data[idx + 2])\n            idx += 3\n\n            path = path_from_root[v]\n            freq = Counter(path)\n            filtered = {num: cnt for num, cnt in freq.items() if cnt >= l}\n            sorted_items = sorted(filtered.items(), key=lambda x: (x[1], x[0]))\n            if k <= len(sorted_items):\n                results.append(str(sorted_items[k - 1][0]))\n            else:\n                results.append(\"-1\")\n\n    print(' '.join(results))\n\nthreading.Thread(target=main).start()\n\n\n"], "responses": ["Here's a Python3 solution to the given problem. This solution efficiently handles multiple test cases and queries using efficient traversal and frequency counting.\n\nNote: Due to the constraints (up to 10^6 nodes and queries), we need to use fast input/output and efficient data structures. We'll use a recursive DFS for traversal and `collections.Counter` for counting frequencies.\n\n```python\nimport sys\nimport threading\nfrom collections import defaultdict, Counter\ninput = sys.stdin.read\n\ndef main():\n    data = input().split()\n    idx = 0\n    t = int(data[idx])\n    idx += 1\n\n    results = []\n\n    for _ in range(t):\n        n, q = int(data[idx]), int(data[idx + 1])\n        idx += 2\n        a = list(map(int, data[idx:idx + n]))\n        idx += n\n        p = list(map(int, data[idx:idx + n - 1]))\n        idx += n - 1\n\n        # Build the tree\n        tree = [[] for _ in range(n)]\n        for i in range(1, n):\n            parent = p[i - 1] - 1\n            tree[parent].append(i)\n\n        # Precompute path from root to each node\n        path_from_root = [[] for _ in range(n)]\n\n        def dfs(node, path):\n            path.append(a[node])\n            path_from_root[node] = path[:]\n            for child in tree[node]:\n                dfs(child, path[:])\n        \n        dfs(0, [])\n\n        for _ in range(q):\n            v = int(data[idx]) - 1\n            l = int(data[idx + 1])\n            k = int(data[idx + 2])\n            idx += 3\n\n            path = path_from_root[v]\n            freq = Counter(path)\n            filtered = {num: cnt for num, cnt in freq.items() if cnt >= l}\n            sorted_items = sorted(filtered.items(), key=lambda x: (x[1], x[0]))\n            if k <= len(sorted_items):\n                results.append(str(sorted_items[k - 1][0]))\n            else:\n                results.append(\"-1\")\n\n    print(' '.join(results))\n\nthreading.Thread(target=main).start()\n```\n\n### Explanation:\n\n- **Input Reading**: The input is read in one go for performance, especially with large input sizes.\n- **Tree Construction**: We build the tree using adjacency lists.\n- **Path from Root to Each Node**: We use DFS to precompute the path from the root to each node.\n- **Query Handling**:\n  - For each query, we get the path from the node to the root.\n  - Count frequencies using `Counter`.\n  - Filter out numbers that appear fewer than `l` times.\n  - Sort the remaining numbers by frequency and then by value.\n  - Return the `k`-th element or `-1` if it's out of bounds.\n\n### Note:\n- This code is designed for performance and should handle the constraints efficiently.\n- Due to Python's recursion depth limit, a recursive DFS may not work for very large trees. However, in this problem, the tree is built from the root, and we use a DFS with path tracking, which should be acceptable for the given constraints."], "prompt_tokens": [764], "completion_tokens": [670], "no_of_try": 1, "is_solved": false, "language": "Python3", "task_id": 1591}
