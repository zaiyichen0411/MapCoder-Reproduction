{"name": "1594_E2. Rubik's Cube Coloring (hard version)", "description": "It is the hard version of the problem. The difference is that in this version, there are nodes with already chosen colors.\n\nTheofanis is starving, and he wants to eat his favorite food, sheftalia. However, he should first finish his homework. Can you help him with this problem?\n\nYou have a perfect binary tree of 2^k - 1 nodes \u2014 a binary tree where all vertices i from 1 to 2^{k - 1} - 1 have exactly two children: vertices 2i and 2i + 1. Vertices from 2^{k - 1} to 2^k - 1 don't have any children. You want to color its vertices with the 6 Rubik's cube colors (White, Green, Red, Blue, Orange and Yellow).\n\nLet's call a coloring good when all edges connect nodes with colors that are neighboring sides in the Rubik's cube.\n\n<image>| <image>  \n---|---  \nA picture of Rubik's cube and its 2D map.\n\nMore formally: \n\n  * a white node can not be neighboring with white and yellow nodes; \n  * a yellow node can not be neighboring with white and yellow nodes; \n  * a green node can not be neighboring with green and blue nodes; \n  * a blue node can not be neighboring with green and blue nodes; \n  * a red node can not be neighboring with red and orange nodes; \n  * an orange node can not be neighboring with red and orange nodes; \n\n\n\nHowever, there are n special nodes in the tree, colors of which are already chosen.\n\nYou want to calculate the number of the good colorings of the binary tree. Two colorings are considered different if at least one node is colored with a different color.\n\nThe answer may be too large, so output the answer modulo 10^9+7.\n\nInput\n\nThe first line contains the integers k (1 \u2264 k \u2264 60) \u2014 the number of levels in the perfect binary tree you need to color.\n\nThe second line contains the integer n (1 \u2264 n \u2264 min(2^k - 1, 2000)) \u2014 the number of nodes, colors of which are already chosen.\n\nThe next n lines contains integer v (1 \u2264 v \u2264 2^k - 1) and string s \u2014 the index of the node and the color of the node (s is one of the white, yellow, green, blue, red and orange).\n\nIt is guaranteed that each node v appears in the input at most once.\n\nOutput\n\nPrint one integer \u2014 the number of the different colorings modulo 10^9+7.\n\nExamples\n\nInput\n\n\n3\n2\n5 orange\n2 white\n\n\nOutput\n\n\n1024\n\n\nInput\n\n\n2\n2\n1 white\n2 white\n\n\nOutput\n\n\n0\n\n\nInput\n\n\n10\n3\n1 blue\n4 red\n5 orange\n\n\nOutput\n\n\n328925088\n\nNote\n\nIn the picture below, you can see one of the correct colorings of the first test example.\n", "tags": ["brute force", "dp", "implementation", "math", "trees"], "difficulty": 11, "id": 1594, "sample_io": [{"input": "10\n3\n1 blue\n4 red\n5 orange\n", "output": ["328925088\n"]}, {"input": "3\n2\n5 orange\n2 white\n", "output": ["1024\n"]}, {"input": "2\n2\n1 white\n2 white\n", "output": ["0\n"]}], "test_list": [{"input": "5\n9\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n12 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "3\n1\n7 yellow\n", "output": ["4096\n"]}, {"input": "2\n2\n1 green\n3 red\n", "output": ["4\n"]}, {"input": "1\n1\n1 yellow\n", "output": ["1\n"]}, {"input": "1\n1\n1 white\n", "output": ["1\n"]}, {"input": "5\n9\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n3 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "3\n2\n3 orange\n2 white\n", "output": ["512\n"]}, {"input": "3\n2\n3 orange\n4 white\n", "output": ["768\n"]}, {"input": "10\n1\n1 blue\n4 red\n5 orange\n", "output": ["525602746\n"]}, {"input": "2\n1\n1 white\n2 white\n", "output": ["16\n"]}, {"input": "3\n2\n3 orange\n7 white\n", "output": ["1024\n"]}, {"input": "10\n2\n2 blue\n1 red\n7 dgo`ro\n", "output": ["631400690\n"]}, {"input": "10\n2\n4 blue\n3 red\n7 or`nge\n", "output": ["973550521\n"]}, {"input": "5\n9\n31 yellow\n30 green\n26 yellow\n25 red\n2 red\n22 white\n12 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "5\n9\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n3 red\n1 orange\n29 blue\n", "output": ["0\n"]}, {"input": "3\n2\n3 orange\n5 white\n", "output": ["768\n"]}, {"input": "10\n1\n1 blue\n4 red\n5 or`nge\n", "output": ["525602746\n"]}, {"input": "2\n1\n1 white\n2 wiite\n", "output": ["16\n"]}, {"input": "5\n9\n31 yellow\n30 green\n26 yellow\n15 red\n2 red\n22 white\n3 red\n1 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n2 blue\n4 red\n5 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 red\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n6 red\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "2\n1\n1 green\n3 red\n", "output": ["16\n"]}, {"input": "5\n8\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n3 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n1 blue\n4 red\n6 orange\n", "output": ["525602746\n"]}, {"input": "2\n1\n1 white\n1 white\n", "output": ["16\n"]}, {"input": "10\n1\n1 blue\n4 red\n9 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 red\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "2\n1\n1 green\n3 sed\n", "output": ["16\n"]}, {"input": "5\n8\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n4 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n1 blue\n4 red\n3 orange\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 rdd\n9 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 red\n3 orange\n", "output": ["525602746\n"]}, {"input": "3\n2\n1 orange\n2 white\n", "output": ["1024\n"]}, {"input": "5\n9\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n1 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n1 blue\n4 red\n5 oranhe\n", "output": ["525602746\n"]}, {"input": "5\n9\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n1 red\n1 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n1 blue\n4 der\n5 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 red\n6 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 red\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 red\n6 oraneg\n", "output": ["525602746\n"]}, {"input": "2\n1\n1 white\n0 white\n", "output": ["16\n"]}, {"input": "10\n1\n1 blue\n4 red\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 red\n8 or`oge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 der\n3 orange\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 rdd\n9 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n-1 red\n3 orange\n", "output": ["525602746\n"]}, {"input": "3\n2\n1 orange\n3 white\n", "output": ["1024\n"]}, {"input": "10\n1\n1 blue\n4 der\n5 oranhe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n5 red\n6 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 der\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 qed\n6 oraneg\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 der\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 red\n8 or`ogd\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 rdd\n9 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 der\n3 oranhe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 red\n6 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 der\n8 or_nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 qed\n6 orbneg\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 der\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 red\n8 dgo`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 rdd\n9 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 eer\n3 oranhe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 red\n6 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 der\n8 gr_noe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 cer\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 red\n7 dgo`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 ddr\n9 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n6 der\n8 gr_noe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 rec\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n0 red\n7 dgo`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 ddr\n0 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n6 der\n8 eon_rg\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 rec\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 ddr\n0 ogn`re\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 cer\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 ddr\n0 pgn`re\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 ber\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 bdr\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 bdr\n4 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 bdr\n5 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 bdr\n5 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 cdr\n5 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 cdr\n5 oregn`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n5 oregn`\n", "output": ["525602746\n"]}, {"input": "5\n9\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n3 red\n5 orange\n29 blue\n", "output": ["0\n"]}, {"input": "2\n1\n1 white\n2 wgite\n", "output": ["16\n"]}, {"input": "3\n2\n3 orange\n1 white\n", "output": ["1024\n"]}, {"input": "2\n1\n1 white\n2 etiiw\n", "output": ["16\n"]}, {"input": "10\n1\n4 blue\n4 red\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n5 red\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 qed\n8 or`nge\n", "output": ["525602746\n"]}, {"input": "5\n8\n31 yellow\n30 green\n26 yellow\n13 red\n2 red\n24 white\n4 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n1 blue\n4 red\n5 egnaro\n", "output": ["525602746\n"]}, {"input": "5\n9\n29 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n1 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n2 blue\n3 red\n6 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 red\n8 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 red\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 red\n8 ego`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 rcd\n9 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n6 der\n5 oranhe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n5 sed\n6 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 der\n12 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 der\n8 or`ogd\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 rdd\n14 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 der\n6 oranhe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n0 red\n6 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 der\n8 or_nhe\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n18 der\n8 gr_noe\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 ddr\n9 egn`so\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n0 rec\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n0 red\n4 dgo`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 cdr\n0 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n3 blue\n6 der\n8 eon_rg\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n5 rec\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 ddr\n0 ogn`re\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 bre\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 bdr\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 bdr\n4 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 bdr\n9 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 adr\n5 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 cdr\n9 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n5 `ngero\n", "output": ["525602746\n"]}, {"input": "5\n9\n22 yellow\n30 green\n26 yellow\n13 red\n2 red\n22 white\n3 red\n5 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n2 blue\n5 red\n8 os`nge\n", "output": ["525602746\n"]}, {"input": "5\n8\n31 yellow\n30 green\n26 yellow\n16 red\n2 red\n24 white\n4 red\n6 orange\n29 blue\n", "output": ["0\n"]}, {"input": "10\n1\n1 blue\n4 red\n5 egoarn\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 red\n6 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 der\n8 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 der\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 red\n8 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 dcr\n9 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 der\n12 nr`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n0 ree\n6 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n16 der\n8 or_nhe\n", "output": ["525602746\n"]}, {"input": "10\n2\n2 blue\n1 red\n7 ego`ro\n", "output": ["631400690\n"]}, {"input": "10\n1\n1 blue\n18 der\n8 gr_noe\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 ddr\n9 egn`so\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n-1 rec\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 cdr\n0 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n3 blue\n6 der\n8 fon_rg\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n0 ddr\n0 ogn`re\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 erb\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 bdr\n14 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdb\n4 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n4 bdr\n9 orfng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rda\n5 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 cdr\n9 nreog`\n", "output": ["525602746\n"]}, {"input": "10\n1\n3 blue\n2 rdc\n5 `ngero\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 red\n8 os`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 red\n5 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n9 eer\n8 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 der\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 rde\n8 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n4 der\n12 rn`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 ree\n6 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n21 der\n8 or_nhe\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n18 der\n4 gr_noe\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 dds\n9 egn`so\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n-1 erc\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n4 erb\n11 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 bdr\n14 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n2 rdb\n4 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 bdr\n9 orfng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rda\n6 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n0 cdr\n9 nreog`\n", "output": ["525602746\n"]}, {"input": "10\n1\n3 blue\n2 rdc\n3 `ngero\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 sed\n8 os`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n3 red\n5 egn`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 red\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 rde\n8 nge`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 ree\n6 orgne`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n4 erb\n11 oremg`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 ber\n14 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 rdb\n4 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rda\n6 `gnero\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 cdr\n9 nreog`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 sed\n12 os`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n3 red\n5 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n-1 red\n11 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 edr\n8 nge`ro\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 red\n6 orgne`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n4 erb\n11 `gnero\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 beq\n14 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 rbd\n4 oreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 rdc\n9 nreog`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 des\n12 os`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n3 red\n7 or`nge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n1 edr\n8 nge`or\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 sed\n6 orgne`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n4 bre\n11 `gnero\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n1 rbd\n4 nreng`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n9 nreog`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n3 des\n12 os`mge\n", "output": ["525602746\n"]}, {"input": "10\n1\n1 blue\n0 sde\n6 orgne`\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n9 noerg`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n3 des\n12 os`mge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n6 noerg`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n3 des\n12 om`sge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n0 noerg`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n3 des\n1 om`sge\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n0 ooerg`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n3 des\n1 om`egs\n", "output": ["525602746\n"]}, {"input": "10\n1\n2 blue\n2 rdc\n0 ooegr`\n", "output": ["525602746\n"]}, {"input": "10\n1\n4 blue\n2 des\n1 om`egs\n", "output": ["525602746\n"]}], "source_codes": ["import sys\nsys.setrecursionlimit(10000)\n\nMOD = 1000000007\n\ndef main():\n    import sys\n    input = sys.stdin.read\n    data = input().split()\n    \n    k = int(data[0])\n    n = int(data[1])\n    \n    fixed = {}\n    idx = 2\n    color_map = {\n        \"white\": 0,\n        \"yellow\": 1,\n        \"green\": 2,\n        \"blue\": 3,\n        \"red\": 4,\n        \"orange\": 5\n    }\n    \n    for _ in range(n):\n        v = int(data[idx])\n        c = data[idx+1]\n        fixed[v] = color_map[c]\n        idx += 2\n    \n    # Compatibility matrix: compat[i][j] = True if color i can be adjacent to color j\n    compat = [\n        [False, False, True,  True,  True,  True ],  # white\n        [False, False, True,  True,  True,  True ],  # yellow\n        [True,  True,  False, False, True,  True ],  # green\n        [True,  True,  False, False, True,  True ],  # blue\n        [True,  True,  True,  True,  False, False],  # red\n        [True,  True,  True,  True,  False, False]   # orange\n    ]\n    \n    memo = {}\n    total_nodes = (1 << k) - 1\n    \n    def dp(node):\n        if node > total_nodes:\n            # Null node - contributes 1 way for any color (no constraint)\n            return [1, 1, 1, 1, 1, 1]\n        \n        if node in memo:\n            return memo[node]\n        \n        # Get results for children\n        left_results = dp(2 * node)\n        right_results = dp(2 * node + 1)\n        \n        result = [0] * 6\n        \n        if node in fixed:\n            fixed_color = fixed[node]\n            # Only the fixed color is allowed\n            total_ways = 0\n            for left_color in range(6):\n                if compat[fixed_color][left_color]:\n                    for right_color in range(6):\n                        if compat[fixed_color][right_color]:\n                            total_ways = (total_ways + (left_results[left_color] * right_results[right_color]) % MOD) % MOD\n            result[fixed_color] = total_ways\n        else:\n            # Try all colors for this node\n            for node_color in range(6):\n                left_sum = 0\n                right_sum = 0\n                \n                # Calculate valid contributions from left child\n                for left_color in range(6):\n                    if compat[node_color][left_color]:\n                        left_sum = (left_sum + left_results[left_color]) % MOD\n                \n                # Calculate valid contributions from right child\n                for right_color in range(6):\n                    if compat[node_color][right_color]:\n                        right_sum = (right_sum + right_results[right_color]) % MOD\n                \n                result[node_color] = (left_sum * right_sum) % MOD\n        \n        memo[node] = result\n        return result\n    \n    # Compute result for root\n    root_results = dp(1)\n    ans = 0\n    for i in range(6):\n        ans = (ans + root_results[i]) % MOD\n    \n    print(ans)\n\nif __name__ == \"__main__\":\n    main()"], "responses": ["\nimport sys\nsys.setrecursionlimit(10000)\n\nMOD = 1000000007\n\ndef main():\n    import sys\n    input = sys.stdin.read\n    data = input().split()\n    \n    k = int(data[0])\n    n = int(data[1])\n    \n    fixed = {}\n    idx = 2\n    color_map = {\n        \"white\": 0,\n        \"yellow\": 1,\n        \"green\": 2,\n        \"blue\": 3,\n        \"red\": 4,\n        \"orange\": 5\n    }\n    \n    for _ in range(n):\n        v = int(data[idx])\n        c = data[idx+1]\n        fixed[v] = color_map[c]\n        idx += 2\n    \n    # Compatibility matrix: compat[i][j] = True if color i can be adjacent to color j\n    compat = [\n        [False, False, True,  True,  True,  True ],  # white\n        [False, False, True,  True,  True,  True ],  # yellow\n        [True,  True,  False, False, True,  True ],  # green\n        [True,  True,  False, False, True,  True ],  # blue\n        [True,  True,  True,  True,  False, False],  # red\n        [True,  True,  True,  True,  False, False]   # orange\n    ]\n    \n    memo = {}\n    total_nodes = (1 << k) - 1\n    \n    def dp(node):\n        if node > total_nodes:\n            # Null node - contributes 1 way for any color (no constraint)\n            return [1, 1, 1, 1, 1, 1]\n        \n        if node in memo:\n            return memo[node]\n        \n        # Get results for children\n        left_results = dp(2 * node)\n        right_results = dp(2 * node + 1)\n        \n        result = [0] * 6\n        \n        if node in fixed:\n            fixed_color = fixed[node]\n            # Only the fixed color is allowed\n            total_ways = 0\n            for left_color in range(6):\n                if compat[fixed_color][left_color]:\n                    for right_color in range(6):\n                        if compat[fixed_color][right_color]:\n                            total_ways = (total_ways + (left_results[left_color] * right_results[right_color]) % MOD) % MOD\n            result[fixed_color] = total_ways\n        else:\n            # Try all colors for this node\n            for node_color in range(6):\n                left_sum = 0\n                right_sum = 0\n                \n                # Calculate valid contributions from left child\n                for left_color in range(6):\n                    if compat[node_color][left_color]:\n                        left_sum = (left_sum + left_results[left_color]) % MOD\n                \n                # Calculate valid contributions from right child\n                for right_color in range(6):\n                    if compat[node_color][right_color]:\n                        right_sum = (right_sum + right_results[right_color]) % MOD\n                \n                result[node_color] = (left_sum * right_sum) % MOD\n        \n        memo[node] = result\n        return result\n    \n    # Compute result for root\n    root_results = dp(1)\n    ans = 0\n    for i in range(6):\n        ans = (ans + root_results[i]) % MOD\n    \n    print(ans)\n\nif __name__ == \"__main__\":\n    main()\n\n\n"], "prompt_tokens": [17978], "completion_tokens": [7707], "no_of_try": 1, "api_calls": 10, "is_solved": false, "language": "Python3", "task_id": 1594}
{"name": "1598_A. Computer Game", "description": "Monocarp is playing a computer game. Now he wants to complete the first level of this game.\n\nA level is a rectangular grid of 2 rows and n columns. Monocarp controls a character, which starts in cell (1, 1) \u2014 at the intersection of the 1-st row and the 1-st column.\n\nMonocarp's character can move from one cell to another in one step if the cells are adjacent by side and/or corner. Formally, it is possible to move from cell (x_1, y_1) to cell (x_2, y_2) in one step if |x_1 - x_2| \u2264 1 and |y_1 - y_2| \u2264 1. Obviously, it is prohibited to go outside the grid.\n\nThere are traps in some cells. If Monocarp's character finds himself in such a cell, he dies, and the game ends.\n\nTo complete a level, Monocarp's character should reach cell (2, n) \u2014 at the intersection of row 2 and column n.\n\nHelp Monocarp determine if it is possible to complete the level.\n\nInput\n\nThe first line contains a single integer t (1 \u2264 t \u2264 100) \u2014 the number of test cases. Then the test cases follow. Each test case consists of three lines.\n\nThe first line contains a single integer n (3 \u2264 n \u2264 100) \u2014 the number of columns.\n\nThe next two lines describe the level. The i-th of these lines describes the i-th line of the level \u2014 the line consists of the characters '0' and '1'. The character '0' corresponds to a safe cell, the character '1' corresponds to a trap cell.\n\nAdditional constraint on the input: cells (1, 1) and (2, n) are safe.\n\nOutput\n\nFor each test case, output YES if it is possible to complete the level, and NO otherwise.\n\nExample\n\nInput\n\n\n4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n101010\n\n\nOutput\n\n\nYES\nYES\nNO\nYES\n\nNote\n\nConsider the example from the statement.\n\nIn the first test case, one of the possible paths is (1, 1) \u2192 (2, 2) \u2192 (2, 3).\n\nIn the second test case, one of the possible paths is (1, 1) \u2192 (1, 2) \u2192 (2, 3) \u2192 (2, 4).\n\nIn the fourth test case, one of the possible paths is (1, 1) \u2192 (2, 2) \u2192 (1, 3) \u2192 (2, 4) \u2192 (1, 5) \u2192 (2, 6).", "tags": ["brute force", "dfs and similar", "dp", "implementation"], "difficulty": 7, "id": 1598, "sample_io": [{"input": "4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}], "test_list": [{"input": "1\n9\n000000010\n000000000\n", "output": ["YES\n"]}, {"input": "1\n9\n000000010\n000100000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000000000000000000000010\n000000000000000000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n9\n000010010\n000100000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000010000000000000000010\n000000000000000000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n0110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n0110\n6\n010111\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "4\n3\n010\n010\n4\n0011\n0100\n4\n1111\n0110\n6\n010100\n101010\n", "output": ["NO\nYES\nNO\nYES\n"]}, {"input": "4\n3\n000\n000\n4\n0111\n0100\n4\n0011\n1110\n6\n010101\n101110\n", "output": ["YES\nNO\nNO\nNO\n"]}, {"input": "4\n3\n010\n010\n4\n0011\n0100\n4\n1111\n0110\n6\n010110\n101010\n", "output": ["NO\nYES\nNO\nNO\n"]}, {"input": "4\n3\n000\n010\n4\n0011\n1110\n4\n0111\n1110\n6\n010100\n100010\n", "output": ["YES\nNO\nNO\nYES\n"]}, {"input": "4\n3\n000\n000\n4\n0111\n0100\n4\n0011\n1100\n6\n010101\n101110\n", "output": ["YES\nNO\nYES\nNO\n"]}, {"input": "4\n3\n010\n010\n4\n0111\n0100\n4\n1101\n0110\n6\n010110\n101010\n", "output": ["NO\nNO\nNO\nNO\n"]}, {"input": "1\n9\n001010010\n000100000\n", "output": ["YES\n"]}, {"input": "1\n9\n001010010\n000100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010010\n000110010\n", "output": ["NO\n"]}, {"input": "1\n9\n001110010\n000110010\n", "output": ["NO\n"]}, {"input": "1\n9\n001110010\n000010010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n000010010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110000\n000010010\n", "output": ["NO\n"]}, {"input": "1\n9\n000000011\n000000000\n", "output": ["YES\n"]}, {"input": "1\n9\n000000000\n000000000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000000000000000000000010\n000000000000000000000000001000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n101110\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n000011010\n000100000\n", "output": ["YES\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n0111\n0110\n6\n010111\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001010010\n100100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010010\n000110011\n", "output": ["NO\n"]}, {"input": "1\n9\n001110010\n000110000\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n100010010\n", "output": ["NO\n"]}, {"input": "1\n9\n111110000\n000010010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000010\n000000000000000000000000001000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n0111\n1110\n6\n010101\n101110\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n010011010\n000100000\n", "output": ["YES\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1111\n0110\n6\n010111\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001010010\n101100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001100010\n000110000\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000010\n000000000000000000000000011000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n0011\n1110\n6\n010101\n101110\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1111\n0110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n101010010\n101100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001111010\n000110000\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000000000000000000000011000000000000000000000000000000010\n", "output": ["YES\n"]}, {"input": "4\n3\n010\n000\n4\n0011\n0100\n4\n1111\n0110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n111010010\n101100010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000000000000000000000011000000000000000000000000000100010\n", "output": ["YES\n"]}, {"input": "4\n3\n010\n000\n4\n0011\n0100\n4\n1111\n0110\n6\n010100\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n001000010\n000000000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000100000000000000000000000000000000000000000000010\n000000000000000000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n010\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n7\n000010010\n000100000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000010000000000000001010\n000000000000000000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010010\n000111010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n100010000\n", "output": ["NO\n"]}, {"input": "1\n9\n000100011\n000000000\n", "output": ["YES\n"]}, {"input": "1\n9\n001010010\n100110010\n", "output": ["NO\n"]}, {"input": "1\n9\n011010010\n000110011\n", "output": ["NO\n"]}, {"input": "1\n9\n001110011\n000110000\n", "output": ["NO\n"]}, {"input": "1\n9\n111110000\n000010011\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n0111\n1110\n6\n000101\n101110\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n0110\n6\n010111\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001010110\n101100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001100011\n000110000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n0011\n1110\n6\n010001\n101110\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n0110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n101010000\n101100010\n", "output": ["NO\n"]}, {"input": "1\n9\n011111010\n000110000\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000000000000000000000011000000000000000000000000010000010\n", "output": ["YES\n"]}, {"input": "1\n9\n111010010\n111100010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000000000000000000000011000000010000000000000000000100010\n", "output": ["NO\n"]}, {"input": "4\n3\n010\n000\n4\n0001\n0100\n4\n1111\n0110\n6\n010100\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n001010010\n000000000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000100000000000000000000000000000000000000000000010\n000000000000000000000000000000000000000000000000000000000110\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000010000000000000000000010000000000000001010\n000000000000000000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010010\n100111010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n101010000\n", "output": ["NO\n"]}, {"input": "1\n9\n000100011\n000010000\n", "output": ["YES\n"]}, {"input": "1\n9\n011010010\n000110111\n", "output": ["NO\n"]}, {"input": "1\n9\n001010010\n000110000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n1110\n6\n010111\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001010110\n111100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001100001\n000110000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n0110\n6\n000101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n101010000\n101100110\n", "output": ["NO\n"]}, {"input": "1\n9\n011111110\n000110000\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000010000000000010000000000000000000000000\n000000000000000000000000011000000000000000000000000010000010\n", "output": ["YES\n"]}, {"input": "1\n9\n111010010\n011100010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000000000000000000000011000000010000000000000000000110010\n", "output": ["NO\n"]}, {"input": "1\n9\n011010010\n000000000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000100000000000000000000000000000000000000000000010\n000000000000001000000000000000000000000000000000000000000110\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000010000000000000000000010000000000000001010\n000000000000000000000000000000000000000000000000000000001010\n", "output": ["NO\n"]}, {"input": "1\n9\n101010010\n100111010\n", "output": ["NO\n"]}, {"input": "1\n9\n111110010\n101010000\n", "output": ["NO\n"]}, {"input": "1\n9\n000100011\n010010000\n", "output": ["YES\n"]}, {"input": "1\n9\n001010010\n000111000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n1110\n6\n010111\n111010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001010110\n101100000\n", "output": ["NO\n"]}, {"input": "1\n9\n001100001\n001110000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n0110\n6\n001101\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n8\n101010000\n101100110\n", "output": ["NO\n"]}, {"input": "1\n9\n011111110\n000110001\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000010000000000010000000000000000000000000\n000000000000000000000000011000000000000000000000000010000110\n", "output": ["YES\n"]}, {"input": "1\n9\n111010010\n001100010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000000000010000000000011000000010000000000000000000110010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000100000000000000000000000000000000000000000000010\n000000000000001000000000010000000000000000000000000000000110\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n100111010\n", "output": ["NO\n"]}, {"input": "1\n9\n111111010\n101010000\n", "output": ["NO\n"]}, {"input": "1\n9\n000100011\n010010010\n", "output": ["NO\n"]}, {"input": "1\n9\n001000010\n000111010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010110\n111100000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1010\n0110\n6\n001101\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n8\n101010000\n001100110\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000010000000000010000000000000000000000000\n000000000010000000000000011000000000000000000000000010000110\n", "output": ["YES\n"]}, {"input": "1\n60\n100000000000000000000000000000000010000000000000000000000000\n000000000000010000000000011000000010000000000000000000110010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010110\n111000000\n", "output": ["NO\n"]}, {"input": "1\n8\n101010100\n001100110\n", "output": ["NO\n"]}, {"input": "1\n60\n100000000000000000000000000000000010000000000000100000000000\n000000000000010000000000011000000010000000000000000000110010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010110\n111000001\n", "output": ["NO\n"]}, {"input": "1\n8\n101010100\n001100010\n", "output": ["NO\n"]}, {"input": "1\n60\n100000000000000000000000000000000010000000000000100000000001\n000000000000010000000000011000000010000000000000000000110010\n", "output": ["NO\n"]}, {"input": "1\n8\n101010100\n001100011\n", "output": ["NO\n"]}, {"input": "1\n9\n000000000\n001000000\n", "output": ["YES\n"]}, {"input": "1\n9\n000000010\n100100000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000000000000000000000010\n000000000000010000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n1100\n4\n0111\n1110\n6\n010101\n001010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n000010010\n000100100\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000010000000000000000010\n000000000000000000100000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n1000\n4\n0111\n0110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n001110010\n000100000\n", "output": ["NO\n"]}, {"input": "1\n9\n001110010\n000111010\n", "output": ["NO\n"]}, {"input": "1\n9\n001110010\n100110010\n", "output": ["NO\n"]}, {"input": "1\n9\n011110010\n000010010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n000110010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110000\n100010010\n", "output": ["NO\n"]}, {"input": "1\n9\n000100000\n000000000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000001000000000000000000000000000000000000000010\n000000000000000000000000001000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n001\n000\n4\n0011\n0100\n4\n0111\n0110\n6\n010111\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001110010\n000010000\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n100010011\n", "output": ["NO\n"]}, {"input": "1\n9\n111010000\n000010010\n", "output": ["NO\n"]}, {"input": "1\n9\n010001010\n000100000\n", "output": ["YES\n"]}, {"input": "1\n9\n011010010\n101100010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000010\n000000000000000000000000011000000010000000000000000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n0111\n0110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n001101010\n000110000\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000001000000000000000011000000000000000000000000000000010\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000100000000000000000010000000000000000000000000\n000000000000000000000000011000000000000000000000000000100010\n", "output": ["YES\n"]}, {"input": "4\n3\n010\n000\n4\n0011\n0100\n4\n1111\n0110\n6\n010110\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001000010\n100000000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000100000000000000000000000000000000000000000000010\n000000000000000000000000000000000000000000000001000000000010\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n010\n4\n0011\n1100\n4\n0111\n1110\n6\n010100\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000010000010000000001010\n000000000000000000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n9\n001100011\n000000000\n", "output": ["YES\n"]}, {"input": "1\n9\n011110011\n000110000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n0110\n6\n010111\n101000\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0000\n4\n0011\n1110\n6\n010001\n101110\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "4\n3\n000\n000\n4\n0010\n0100\n4\n1011\n0110\n6\n010101\n101010\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n7\n101010010\n101100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001111000\n000110000\n", "output": ["NO\n"]}, {"input": "1\n9\n111010110\n111100010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000100000000000000000000000000000000000000001000010\n000000000000000000000000000000000000000000000000000000000110\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000010000000000000000000010000000000000001010\n000000000010000000000000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n9\n001010010\n101111010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n101000000\n", "output": ["NO\n"]}, {"input": "1\n9\n011000010\n000110111\n", "output": ["NO\n"]}, {"input": "1\n9\n001010110\n000110000\n", "output": ["NO\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n1110\n6\n110111\n101010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n6\n001010110\n111100010\n", "output": ["NO\n"]}, {"input": "1\n9\n001000011\n000110000\n", "output": ["YES\n"]}, {"input": "4\n3\n000\n000\n4\n0011\n0100\n4\n1011\n0110\n6\n000101\n101000\n", "output": ["YES\nYES\nNO\nYES\n"]}, {"input": "1\n9\n101000000\n101100110\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000010000000000010000000000000000000000000\n000000001000000000000000011000000000000000000000000010000010\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000000\n000000000000000000000000011000000110000000000000000000110010\n", "output": ["NO\n"]}, {"input": "1\n8\n011010010\n000000000\n", "output": ["YES\n"]}, {"input": "1\n9\n111110010\n101010001\n", "output": ["NO\n"]}, {"input": "1\n9\n001100011\n010010000\n", "output": ["YES\n"]}, {"input": "4\n3\n000\n000\n4\n0001\n0100\n4\n1011\n1110\n6\n010111\n111010\n", "output": ["YES\nYES\nNO\nNO\n"]}, {"input": "1\n9\n001010110\n001100000\n", "output": ["NO\n"]}, {"input": "1\n9\n001101001\n001110000\n", "output": ["NO\n"]}, {"input": "1\n8\n111010000\n101100110\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000100000000000000000000000000000000000000000000011\n000000000000001000000000010000000000000000000000000000000110\n", "output": ["NO\n"]}, {"input": "1\n9\n111101010\n101010000\n", "output": ["NO\n"]}, {"input": "1\n9\n000100010\n010010010\n", "output": ["NO\n"]}, {"input": "1\n9\n001000010\n000111000\n", "output": ["YES\n"]}, {"input": "1\n8\n111010000\n001100110\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000010000000000010000000000000000000000000\n000000001010000000000000011000000000000000000000000010000110\n", "output": ["YES\n"]}, {"input": "1\n9\n001010110\n101000000\n", "output": ["NO\n"]}, {"input": "1\n8\n101010101\n001100110\n", "output": ["NO\n"]}, {"input": "1\n9\n001010111\n111000001\n", "output": ["NO\n"]}, {"input": "1\n60\n100000010000000000000000000000000010000000000000100000000001\n000000000000010000000000011000000010000000000000000000110010\n", "output": ["NO\n"]}, {"input": "1\n9\n000000010\n001000000\n", "output": ["YES\n"]}, {"input": "1\n9\n000000010\n001100000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000000000000000000000010\n000000000000010000100000000000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000000000010000000000000000010\n000000000000000000100000000000000000010000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n9\n001111010\n000100000\n", "output": ["NO\n"]}, {"input": "1\n9\n001110010\n110110010\n", "output": ["NO\n"]}, {"input": "1\n9\n011111010\n000010010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n000110011\n", "output": ["NO\n"]}, {"input": "1\n9\n000100001\n000000000\n", "output": ["YES\n"]}, {"input": "1\n60\n000000000000000001000000000000000000000000000000010000000010\n000000000000000000000000001000000000000000000000000000000010\n", "output": ["NO\n"]}, {"input": "1\n9\n101110010\n000010011\n", "output": ["NO\n"]}, {"input": "1\n9\n011010010\n101100000\n", "output": ["NO\n"]}, {"input": "1\n60\n000000000000000000000000000000000010000000000000000000000010\n000000000000000000000000011000000010000000000000000000010010\n", "output": ["NO\n"]}], "source_codes": ["import sys\n\ndef can_complete_level(n, grid):\n    # Starting position (0-indexed): (0, 0)\n    # Target position (0-indexed): (1, n-1)\n    \n    # BFS setup\n    queue = deque([(0, 0)])  # (row, col)\n    visited = [[False]*n for _ in range(2)]\n    visited[0][0] = True\n    \n    # 8 directions (including diagonals)\n    directions = [(-1,-1), (-1,0), (-1,1),\n                  (0,-1),          (0,1),\n                  (1,-1),  (1,0),  (1,1)]\n    \n    while queue:\n        x, y = queue.popleft()\n        \n        # Check if reached target\n        if (x, y) == (1, n-1):\n            return \"YES\"\n        \n        # Explore all 8 directions\n        for dx, dy in directions:\n            nx, ny = x + dx, y + dy\n            \n            # Check bounds\n            if 0 <= nx < 2 and 0 <= ny < n:\n                # Check if safe and not visited\n                if grid[nx][ny] == '0' and not visited[nx][ny]:\n                    visited[nx][ny] = True\n                    queue.append((nx, ny))\n    \n    return \"NO\"\n\ndef main():\n    t = int(sys.stdin.readline())\n    for _ in range(t):\n        n = int(sys.stdin.readline())\n        row1 = sys.stdin.readline().strip()\n        row2 = sys.stdin.readline().strip()\n        grid = [row1, row2]\n        result = can_complete_level(n, grid)\n        print(result)\n\nif __name__ == \"__main__\":\n    main()"], "responses": ["\nfrom collections import deque\nimport sys\n\ndef can_complete_level(n, grid):\n    # Starting position (0-indexed): (0, 0)\n    # Target position (0-indexed): (1, n-1)\n    \n    # BFS setup\n    queue = deque([(0, 0)])  # (row, col)\n    visited = [[False]*n for _ in range(2)]\n    visited[0][0] = True\n    \n    # 8 directions (including diagonals)\n    directions = [(-1,-1), (-1,0), (-1,1),\n                  (0,-1),          (0,1),\n                  (1,-1),  (1,0),  (1,1)]\n    \n    while queue:\n        x, y = queue.popleft()\n        \n        # Check if reached target\n        if (x, y) == (1, n-1):\n            return \"YES\"\n        \n        # Explore all 8 directions\n        for dx, dy in directions:\n            nx, ny = x + dx, y + dy\n            \n            # Check bounds\n            if 0 <= nx < 2 and 0 <= ny < n:\n                # Check if safe and not visited\n                if grid[nx][ny] == '0' and not visited[nx][ny]:\n                    visited[nx][ny] = True\n                    queue.append((nx, ny))\n    \n    return \"NO\"\n\ndef main():\n    t = int(sys.stdin.readline())\n    for _ in range(t):\n        n = int(sys.stdin.readline())\n        row1 = sys.stdin.readline().strip()\n        row2 = sys.stdin.readline().strip()\n        grid = [row1, row2]\n        result = can_complete_level(n, grid)\n        print(result)\n\nif __name__ == \"__main__\":\n    main()\n\n\n"], "prompt_tokens": [14462], "completion_tokens": [5384], "no_of_try": 1, "api_calls": 10, "is_solved": false, "language": "Python3", "task_id": 1598}
{"name": "1599_A. Weights", "description": "You are given an array A of length N weights of masses A_1, A_2...A_N. No two weights have the same mass. You can put every weight on one side of the balance (left or right). You don't have to put weights in order A_1,...,A_N. There is also a string S consisting of characters \"L\" and \"R\", meaning that after putting the i-th weight (not A_i, but i-th weight of your choice) left or right side of the balance should be heavier. Find the order of putting the weights on the balance such that rules of string S are satisfied. \n\nInput\n\nThe first line contains one integer N (1 \u2264 N \u2264 2*10^5) - the length of the array A The second line contains N distinct integers: A_1, A_2,...,A_N (1 \u2264 A_i \u2264 10^9) - the weights given The third line contains string S of length N consisting only of letters \"L\" and \"R\" - string determining which side of the balance should be heavier after putting the i-th weight of your choice\n\nOutput\n\nThe output contains N lines. In every line, you should print one integer and one letter - integer representing the weight you are putting on the balance in that move and the letter representing the side of the balance where you are putting the weight. If there is no solution, print -1.\n\nExample\n\nInput\n\n\n5\n3 8 2 13 7\nLLRLL\n\n\nOutput\n\n\n3 L\n2 R\n8 R\n13 L\n7 L\n\nNote\n\nExplanation for the test case: \n\nafter the 1st weight: 3 L (left side is heavier)\n\nafter the 2nd weight: 2 R (left side is heavier)\n\nafter the 3rd weight: 8 R (right side is heavier)\n\nafter the 4th weight: 13 L (left side is heavier)\n\nafter the 5th weight: 7 L (left side is heavier)\n\nSo, the rules given by string S are fulfilled and our order of putting the weights is correct.", "tags": ["constructive algorithms", "greedy", "two pointers"], "difficulty": 7, "id": 1599, "sample_io": [{"input": "5\n3 8 2 13 7\nLLRLL\n", "output": ["7 L\n3 R\n8 R\n13 L\n2 L\n"]}], "test_list": [{"input": "5\n3 8 2 13 7\nLLRLL\n", "output": ["7 L\n3 R\n8 R\n13 L\n2 L\n"]}, {"input": "5\n3 4 2 13 7\nLLRLL\n", "output": ["4 L\n3  R\n7  R\n13 L\n2 L\n"]}, {"input": "5\n3 4 2 2 7\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n7 L\n2 L\n"]}, {"input": "5\n6 4 2 2 7\nLLRLL\n", "output": ["4 L\n2  R\n6  R\n7 L\n2 L\n"]}, {"input": "5\n6 4 3 2 7\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n7 L\n2 L\n"]}, {"input": "5\n12 4 3 2 7\nLLRLL\n", "output": ["4 L\n3  R\n7  R\n12 L\n2 L\n"]}, {"input": "5\n3 8 2 20 7\nLLRLL\n", "output": ["7 L\n3  R\n8  R\n20 L\n2 L\n"]}, {"input": "5\n3 8 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n8  R\n9 L\n2 L\n"]}, {"input": "5\n4 4 2 2 7\nLLRLL\n", "output": ["4 L\n2  R\n4  R\n7 L\n2 L\n"]}, {"input": "5\n3 16 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n16 L\n2 L\n"]}, {"input": "5\n3 8 2 13 9\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n13 L\n2 L\n"]}, {"input": "5\n6 4 1 2 7\nLLRLL\n", "output": ["4 L\n2  R\n6  R\n7 L\n1 L\n"]}, {"input": "5\n6 4 3 2 8\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n8 L\n2 L\n"]}, {"input": "5\n3 16 1 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n16 L\n1 L\n"]}, {"input": "5\n6 4 3 2 9\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n9 L\n2 L\n"]}, {"input": "5\n6 4 5 2 9\nLLRLL\n", "output": ["5 L\n4  R\n6  R\n9 L\n2 L\n"]}, {"input": "5\n8 4 3 2 7\nLLRLL\n", "output": ["4 L\n3  R\n7  R\n8 L\n2 L\n"]}, {"input": "5\n3 6 2 9 7\nLLRLL\n", "output": ["6 L\n3  R\n7  R\n9 L\n2 L\n"]}, {"input": "5\n3 23 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n23 L\n2 L\n"]}, {"input": "5\n3 11 1 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n4 4 3 2 9\nLLRLL\n", "output": ["4 L\n3  R\n4  R\n9 L\n2 L\n"]}, {"input": "5\n8 4 3 2 2\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n8 L\n2 L\n"]}, {"input": "5\n13 4 3 2 2\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n13 L\n2 L\n"]}, {"input": "5\n6 4 3 2 11\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n11 L\n2 L\n"]}, {"input": "5\n5 8 2 9 7\nLLRLL\n", "output": ["7 L\n5  R\n8  R\n9 L\n2 L\n"]}, {"input": "5\n3 17 1 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n17 L\n1 L\n"]}, {"input": "5\n6 1 5 2 9\nLLRLL\n", "output": ["5 L\n2  R\n6  R\n9 L\n1 L\n"]}, {"input": "5\n3 23 3 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n23 L\n3 L\n"]}, {"input": "5\n13 4 6 2 2\nLLRLL\n", "output": ["4 L\n2  R\n6  R\n13 L\n2 L\n"]}, {"input": "5\n5 8 2 15 7\nLLRLL\n", "output": ["7 L\n5  R\n8  R\n15 L\n2 L\n"]}, {"input": "5\n3 15 1 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n15 L\n1 L\n"]}, {"input": "5\n13 8 6 2 2\nLLRLL\n", "output": ["6 L\n2  R\n8  R\n13 L\n2 L\n"]}, {"input": "5\n5 8 2 10 7\nLLRLL\n", "output": ["7 L\n5  R\n8  R\n10 L\n2 L\n"]}, {"input": "5\n3 5 2 13 7\nLLRLL\n", "output": ["5 L\n3  R\n7  R\n13 L\n2 L\n"]}, {"input": "5\n5 4 2 2 7\nLLRLL\n", "output": ["4 L\n2  R\n5  R\n7 L\n2 L\n"]}, {"input": "5\n6 4 2 2 12\nLLRLL\n", "output": ["4 L\n2  R\n6  R\n12 L\n2 L\n"]}, {"input": "5\n3 8 2 14 7\nLLRLL\n", "output": ["7 L\n3  R\n8  R\n14 L\n2 L\n"]}, {"input": "5\n5 16 1 9 7\nLLRLL\n", "output": ["7 L\n5  R\n9  R\n16 L\n1 L\n"]}, {"input": "5\n6 4 3 2 16\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n16 L\n2 L\n"]}, {"input": "5\n6 6 5 2 9\nLLRLL\n", "output": ["6 L\n5  R\n6  R\n9 L\n2 L\n"]}, {"input": "5\n3 5 2 9 7\nLLRLL\n", "output": ["5 L\n3  R\n7  R\n9 L\n2 L\n"]}, {"input": "5\n4 11 1 9 7\nLLRLL\n", "output": ["7 L\n4  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n4 1 3 2 9\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n9 L\n1 L\n"]}, {"input": "5\n13 4 5 2 2\nLLRLL\n", "output": ["4 L\n2  R\n5  R\n13 L\n2 L\n"]}, {"input": "5\n6 4 3 1 11\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n11 L\n1 L\n"]}, {"input": "5\n5 8 2 9 10\nLLRLL\n", "output": ["8 L\n5  R\n9  R\n10 L\n2 L\n"]}, {"input": "5\n3 30 1 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n30 L\n1 L\n"]}, {"input": "5\n6 1 5 2 16\nLLRLL\n", "output": ["5 L\n2  R\n6  R\n16 L\n1 L\n"]}, {"input": "5\n3 30 3 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n30 L\n3 L\n"]}, {"input": "5\n13 4 6 2 3\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n13 L\n2 L\n"]}, {"input": "5\n3 15 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n15 L\n2 L\n"]}, {"input": "5\n13 8 8 2 2\nLLRLL\n", "output": ["8 L\n2  R\n8  R\n13 L\n2 L\n"]}, {"input": "5\n3 8 2 6 7\nLLRLL\n", "output": ["6 L\n3  R\n7  R\n8 L\n2 L\n"]}, {"input": "5\n1 4 3 2 16\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n16 L\n1 L\n"]}, {"input": "5\n6 10 5 2 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n10 L\n2 L\n"]}, {"input": "5\n6 5 2 9 7\nLLRLL\n", "output": ["6 L\n5  R\n7  R\n9 L\n2 L\n"]}, {"input": "5\n4 11 1 9 12\nLLRLL\n", "output": ["9 L\n4  R\n11  R\n12 L\n1 L\n"]}, {"input": "5\n5 8 2 9 8\nLLRLL\n", "output": ["8 L\n5  R\n8  R\n9 L\n2 L\n"]}, {"input": "5\n6 1 5 2 26\nLLRLL\n", "output": ["5 L\n2  R\n6  R\n26 L\n1 L\n"]}, {"input": "5\n3 15 2 9 6\nLLRLL\n", "output": ["6 L\n3  R\n9  R\n15 L\n2 L\n"]}, {"input": "5\n1 4 4 2 16\nLLRLL\n", "output": ["4 L\n2  R\n4  R\n16 L\n1 L\n"]}, {"input": "5\n6 10 8 2 9\nLLRLL\n", "output": ["8 L\n6  R\n9  R\n10 L\n2 L\n"]}, {"input": "5\n6 1 5 2 4\nLLRLL\n", "output": ["4 L\n2  R\n5  R\n6 L\n1 L\n"]}, {"input": "5\n6 12 8 2 9\nLLRLL\n", "output": ["8 L\n6  R\n9  R\n12 L\n2 L\n"]}, {"input": "5\n1 12 8 2 9\nLLRLL\n", "output": ["8 L\n2  R\n9  R\n12 L\n1 L\n"]}, {"input": "5\n3 6 2 13 7\nLLRLL\n", "output": ["6 L\n3  R\n7  R\n13 L\n2 L\n"]}, {"input": "5\n3 4 2 2 12\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n12 L\n2 L\n"]}, {"input": "5\n6 4 2 2 4\nLLRLL\n", "output": ["4 L\n2  R\n4  R\n6 L\n2 L\n"]}, {"input": "5\n3 8 2 19 7\nLLRLL\n", "output": ["7 L\n3  R\n8  R\n19 L\n2 L\n"]}, {"input": "5\n4 8 2 9 7\nLLRLL\n", "output": ["7 L\n4  R\n8  R\n9 L\n2 L\n"]}, {"input": "5\n3 8 4 13 9\nLLRLL\n", "output": ["8 L\n4  R\n9  R\n13 L\n3 L\n"]}, {"input": "5\n6 4 3 2 2\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n6 L\n2 L\n"]}, {"input": "5\n3 16 1 7 7\nLLRLL\n", "output": ["7 L\n3  R\n7  R\n16 L\n1 L\n"]}, {"input": "5\n6 4 2 2 9\nLLRLL\n", "output": ["4 L\n2  R\n6  R\n9 L\n2 L\n"]}, {"input": "5\n6 2 5 2 9\nLLRLL\n", "output": ["5 L\n2  R\n6  R\n9 L\n2 L\n"]}, {"input": "5\n8 5 3 2 7\nLLRLL\n", "output": ["5 L\n3  R\n7  R\n8 L\n2 L\n"]}, {"input": "5\n3 11 1 9 8\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n8 4 6 2 2\nLLRLL\n", "output": ["4 L\n2  R\n6  R\n8 L\n2 L\n"]}, {"input": "5\n3 4 3 2 2\nLLRLL\n", "output": ["3 L\n2  R\n3  R\n4 L\n2 L\n"]}, {"input": "5\n5 8 2 4 7\nLLRLL\n", "output": ["5 L\n4  R\n7  R\n8 L\n2 L\n"]}, {"input": "5\n3 27 1 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n27 L\n1 L\n"]}, {"input": "5\n6 1 4 2 9\nLLRLL\n", "output": ["4 L\n2  R\n6  R\n9 L\n1 L\n"]}, {"input": "5\n5 8 2 15 10\nLLRLL\n", "output": ["8 L\n5  R\n10  R\n15 L\n2 L\n"]}, {"input": "5\n13 8 6 4 2\nLLRLL\n", "output": ["6 L\n4  R\n8  R\n13 L\n2 L\n"]}, {"input": "5\n6 8 2 2 12\nLLRLL\n", "output": ["6 L\n2  R\n8  R\n12 L\n2 L\n"]}, {"input": "5\n6 7 3 2 16\nLLRLL\n", "output": ["6 L\n3  R\n7  R\n16 L\n2 L\n"]}, {"input": "5\n6 12 5 2 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n12 L\n2 L\n"]}, {"input": "5\n4 1 3 2 6\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n6 L\n1 L\n"]}, {"input": "5\n6 4 3 1 4\nLLRLL\n", "output": ["4 L\n3  R\n4  R\n6 L\n1 L\n"]}, {"input": "5\n3 30 5 9 7\nLLRLL\n", "output": ["7 L\n5  R\n9  R\n30 L\n3 L\n"]}, {"input": "5\n3 17 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n17 L\n2 L\n"]}, {"input": "5\n6 11 5 2 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n11 L\n2 L\n"]}, {"input": "5\n4 14 1 9 12\nLLRLL\n", "output": ["9 L\n4  R\n12  R\n14 L\n1 L\n"]}, {"input": "5\n6 1 5 2 45\nLLRLL\n", "output": ["5 L\n2  R\n6  R\n45 L\n1 L\n"]}, {"input": "5\n6 16 8 2 9\nLLRLL\n", "output": ["8 L\n6  R\n9  R\n16 L\n2 L\n"]}, {"input": "5\n6 12 8 3 9\nLLRLL\n", "output": ["8 L\n6  R\n9  R\n12 L\n3 L\n"]}, {"input": "5\n3 14 2 4 7\nLLRLL\n", "output": ["4 L\n3  R\n7  R\n14 L\n2 L\n"]}, {"input": "5\n6 4 1 2 4\nLLRLL\n", "output": ["4 L\n2  R\n4  R\n6 L\n1 L\n"]}, {"input": "5\n4 8 2 6 7\nLLRLL\n", "output": ["6 L\n4  R\n7  R\n8 L\n2 L\n"]}, {"input": "5\n5 8 4 13 9\nLLRLL\n", "output": ["8 L\n5  R\n9  R\n13 L\n4 L\n"]}, {"input": "5\n8 5 3 2 1\nLLRLL\n", "output": ["3 L\n2  R\n5  R\n8 L\n1 L\n"]}, {"input": "5\n5 11 1 9 8\nLLRLL\n", "output": ["8 L\n5  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n10 8 2 4 7\nLLRLL\n", "output": ["7 L\n4  R\n8  R\n10 L\n2 L\n"]}, {"input": "5\n6 1 8 2 9\nLLRLL\n", "output": ["6 L\n2  R\n8  R\n9 L\n1 L\n"]}, {"input": "5\n5 8 2 15 8\nLLRLL\n", "output": ["8 L\n5  R\n8  R\n15 L\n2 L\n"]}, {"input": "5\n6 8 2 4 12\nLLRLL\n", "output": ["6 L\n4  R\n8  R\n12 L\n2 L\n"]}, {"input": "5\n6 12 5 4 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n12 L\n4 L\n"]}, {"input": "5\n6 4 3 1 7\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n7 L\n1 L\n"]}, {"input": "5\n3 30 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n30 L\n2 L\n"]}, {"input": "5\n3 21 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n9  R\n21 L\n2 L\n"]}, {"input": "5\n5 16 8 2 9\nLLRLL\n", "output": ["8 L\n5  R\n9  R\n16 L\n2 L\n"]}, {"input": "5\n6 19 8 3 9\nLLRLL\n", "output": ["8 L\n6  R\n9  R\n19 L\n3 L\n"]}, {"input": "5\n3 1 2 4 7\nLLRLL\n", "output": ["3 L\n2  R\n4  R\n7 L\n1 L\n"]}, {"input": "5\n5 4 2 2 4\nLLRLL\n", "output": ["4 L\n2  R\n4  R\n5 L\n2 L\n"]}, {"input": "5\n4 8 1 6 7\nLLRLL\n", "output": ["6 L\n4  R\n7  R\n8 L\n1 L\n"]}, {"input": "5\n5 8 4 16 9\nLLRLL\n", "output": ["8 L\n5  R\n9  R\n16 L\n4 L\n"]}, {"input": "5\n5 11 1 9 6\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n6 1 8 2 10\nLLRLL\n", "output": ["6 L\n2  R\n8  R\n10 L\n1 L\n"]}, {"input": "5\n7 8 2 4 12\nLLRLL\n", "output": ["7 L\n4  R\n8  R\n12 L\n2 L\n"]}, {"input": "5\n6 13 5 4 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n13 L\n4 L\n"]}, {"input": "5\n3 7 2 9 7\nLLRLL\n", "output": ["7 L\n3  R\n7  R\n9 L\n2 L\n"]}, {"input": "5\n5 21 2 9 7\nLLRLL\n", "output": ["7 L\n5  R\n9  R\n21 L\n2 L\n"]}, {"input": "5\n5 16 8 2 13\nLLRLL\n", "output": ["8 L\n5  R\n13  R\n16 L\n2 L\n"]}, {"input": "5\n4 19 8 3 9\nLLRLL\n", "output": ["8 L\n4  R\n9  R\n19 L\n3 L\n"]}, {"input": "5\n4 8 2 7 7\nLLRLL\n", "output": ["7 L\n4  R\n7  R\n8 L\n2 L\n"]}, {"input": "5\n6 8 4 16 9\nLLRLL\n", "output": ["8 L\n6  R\n9  R\n16 L\n4 L\n"]}, {"input": "5\n5 11 1 18 6\nLLRLL\n", "output": ["6 L\n5  R\n11  R\n18 L\n1 L\n"]}, {"input": "5\n6 1 8 3 10\nLLRLL\n", "output": ["6 L\n3  R\n8  R\n10 L\n1 L\n"]}, {"input": "5\n6 16 5 4 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n16 L\n4 L\n"]}, {"input": "5\n3 7 2 10 7\nLLRLL\n", "output": ["7 L\n3  R\n7  R\n10 L\n2 L\n"]}, {"input": "5\n5 21 2 9 12\nLLRLL\n", "output": ["9 L\n5  R\n12  R\n21 L\n2 L\n"]}, {"input": "5\n2 19 8 3 9\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n19 L\n2 L\n"]}, {"input": "5\n4 8 2 13 7\nLLRLL\n", "output": ["7 L\n4  R\n8  R\n13 L\n2 L\n"]}, {"input": "5\n5 2 4 16 9\nLLRLL\n", "output": ["5 L\n4  R\n9  R\n16 L\n2 L\n"]}, {"input": "5\n6 1 8 3 16\nLLRLL\n", "output": ["6 L\n3  R\n8  R\n16 L\n1 L\n"]}, {"input": "5\n5 21 3 9 12\nLLRLL\n", "output": ["9 L\n5  R\n12  R\n21 L\n3 L\n"]}, {"input": "5\n2 10 8 3 9\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n10 L\n2 L\n"]}, {"input": "5\n4 8 2 19 7\nLLRLL\n", "output": ["7 L\n4  R\n8  R\n19 L\n2 L\n"]}, {"input": "5\n5 21 3 9 9\nLLRLL\n", "output": ["9 L\n5  R\n9  R\n21 L\n3 L\n"]}, {"input": "5\n3 8 2 34 7\nLLRLL\n", "output": ["7 L\n3  R\n8  R\n34 L\n2 L\n"]}, {"input": "5\n3 8 1 13 9\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n13 L\n1 L\n"]}, {"input": "5\n3 23 2 4 7\nLLRLL\n", "output": ["4 L\n3  R\n7  R\n23 L\n2 L\n"]}, {"input": "5\n3 11 1 9 9\nLLRLL\n", "output": ["9 L\n3  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n4 4 3 2 6\nLLRLL\n", "output": ["4 L\n3  R\n4  R\n6 L\n2 L\n"]}, {"input": "5\n6 7 3 2 11\nLLRLL\n", "output": ["6 L\n3  R\n7  R\n11 L\n2 L\n"]}, {"input": "5\n5 8 2 9 13\nLLRLL\n", "output": ["8 L\n5  R\n9  R\n13 L\n2 L\n"]}, {"input": "5\n6 1 5 1 9\nLLRLL\n", "output": ["5 L\n1  R\n6  R\n9 L\n1 L\n"]}, {"input": "5\n3 6 3 4 7\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n7 L\n3 L\n"]}, {"input": "5\n4 23 3 9 7\nLLRLL\n", "output": ["7 L\n4  R\n9  R\n23 L\n3 L\n"]}, {"input": "5\n3 15 1 9 10\nLLRLL\n", "output": ["9 L\n3  R\n10  R\n15 L\n1 L\n"]}, {"input": "5\n5 8 2 10 13\nLLRLL\n", "output": ["8 L\n5  R\n10  R\n13 L\n2 L\n"]}, {"input": "5\n3 5 2 13 4\nLLRLL\n", "output": ["4 L\n3  R\n5  R\n13 L\n2 L\n"]}, {"input": "5\n2 16 1 9 7\nLLRLL\n", "output": ["7 L\n2  R\n9  R\n16 L\n1 L\n"]}, {"input": "5\n8 6 5 2 9\nLLRLL\n", "output": ["6 L\n5  R\n8  R\n9 L\n2 L\n"]}, {"input": "5\n4 11 1 6 7\nLLRLL\n", "output": ["6 L\n4  R\n7  R\n11 L\n1 L\n"]}, {"input": "5\n13 4 3 4 2\nLLRLL\n", "output": ["4 L\n3  R\n4  R\n13 L\n2 L\n"]}, {"input": "5\n5 16 2 9 10\nLLRLL\n", "output": ["9 L\n5  R\n10  R\n16 L\n2 L\n"]}, {"input": "5\n3 30 3 9 8\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n30 L\n3 L\n"]}, {"input": "5\n18 4 6 2 3\nLLRLL\n", "output": ["4 L\n3  R\n6  R\n18 L\n2 L\n"]}, {"input": "5\n13 7 8 2 2\nLLRLL\n", "output": ["7 L\n2  R\n8  R\n13 L\n2 L\n"]}, {"input": "5\n6 10 5 1 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n10 L\n1 L\n"]}, {"input": "5\n6 5 3 9 7\nLLRLL\n", "output": ["6 L\n5  R\n7  R\n9 L\n3 L\n"]}, {"input": "5\n4 11 1 9 23\nLLRLL\n", "output": ["9 L\n4  R\n11  R\n23 L\n1 L\n"]}, {"input": "5\n6 1 5 4 26\nLLRLL\n", "output": ["5 L\n4  R\n6  R\n26 L\n1 L\n"]}, {"input": "5\n3 30 2 9 6\nLLRLL\n", "output": ["6 L\n3  R\n9  R\n30 L\n2 L\n"]}, {"input": "5\n6 3 2 9 10\nLLRLL\n", "output": ["6 L\n3  R\n9  R\n10 L\n2 L\n"]}, {"input": "5\n6 2 5 2 4\nLLRLL\n", "output": ["4 L\n2  R\n5  R\n6 L\n2 L\n"]}, {"input": "5\n1 12 8 4 9\nLLRLL\n", "output": ["8 L\n4  R\n9  R\n12 L\n1 L\n"]}, {"input": "5\n1 6 2 13 7\nLLRLL\n", "output": ["6 L\n2  R\n7  R\n13 L\n1 L\n"]}, {"input": "5\n3 8 4 19 7\nLLRLL\n", "output": ["7 L\n4  R\n8  R\n19 L\n3 L\n"]}, {"input": "5\n3 14 4 13 9\nLLRLL\n", "output": ["9 L\n4  R\n13  R\n14 L\n3 L\n"]}, {"input": "5\n6 4 8 2 9\nLLRLL\n", "output": ["6 L\n4  R\n8  R\n9 L\n2 L\n"]}, {"input": "5\n2 11 1 9 8\nLLRLL\n", "output": ["8 L\n2  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n5 8 1 4 7\nLLRLL\n", "output": ["5 L\n4  R\n7  R\n8 L\n1 L\n"]}, {"input": "5\n5 8 2 28 10\nLLRLL\n", "output": ["8 L\n5  R\n10  R\n28 L\n2 L\n"]}, {"input": "5\n2 8 2 7 14\nLLRLL\n", "output": ["7 L\n2  R\n8  R\n14 L\n2 L\n"]}, {"input": "5\n6 7 3 2 28\nLLRLL\n", "output": ["6 L\n3  R\n7  R\n28 L\n2 L\n"]}, {"input": "5\n6 23 5 2 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n23 L\n2 L\n"]}, {"input": "5\n6 11 5 4 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n11 L\n4 L\n"]}, {"input": "5\n6 12 8 4 9\nLLRLL\n", "output": ["8 L\n6  R\n9  R\n12 L\n4 L\n"]}, {"input": "5\n5 14 2 4 7\nLLRLL\n", "output": ["5 L\n4  R\n7  R\n14 L\n2 L\n"]}, {"input": "5\n5 8 4 13 4\nLLRLL\n", "output": ["5 L\n4  R\n8  R\n13 L\n4 L\n"]}, {"input": "5\n8 5 6 2 1\nLLRLL\n", "output": ["5 L\n2  R\n6  R\n8 L\n1 L\n"]}, {"input": "5\n5 11 1 9 16\nLLRLL\n", "output": ["9 L\n5  R\n11  R\n16 L\n1 L\n"]}, {"input": "5\n10 8 2 6 7\nLLRLL\n", "output": ["7 L\n6  R\n8  R\n10 L\n2 L\n"]}, {"input": "5\n8 1 8 2 9\nLLRLL\n", "output": ["8 L\n2  R\n8  R\n9 L\n1 L\n"]}, {"input": "5\n6 18 5 4 9\nLLRLL\n", "output": ["6 L\n5  R\n9  R\n18 L\n4 L\n"]}, {"input": "5\n4 16 8 2 9\nLLRLL\n", "output": ["8 L\n4  R\n9  R\n16 L\n2 L\n"]}, {"input": "5\n6 19 12 3 9\nLLRLL\n", "output": ["9 L\n6  R\n12  R\n19 L\n3 L\n"]}, {"input": "5\n5 8 4 16 10\nLLRLL\n", "output": ["8 L\n5  R\n10  R\n16 L\n4 L\n"]}, {"input": "5\n9 11 1 9 6\nLLRLL\n", "output": ["9 L\n6  R\n9  R\n11 L\n1 L\n"]}, {"input": "5\n6 1 8 2 12\nLLRLL\n", "output": ["6 L\n2  R\n8  R\n12 L\n1 L\n"]}, {"input": "5\n7 8 2 8 12\nLLRLL\n", "output": ["8 L\n7  R\n8  R\n12 L\n2 L\n"]}, {"input": "5\n5 2 1 18 6\nLLRLL\n", "output": ["5 L\n2  R\n6  R\n18 L\n1 L\n"]}, {"input": "5\n5 1 8 3 10\nLLRLL\n", "output": ["5 L\n3  R\n8  R\n10 L\n1 L\n"]}, {"input": "5\n12 16 5 4 9\nLLRLL\n", "output": ["9 L\n5  R\n12  R\n16 L\n4 L\n"]}, {"input": "5\n3 19 8 3 9\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n19 L\n3 L\n"]}, {"input": "5\n5 4 4 16 9\nLLRLL\n", "output": ["5 L\n4  R\n9  R\n16 L\n4 L\n"]}, {"input": "5\n5 38 3 9 12\nLLRLL\n", "output": ["9 L\n5  R\n12  R\n38 L\n3 L\n"]}, {"input": "5\n3 10 8 3 9\nLLRLL\n", "output": ["8 L\n3  R\n9  R\n10 L\n3 L\n"]}, {"input": "5\n1 8 2 19 7\nLLRLL\n", "output": ["7 L\n2  R\n8  R\n19 L\n1 L\n"]}], "source_codes": ["import sys\ninput = sys.stdin.read\n\ndef main():\n    data = input().split()\n    N = int(data[0])\n    A = list(map(int, data[1:N+1]))\n    S = data[N+1]\n    \n    # Sort weights\n    weights = sorted(A)\n    used = [False] * N\n    left_sum = 0\n    right_sum = 0\n    result = []\n    \n    for ch in S:\n        # Find unused weights - smallest and largest\n        min_idx, max_idx = -1, -1\n        for i in range(N):\n            if not used[i]:\n                min_idx = i\n                break\n        for i in range(N-1, -1, -1):\n            if not used[i]:\n                max_idx = i\n                break\n        \n        if min_idx == -1:  # No more weights\n            print(-1)\n            return\n            \n        min_weight = weights[min_idx]\n        max_weight = weights[max_idx]\n        \n        if ch == 'L':\n            # Want left side to be heavier than right side\n            # Try placing max weight on left\n            if left_sum + max_weight > right_sum:\n                result.append((max_weight, 'L'))\n                left_sum += max_weight\n                used[max_idx] = True\n            # Try placing min weight on right\n            elif left_sum > right_sum + min_weight:\n                result.append((min_weight, 'R'))\n                right_sum += min_weight\n                used[min_idx] = True\n            # Must place max weight on left even if it doesn't immediately help\n            else:\n                result.append((max_weight, 'L'))\n                left_sum += max_weight\n                used[max_idx] = True\n        else:  # ch == 'R'\n            # Want right side to be heavier than left side\n            # Try placing max weight on right\n            if right_sum + max_weight > left_sum:\n                result.append((max_weight, 'R'))\n                right_sum += max_weight\n                used[max_idx] = True\n            # Try placing min weight on left\n            elif right_sum > left_sum + min_weight:\n                result.append((min_weight, 'L'))\n                left_sum += min_weight\n                used[min_idx] = True\n            # Must place max weight on right even if it doesn't immediately help\n            else:\n                result.append((max_weight, 'R'))\n                right_sum += max_weight\n                used[max_idx] = True\n    \n    # Verify final result satisfies all constraints\n    temp_left = 0\n    temp_right = 0\n    valid = True\n    for i, (weight, side) in enumerate(result):\n        if side == 'L':\n            temp_left += weight\n        else:\n            temp_right += weight\n        if S[i] == 'L' and temp_left <= temp_right:\n            valid = False\n            break\n        if S[i] == 'R' and temp_right <= temp_left:\n            valid = False\n            break\n    \n    if not valid:\n        print(-1)\n        return\n        \n    for weight, side in result:\n        print(weight, side)\n\nif __name__ == \"__main__\":\n    main()"], "responses": ["\nimport sys\ninput = sys.stdin.read\n\ndef main():\n    data = input().split()\n    N = int(data[0])\n    A = list(map(int, data[1:N+1]))\n    S = data[N+1]\n    \n    # Sort weights\n    weights = sorted(A)\n    used = [False] * N\n    left_sum = 0\n    right_sum = 0\n    result = []\n    \n    for ch in S:\n        # Find unused weights - smallest and largest\n        min_idx, max_idx = -1, -1\n        for i in range(N):\n            if not used[i]:\n                min_idx = i\n                break\n        for i in range(N-1, -1, -1):\n            if not used[i]:\n                max_idx = i\n                break\n        \n        if min_idx == -1:  # No more weights\n            print(-1)\n            return\n            \n        min_weight = weights[min_idx]\n        max_weight = weights[max_idx]\n        \n        if ch == 'L':\n            # Want left side to be heavier than right side\n            # Try placing max weight on left\n            if left_sum + max_weight > right_sum:\n                result.append((max_weight, 'L'))\n                left_sum += max_weight\n                used[max_idx] = True\n            # Try placing min weight on right\n            elif left_sum > right_sum + min_weight:\n                result.append((min_weight, 'R'))\n                right_sum += min_weight\n                used[min_idx] = True\n            # Must place max weight on left even if it doesn't immediately help\n            else:\n                result.append((max_weight, 'L'))\n                left_sum += max_weight\n                used[max_idx] = True\n        else:  # ch == 'R'\n            # Want right side to be heavier than left side\n            # Try placing max weight on right\n            if right_sum + max_weight > left_sum:\n                result.append((max_weight, 'R'))\n                right_sum += max_weight\n                used[max_idx] = True\n            # Try placing min weight on left\n            elif right_sum > left_sum + min_weight:\n                result.append((min_weight, 'L'))\n                left_sum += min_weight\n                used[min_idx] = True\n            # Must place max weight on right even if it doesn't immediately help\n            else:\n                result.append((max_weight, 'R'))\n                right_sum += max_weight\n                used[max_idx] = True\n    \n    # Verify final result satisfies all constraints\n    temp_left = 0\n    temp_right = 0\n    valid = True\n    for i, (weight, side) in enumerate(result):\n        if side == 'L':\n            temp_left += weight\n        else:\n            temp_right += weight\n        if S[i] == 'L' and temp_left <= temp_right:\n            valid = False\n            break\n        if S[i] == 'R' and temp_right <= temp_left:\n            valid = False\n            break\n    \n    if not valid:\n        print(-1)\n        return\n        \n    for weight, side in result:\n        print(weight, side)\n\nif __name__ == \"__main__\":\n    main()\n\n\n"], "prompt_tokens": [13293], "completion_tokens": [7643], "no_of_try": 1, "api_calls": 10, "is_solved": false, "language": "Python3", "task_id": 1599}
{"name": "1600_E. Array Game", "description": "Alice and Bob are playing a game. They are given an array A of length N. The array consists of integers. They are building a sequence together. In the beginning, the sequence is empty. In one turn a player can remove a number from the left or right side of the array and append it to the sequence. The rule is that the sequence they are building must be strictly increasing. The winner is the player that makes the last move. Alice is playing first. Given the starting array, under the assumption that they both play optimally, who wins the game?\n\nInput\n\nThe first line contains one integer N (1 \u2264 N \u2264 2*10^5) - the length of the array A.\n\nThe second line contains N integers A_1, A_2,...,A_N (0 \u2264 A_i \u2264 10^9)\n\nOutput\n\nThe first and only line of output consists of one string, the name of the winner. If Alice won, print \"Alice\", otherwise, print \"Bob\".\n\nExamples\n\nInput\n\n\n1\n5\n\n\nOutput\n\n\nAlice\n\n\nInput\n\n\n3\n5 4 5\n\n\nOutput\n\n\nAlice\n\n\nInput\n\n\n6\n5 8 2 1 10 9\n\n\nOutput\n\n\nBob", "tags": ["games", "greedy", "two pointers"], "difficulty": 11, "id": 1600, "sample_io": [{"input": "6\n5 8 2 1 10 9\n", "output": ["Bob\n"]}, {"input": "3\n5 4 5\n", "output": ["Alice\n"]}, {"input": "1\n5\n", "output": ["Alice\n"]}], "test_list": [{"input": "3\n5 6 5\n", "output": ["Bob\n"]}, {"input": "2\n5 12\n", "output": ["Alice\n"]}, {"input": "3\n5 6 9\n", "output": ["Alice\n"]}, {"input": "6\n2 6 0 0 5 0\n", "output": ["Bob\n"]}, {"input": "2\n5 2\n", "output": ["Alice\n"]}, {"input": "6\n5 4 2 1 10 9\n", "output": ["Alice\n"]}, {"input": "3\n5 1 5\n", "output": ["Alice\n"]}, {"input": "1\n2\n", "output": ["Alice\n"]}, {"input": "3\n5 6 10\n", "output": ["Alice\n"]}, {"input": "2\n5 3\n", "output": ["Alice\n"]}, {"input": "6\n4 4 2 1 10 9\n", "output": ["Alice\n"]}, {"input": "3\n7 1 5\n", "output": ["Alice\n"]}, {"input": "1\n3\n", "output": ["Alice\n"]}, {"input": "2\n5 5\n", "output": ["Alice\n"]}, {"input": "6\n4 3 2 1 10 9\n", "output": ["Alice\n"]}, {"input": "3\n7 1 3\n", "output": ["Alice\n"]}, {"input": "1\n1\n", "output": ["Alice\n"]}, {"input": "2\n5 7\n", "output": ["Alice\n"]}, {"input": "6\n4 3 2 0 10 9\n", "output": ["Alice\n"]}, {"input": "3\n7 1 1\n", "output": ["Alice\n"]}, {"input": "1\n0\n", "output": ["Alice\n"]}, {"input": "2\n5 0\n", "output": ["Alice\n"]}, {"input": "6\n4 3 2 0 12 9\n", "output": ["Alice\n"]}, {"input": "3\n7 1 2\n", "output": ["Alice\n"]}, {"input": "1\n4\n", "output": ["Alice\n"]}, {"input": "2\n10 0\n", "output": ["Alice\n"]}, {"input": "6\n4 3 0 0 12 9\n", "output": ["Alice\n"]}, {"input": "3\n13 1 2\n", "output": ["Alice\n"]}, {"input": "2\n0 0\n", "output": ["Alice\n"]}, {"input": "6\n4 3 0 0 12 6\n", "output": ["Alice\n"]}, {"input": "3\n13 1 4\n", "output": ["Alice\n"]}, {"input": "2\n1 0\n", "output": ["Alice\n"]}, {"input": "6\n4 3 0 0 14 6\n", "output": ["Alice\n"]}, {"input": "3\n13 2 4\n", "output": ["Alice\n"]}, {"input": "2\n1 1\n", "output": ["Alice\n"]}, {"input": "6\n7 3 0 0 14 6\n", "output": ["Alice\n"]}, {"input": "3\n13 0 4\n", "output": ["Alice\n"]}, {"input": "2\n0 1\n", "output": ["Alice\n"]}, {"input": "6\n7 3 0 0 14 5\n", "output": ["Alice\n"]}, {"input": "3\n4 0 4\n", "output": ["Alice\n"]}, {"input": "2\n0 2\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 0 14 5\n", "output": ["Alice\n"]}, {"input": "3\n4 0 0\n", "output": ["Alice\n"]}, {"input": "2\n0 4\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 0 17 5\n", "output": ["Alice\n"]}, {"input": "3\n6 0 0\n", "output": ["Alice\n"]}, {"input": "2\n1 4\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 0 17 6\n", "output": ["Alice\n"]}, {"input": "3\n6 1 0\n", "output": ["Alice\n"]}, {"input": "2\n2 4\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 0 17 11\n", "output": ["Alice\n"]}, {"input": "3\n6 1 -1\n", "output": ["Alice\n"]}, {"input": "2\n1 8\n", "output": ["Alice\n"]}, {"input": "6\n7 6 0 0 17 11\n", "output": ["Alice\n"]}, {"input": "3\n6 1 -2\n", "output": ["Alice\n"]}, {"input": "2\n1 -1\n", "output": ["Alice\n"]}, {"input": "6\n7 6 0 0 17 12\n", "output": ["Alice\n"]}, {"input": "3\n6 0 -2\n", "output": ["Alice\n"]}, {"input": "2\n0 -1\n", "output": ["Alice\n"]}, {"input": "6\n6 6 0 0 17 12\n", "output": ["Alice\n"]}, {"input": "3\n9 0 0\n", "output": ["Alice\n"]}, {"input": "2\n0 -2\n", "output": ["Alice\n"]}, {"input": "6\n6 6 0 0 5 12\n", "output": ["Alice\n"]}, {"input": "3\n15 0 0\n", "output": ["Alice\n"]}, {"input": "6\n2 6 0 0 5 12\n", "output": ["Alice\n"]}, {"input": "3\n15 1 0\n", "output": ["Alice\n"]}, {"input": "3\n15 0 1\n", "output": ["Alice\n"]}, {"input": "6\n2 9 0 0 5 0\n", "output": ["Bob\n"]}, {"input": "6\n2 12 0 0 5 0\n", "output": ["Bob\n"]}, {"input": "6\n2 7 0 0 5 0\n", "output": ["Bob\n"]}, {"input": "6\n2 7 0 0 2 0\n", "output": ["Bob\n"]}, {"input": "6\n2 7 1 0 2 0\n", "output": ["Bob\n"]}, {"input": "6\n1 7 1 0 2 0\n", "output": ["Bob\n"]}, {"input": "6\n1 0 1 0 2 0\n", "output": ["Alice\n"]}, {"input": "6\n1 0 2 0 2 0\n", "output": ["Alice\n"]}, {"input": "6\n0 0 2 0 2 0\n", "output": ["Alice\n"]}, {"input": "3\n5 7 10\n", "output": ["Alice\n"]}, {"input": "2\n4 12\n", "output": ["Alice\n"]}, {"input": "6\n5 8 0 1 10 9\n", "output": ["Bob\n"]}, {"input": "3\n5 8 5\n", "output": ["Bob\n"]}, {"input": "1\n8\n", "output": ["Alice\n"]}, {"input": "3\n5 6 11\n", "output": ["Alice\n"]}, {"input": "2\n3 2\n", "output": ["Alice\n"]}, {"input": "6\n5 4 4 1 10 9\n", "output": ["Alice\n"]}, {"input": "3\n2 1 5\n", "output": ["Alice\n"]}, {"input": "3\n5 8 10\n", "output": ["Alice\n"]}, {"input": "2\n9 3\n", "output": ["Alice\n"]}, {"input": "6\n4 8 2 1 10 9\n", "output": ["Bob\n"]}, {"input": "3\n7 2 5\n", "output": ["Alice\n"]}, {"input": "2\n-1 2\n", "output": ["Alice\n"]}, {"input": "6\n4 3 2 1 0 9\n", "output": ["Alice\n"]}, {"input": "3\n6 1 3\n", "output": ["Alice\n"]}, {"input": "2\n9 7\n", "output": ["Alice\n"]}, {"input": "6\n4 0 2 0 10 9\n", "output": ["Alice\n"]}, {"input": "3\n7 1 0\n", "output": ["Alice\n"]}, {"input": "2\n5 1\n", "output": ["Alice\n"]}, {"input": "6\n4 3 2 0 12 11\n", "output": ["Alice\n"]}, {"input": "3\n7 0 2\n", "output": ["Alice\n"]}, {"input": "1\n6\n", "output": ["Alice\n"]}, {"input": "2\n16 0\n", "output": ["Alice\n"]}, {"input": "6\n4 3 0 -1 12 9\n", "output": ["Alice\n"]}, {"input": "3\n17 1 2\n", "output": ["Alice\n"]}, {"input": "2\n-1 0\n", "output": ["Alice\n"]}, {"input": "6\n6 3 0 0 12 6\n", "output": ["Alice\n"]}, {"input": "3\n21 1 4\n", "output": ["Alice\n"]}, {"input": "2\n2 -1\n", "output": ["Alice\n"]}, {"input": "6\n1 3 0 0 14 6\n", "output": ["Bob\n"]}, {"input": "3\n23 2 4\n", "output": ["Alice\n"]}, {"input": "2\n1 2\n", "output": ["Alice\n"]}, {"input": "6\n7 3 0 -1 14 6\n", "output": ["Alice\n"]}, {"input": "3\n17 0 4\n", "output": ["Alice\n"]}, {"input": "2\n0 3\n", "output": ["Alice\n"]}, {"input": "6\n7 3 0 0 28 5\n", "output": ["Alice\n"]}, {"input": "3\n4 0 5\n", "output": ["Alice\n"]}, {"input": "2\n1 3\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 1 14 5\n", "output": ["Alice\n"]}, {"input": "3\n7 0 0\n", "output": ["Alice\n"]}, {"input": "2\n1 -2\n", "output": ["Alice\n"]}, {"input": "6\n7 4 -1 0 17 5\n", "output": ["Alice\n"]}, {"input": "3\n6 1 1\n", "output": ["Alice\n"]}, {"input": "2\n1 7\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 1 17 6\n", "output": ["Alice\n"]}, {"input": "3\n8 1 0\n", "output": ["Alice\n"]}, {"input": "2\n2 2\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 0 17 7\n", "output": ["Alice\n"]}, {"input": "3\n11 0 0\n", "output": ["Alice\n"]}, {"input": "2\n2 8\n", "output": ["Alice\n"]}, {"input": "6\n4 6 0 0 17 11\n", "output": ["Bob\n"]}, {"input": "3\n7 0 -2\n", "output": ["Alice\n"]}, {"input": "2\n2 -2\n", "output": ["Alice\n"]}, {"input": "6\n7 6 0 0 17 5\n", "output": ["Alice\n"]}, {"input": "3\n11 0 -2\n", "output": ["Alice\n"]}, {"input": "2\n-1 1\n", "output": ["Alice\n"]}, {"input": "6\n0 6 0 0 17 12\n", "output": ["Bob\n"]}, {"input": "3\n9 1 0\n", "output": ["Alice\n"]}, {"input": "6\n6 6 0 0 5 10\n", "output": ["Alice\n"]}, {"input": "3\n5 0 0\n", "output": ["Alice\n"]}, {"input": "6\n2 7 0 0 5 12\n", "output": ["Alice\n"]}, {"input": "3\n15 2 0\n", "output": ["Alice\n"]}, {"input": "6\n2 6 0 0 4 0\n", "output": ["Bob\n"]}, {"input": "3\n15 1 1\n", "output": ["Alice\n"]}, {"input": "6\n3 9 0 0 5 0\n", "output": ["Bob\n"]}, {"input": "6\n1 12 0 0 5 0\n", "output": ["Bob\n"]}, {"input": "6\n2 7 0 0 7 0\n", "output": ["Bob\n"]}, {"input": "6\n2 7 0 0 3 0\n", "output": ["Bob\n"]}, {"input": "6\n2 0 1 0 2 0\n", "output": ["Alice\n"]}, {"input": "6\n1 6 1 0 2 0\n", "output": ["Bob\n"]}, {"input": "6\n1 0 3 0 2 0\n", "output": ["Alice\n"]}, {"input": "3\n10 7 10\n", "output": ["Alice\n"]}, {"input": "2\n1 12\n", "output": ["Alice\n"]}, {"input": "6\n8 8 0 1 10 9\n", "output": ["Alice\n"]}, {"input": "1\n10\n", "output": ["Alice\n"]}, {"input": "3\n8 6 11\n", "output": ["Alice\n"]}, {"input": "2\n3 4\n", "output": ["Alice\n"]}, {"input": "6\n5 4 4 2 10 9\n", "output": ["Alice\n"]}, {"input": "3\n2 2 5\n", "output": ["Alice\n"]}, {"input": "3\n5 9 10\n", "output": ["Alice\n"]}, {"input": "2\n14 3\n", "output": ["Alice\n"]}, {"input": "6\n4 8 4 1 10 9\n", "output": ["Bob\n"]}, {"input": "3\n10 2 5\n", "output": ["Alice\n"]}, {"input": "2\n-1 3\n", "output": ["Alice\n"]}, {"input": "6\n4 3 2 1 0 13\n", "output": ["Alice\n"]}, {"input": "3\n6 0 3\n", "output": ["Alice\n"]}, {"input": "2\n15 7\n", "output": ["Alice\n"]}, {"input": "6\n4 1 2 0 10 9\n", "output": ["Alice\n"]}, {"input": "3\n7 2 0\n", "output": ["Alice\n"]}, {"input": "2\n2 0\n", "output": ["Alice\n"]}, {"input": "6\n4 3 2 0 8 11\n", "output": ["Alice\n"]}, {"input": "3\n3 0 2\n", "output": ["Alice\n"]}, {"input": "1\n9\n", "output": ["Alice\n"]}, {"input": "2\n4 0\n", "output": ["Alice\n"]}, {"input": "6\n4 3 0 -1 6 9\n", "output": ["Alice\n"]}, {"input": "3\n17 2 2\n", "output": ["Alice\n"]}, {"input": "2\n-2 0\n", "output": ["Alice\n"]}, {"input": "6\n5 3 0 0 12 6\n", "output": ["Alice\n"]}, {"input": "3\n21 1 5\n", "output": ["Alice\n"]}, {"input": "2\n2 1\n", "output": ["Alice\n"]}, {"input": "6\n1 3 1 0 14 6\n", "output": ["Bob\n"]}, {"input": "3\n23 3 4\n", "output": ["Alice\n"]}, {"input": "2\n-1 4\n", "output": ["Alice\n"]}, {"input": "6\n7 3 0 -1 14 0\n", "output": ["Alice\n"]}, {"input": "2\n0 8\n", "output": ["Alice\n"]}, {"input": "6\n7 3 0 -1 28 5\n", "output": ["Alice\n"]}, {"input": "3\n4 0 1\n", "output": ["Alice\n"]}, {"input": "2\n1 5\n", "output": ["Alice\n"]}, {"input": "6\n7 4 1 1 14 5\n", "output": ["Alice\n"]}, {"input": "3\n12 0 0\n", "output": ["Alice\n"]}, {"input": "2\n1 -3\n", "output": ["Alice\n"]}, {"input": "6\n7 4 -1 0 17 1\n", "output": ["Alice\n"]}, {"input": "3\n0 1 1\n", "output": ["Alice\n"]}, {"input": "2\n1 11\n", "output": ["Alice\n"]}, {"input": "6\n7 4 0 1 17 5\n", "output": ["Alice\n"]}, {"input": "3\n5 1 0\n", "output": ["Alice\n"]}, {"input": "2\n-1 5\n", "output": ["Alice\n"]}, {"input": "6\n7 0 0 0 17 7\n", "output": ["Alice\n"]}, {"input": "3\n11 1 0\n", "output": ["Alice\n"]}, {"input": "2\n3 8\n", "output": ["Alice\n"]}, {"input": "6\n4 6 0 0 17 3\n", "output": ["Bob\n"]}, {"input": "2\n4 -1\n", "output": ["Alice\n"]}, {"input": "6\n7 4 1 0 17 5\n", "output": ["Alice\n"]}, {"input": "3\n9 0 -2\n", "output": ["Alice\n"]}, {"input": "2\n-2 1\n", "output": ["Alice\n"]}], "source_codes": ["import sys\nimport threading\n\ndef main():\n    sys.setrecursionlimit(1 << 25)\n    \n    N = int(sys.stdin.readline())\n    A = list(map(int, sys.stdin.readline().split()))\n    \n    memo = {}\n    \n    def can_win(l, r, last):\n        # Returns True if the current player can force a win from this state\n        if l > r:\n            return False  # No moves left, current player loses\n        \n        if (l, r, last) in memo:\n            return memo[(l, r, last)]\n        \n        # Try taking from left\n        if A[l] > last:\n            # If opponent loses after this move, current player wins\n            if not can_win(l + 1, r, A[l]):\n                memo[(l, r, last)] = True\n                return True\n        \n        # Try taking from right\n        if A[r] > last:\n            # If opponent loses after this move, current player wins\n            if not can_win(l, r - 1, A[r]):\n                memo[(l, r, last)] = True\n                return True\n        \n        # If no winning move found, current player loses\n        memo[(l, r, last)] = False\n        return False\n    \n    # Alice starts first, so we check if Alice (the first player) can win\n    if can_win(0, N - 1, -1):\n        print(\"Alice\")\n    else:\n        print(\"Bob\")\n\nthreading.Thread(target=main).start()"], "responses": ["\nimport sys\nimport threading\n\ndef main():\n    sys.setrecursionlimit(1 << 25)\n    \n    N = int(sys.stdin.readline())\n    A = list(map(int, sys.stdin.readline().split()))\n    \n    memo = {}\n    \n    def can_win(l, r, last):\n        # Returns True if the current player can force a win from this state\n        if l > r:\n            return False  # No moves left, current player loses\n        \n        if (l, r, last) in memo:\n            return memo[(l, r, last)]\n        \n        # Try taking from left\n        if A[l] > last:\n            # If opponent loses after this move, current player wins\n            if not can_win(l + 1, r, A[l]):\n                memo[(l, r, last)] = True\n                return True\n        \n        # Try taking from right\n        if A[r] > last:\n            # If opponent loses after this move, current player wins\n            if not can_win(l, r - 1, A[r]):\n                memo[(l, r, last)] = True\n                return True\n        \n        # If no winning move found, current player loses\n        memo[(l, r, last)] = False\n        return False\n    \n    # Alice starts first, so we check if Alice (the first player) can win\n    if can_win(0, N - 1, -1):\n        print(\"Alice\")\n    else:\n        print(\"Bob\")\n\nthreading.Thread(target=main).start()\n\n\n"], "prompt_tokens": [10576], "completion_tokens": [5130], "no_of_try": 1, "api_calls": 10, "is_solved": true, "language": "Python3", "task_id": 1600}
{"name": "1601_A. Array Elimination", "description": "You are given array a_1, a_2, \u2026, a_n, consisting of non-negative integers.\n\nLet's define operation of \"elimination\" with integer parameter k (1 \u2264 k \u2264 n) as follows:\n\n  * Choose k distinct array indices 1 \u2264 i_1 < i_2 < \u2026 < i_k \u2264 n. \n  * Calculate x = a_{i_1} ~ \\& ~ a_{i_2} ~ \\& ~ \u2026 ~ \\& ~ a_{i_k}, where \\& denotes the [bitwise AND operation](https://en.wikipedia.org/wiki/Bitwise_operation#AND) (notes section contains formal definition). \n  * Subtract x from each of a_{i_1}, a_{i_2}, \u2026, a_{i_k}; all other elements remain untouched. \n\n\n\nFind all possible values of k, such that it's possible to make all elements of array a equal to 0 using a finite number of elimination operations with parameter k. It can be proven that exists at least one possible k for any array a.\n\nNote that you firstly choose k and only after that perform elimination operations with value k you've chosen initially.\n\nInput\n\nEach test contains multiple test cases. The first line contains the number of test cases t (1 \u2264 t \u2264 10^4). Description of the test cases follows.\n\nThe first line of each test case contains one integer n (1 \u2264 n \u2264 200 000) \u2014 the length of array a.\n\nThe second line of each test case contains n integers a_1, a_2, \u2026, a_n (0 \u2264 a_i < 2^{30}) \u2014 array a itself.\n\nIt's guaranteed that the sum of n over all test cases doesn't exceed 200 000.\n\nOutput\n\nFor each test case, print all values k, such that it's possible to make all elements of a equal to 0 in a finite number of elimination operations with the given parameter k.\n\nPrint them in increasing order.\n\nExample\n\nInput\n\n\n5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n\n\nOutput\n\n\n1 2 4\n1 2\n1\n1\n1 2 3 4 5\n\nNote\n\nIn the first test case:\n\n  * If k = 1, we can make four elimination operations with sets of indices \\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}. Since \\& of one element is equal to the element itself, then for each operation x = a_i, so a_i - x = a_i - a_i = 0. \n  * If k = 2, we can make two elimination operations with, for example, sets of indices \\{1, 3\\} and \\{2, 4\\}: x = a_1 ~ \\& ~ a_3 = a_2 ~ \\& ~ a_4 = 4 ~ \\& ~ 4 = 4. For both operations x = 4, so after the first operation a_1 - x = 0 and a_3 - x = 0, and after the second operation \u2014 a_2 - x = 0 and a_4 - x = 0. \n  * If k = 3, it's impossible to make all a_i equal to 0. After performing the first operation, we'll get three elements equal to 0 and one equal to 4. After that, all elimination operations won't change anything, since at least one chosen element will always be equal to 0. \n  * If k = 4, we can make one operation with set \\{1, 2, 3, 4\\}, because x = a_1 ~ \\& ~ a_2 ~ \\& ~ a_3 ~ \\& ~ a_4 = 4. \n\n\n\nIn the second test case, if k = 2 then we can make the following elimination operations:\n\n  * Operation with indices \\{1, 3\\}: x = a_1 ~ \\& ~ a_3 = 13 ~ \\& ~ 25 = 9. a_1 - x = 13 - 9 = 4 and a_3 - x = 25 - 9 = 16. Array a will become equal to [4, 7, 16, 19]. \n  * Operation with indices \\{3, 4\\}: x = a_3 ~ \\& ~ a_4 = 16 ~ \\& ~ 19 = 16. a_3 - x = 16 - 16 = 0 and a_4 - x = 19 - 16 = 3. Array a will become equal to [4, 7, 0, 3]. \n  * Operation with indices \\{2, 4\\}: x = a_2 ~ \\& ~ a_4 = 7 ~ \\& ~ 3 = 3. a_2 - x = 7 - 3 = 4 and a_4 - x = 3 - 3 = 0. Array a will become equal to [4, 4, 0, 0]. \n  * Operation with indices \\{1, 2\\}: x = a_1 ~ \\& ~ a_2 = 4 ~ \\& ~ 4 = 4. a_1 - x = 4 - 4 = 0 and a_2 - x = 4 - 4 = 0. Array a will become equal to [0, 0, 0, 0]. \n\n\n\nFormal definition of bitwise AND:\n\nLet's define bitwise AND (\\&) as follows. Suppose we have two non-negative integers x and y, let's look at their binary representations (possibly, with leading zeroes): x_k ... x_2 x_1 x_0 and y_k ... y_2 y_1 y_0. Here, x_i is the i-th bit of number x, and y_i is the i-th bit of number y. Let r = x ~ \\& ~ y is a result of operation \\& on number x and y. Then binary representation of r will be r_k ... r_2 r_1 r_0, where:\n\n$$$ r_i = \\begin{cases} 1, ~ if ~ x_i = 1 ~ and ~ y_i = 1 \\\\\\ 0, ~ if ~ x_i = 0 ~ or ~ y_i = 0 \\end{cases} $$$", "tags": ["bitmasks", "greedy", "math", "number theory"], "difficulty": 7, "id": 1601, "sample_io": [{"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4 \n1 2 \n1 \n1 \n1 2 3 4 5 \n"]}], "test_list": [{"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 8 4 4\n4\n13 7 25 19\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 4\n4\n23 7 25 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n5 7 25 19\n6\n0 5 3 1 8 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 2\n4\n13 7 25 19\n6\n0 5 3 2 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 4 4\n4\n13 7 50 19\n6\n6 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 3\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 1 2\n1\n1\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n24 7 25 19\n6\n3 3 4 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1 2\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n0 4 4 4\n4\n24 7 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 1 0 0\n", "output": ["1 3\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 1 2\n1\n1\n5\n1 1 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 8 3 2 8 1\n1\n1\n5\n0 0 0 0 2\n", "output": ["1 2 4\n1 2\n1 2\n1\n1\n"]}, {"input": "5\n4\n4 0 8 6\n4\n23 9 5 19\n6\n3 5 3 1 8 1\n1\n1\n5\n1 1 0 0 0\n", "output": ["1\n1\n1\n1\n1 2\n"]}, {"input": "5\n4\n1 4 4 4\n4\n13 11 25 19\n6\n3 4 3 1 7 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1 2\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 2 4 4\n4\n13 7 25 19\n6\n0 8 3 2 8 1\n1\n1\n5\n0 0 0 0 2\n", "output": ["1\n1 2\n1 2\n1\n1\n"]}, {"input": "5\n4\n1 4 4 4\n4\n13 11 25 19\n6\n3 4 3 1 7 2\n1\n2\n5\n0 0 0 1 0\n", "output": ["1\n1\n1 2\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n5 7 25 21\n6\n0 5 3 1 13 1\n1\n0\n5\n0 1 1 0 1\n", "output": ["1 2 4\n1\n1\n1\n1 3\n"]}, {"input": "5\n4\n4 9 8 5\n4\n23 7 32 32\n6\n3 0 2 1 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 8 8 4\n4\n13 7 25 19\n6\n3 5 3 1 13 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 6 3 1 13 0\n1\n1\n5\n0 0 0 1 1\n", "output": ["1 2 4\n1 2\n1\n1\n1 2\n"]}, {"input": "5\n4\n0 4 4 4\n4\n13 7 25 19\n1\n0 6 3 1 13 0\n1\n1\n5\n0 0 0 1 1\n", "output": ["1 3\n1 2\n1\n1\n1 2\n"]}, {"input": "5\n4\n4 4 7 4\n4\n13 7 25 19\n6\n0 6 3 1 13 0\n1\n1\n5\n0 0 0 1 1\n", "output": ["1\n1 2\n1\n1\n1 2\n"]}, {"input": "5\n4\n4 4 8 4\n4\n13 7 25 23\n6\n3 5 3 1 6 1\n1\n1\n5\n0 1 1 0 1\n", "output": ["1\n1\n1\n1\n1 3\n"]}, {"input": "5\n4\n8 4 8 4\n4\n13 7 25 14\n6\n3 5 3 1 6 1\n1\n1\n5\n0 1 1 0 1\n", "output": ["1 2\n1\n1\n1\n1 3\n"]}, {"input": "5\n4\n8 4 8 4\n4\n13 7 25 14\n6\n3 5 3 1 6 1\n1\n1\n5\n1 1 1 0 1\n", "output": ["1 2\n1\n1\n1\n1 2 4\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n3 7 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1 2\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n1 1 4 4\n4\n13 5 25 19\n6\n6 9 3 2 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n0 4 4 4\n4\n13 0 25 19\n1\n0 6 3 1 13 0\n1\n1\n5\n0 0 0 1 1\n", "output": ["1 3\n1\n1\n1\n1 2\n"]}, {"input": "5\n4\n8 4 8 2\n4\n13 7 25 14\n6\n3 5 3 1 6 1\n1\n1\n5\n1 1 1 0 1\n", "output": ["1\n1\n1\n1\n1 2 4\n"]}, {"input": "5\n4\n4 4 0 4\n4\n13 7 25 19\n6\n3 9 5 1 11 1\n1\n1\n5\n0 1 0 0 0\n", "output": ["1 3\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n8 4 8 4\n4\n3 7 25 14\n6\n3 5 3 1 6 2\n1\n1\n5\n0 2 1 0 1\n", "output": ["1 2\n1\n1 2\n1\n1\n"]}, {"input": "5\n4\n8 2 8 2\n4\n13 7 25 14\n6\n3 5 3 2 6 1\n1\n1\n5\n1 1 1 0 1\n", "output": ["1 2\n1\n1 2\n1\n1 2 4\n"]}, {"input": "5\n4\n4 4 0 4\n4\n13 7 25 28\n6\n3 5 3 1 1 1\n1\n1\n5\n1 1 1 0 0\n", "output": ["1 3\n1\n1\n1\n1 3\n"]}, {"input": "5\n4\n8 2 8 4\n4\n13 7 25 14\n6\n3 5 3 2 6 1\n1\n1\n5\n1 1 1 0 1\n", "output": ["1\n1\n1 2\n1\n1 2 4\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 38 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n23 7 25 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n24 7 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 38 19\n6\n6 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n24 7 25 19\n6\n3 5 4 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 4\n4\n23 7 25 18\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n2 4 4 4\n4\n13 7 25 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n6 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n3 5 3 1 7 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n1 5 0 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 1 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 5 3 2 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n23 7 25 19\n6\n3 9 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n24 7 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 1 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 8 4 4\n4\n13 7 25 34\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 1 0 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 8 6\n4\n23 7 25 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n24 7 18 19\n6\n3 5 4 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 4\n4\n23 7 25 18\n6\n3 0 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 50 19\n6\n6 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 14 25 19\n6\n1 5 0 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 1 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n5 7 25 19\n6\n0 5 1 1 8 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n23 7 25 19\n6\n3 9 3 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n22 7 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 1 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 2 4 4\n4\n13 7 25 34\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 8 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 1 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 8 6\n4\n23 9 25 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 5\n4\n23 7 25 18\n6\n3 0 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 14 25 19\n6\n1 7 0 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 2\n4\n13 7 25 19\n6\n0 5 3 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n46 7 25 19\n6\n3 9 3 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n22 7 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 8 25 19\n6\n0 5 3 1 8 1\n1\n0\n5\n0 1 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 8 6\n4\n23 9 39 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 5\n4\n23 7 25 32\n6\n3 0 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 4\n4\n13 7 50 19\n6\n6 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 14 25 19\n6\n1 7 0 1 8 1\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 19\n6\n0 5 3 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n46 7 25 19\n6\n3 9 3 1 5 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n22 7 25 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 8 25 20\n6\n0 5 3 1 8 1\n1\n0\n5\n0 1 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 8 6\n4\n23 9 39 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 5\n4\n23 7 30 32\n6\n3 0 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 4\n4\n13 7 50 19\n6\n6 5 1 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 14 25 19\n6\n1 7 0 1 4 1\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 27 19\n6\n3 5 3 1 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 19\n6\n0 3 3 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 5\n4\n46 7 25 19\n6\n3 9 3 1 5 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n22 7 25 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 1 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 8 6\n4\n23 9 5 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 5\n4\n23 7 30 32\n6\n3 0 6 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 4\n4\n13 7 50 19\n6\n0 5 1 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 14 25 19\n6\n1 7 0 1 4 2\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n17 7 27 19\n6\n3 5 3 1 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 19\n6\n0 3 6 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 8 5\n4\n23 7 30 32\n6\n3 0 2 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 4\n4\n13 7 50 19\n6\n0 5 0 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n17 7 27 19\n6\n3 5 3 1 1 2\n1\n3\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 19\n6\n0 1 6 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 50 19\n6\n0 5 0 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n0 5 4 2\n4\n13 7 25 19\n6\n0 1 6 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 50 19\n6\n0 4 0 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 50 19\n6\n0 4 0 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 38 19\n6\n0 4 0 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 16\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 25 19\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 2 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n7 7 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n2 4 4 4\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n1 7 38 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 3 4 4\n4\n23 7 25 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n24 7 25 19\n6\n3 5 3 1 7 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 8 4 4\n4\n13 7 25 19\n6\n1 5 3 1 8 0\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 7 4 4\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 13 38 19\n6\n6 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 8 4\n4\n23 7 25 18\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n6 5 3 1 8 1\n1\n1\n5\n0 0 1 0 0\n", "output": ["1 2 4\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n1 4 4 4\n4\n13 7 25 19\n6\n3 5 3 1 7 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 7 4\n4\n13 7 25 19\n6\n1 5 0 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 1 2\n1\n1\n5\n1 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 19\n6\n0 5 3 2 8 1\n1\n1\n5\n0 0 0 0 2\n", "output": ["1 2 4\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n5 7 25 19\n6\n0 5 3 1 13 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n23 7 25 19\n6\n3 9 3 1 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 8 4 4\n4\n13 7 25 55\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 6\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 1 0 0 0\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 8 6\n4\n23 7 25 19\n6\n3 5 3 1 8 1\n1\n0\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 2\n4\n13 7 25 19\n6\n0 5 3 2 4 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n22 5 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 1 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 2 4 4\n4\n13 7 25 34\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 8 6\n4\n23 9 25 7\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 5\n4\n23 7 25 0\n6\n3 0 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n46 7 25 19\n6\n3 9 3 1 8 1\n1\n4\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 8 5\n4\n23 7 25 32\n6\n3 1 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 4\n4\n13 7 50 19\n6\n6 5 3 1 8 1\n1\n1\n5\n0 0 0 1 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n17 14 25 19\n6\n1 7 0 1 8 1\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 17 19\n6\n3 5 3 0 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 13\n6\n0 5 3 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n46 7 43 19\n6\n3 9 3 1 5 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 6\n4\n13 8 25 20\n6\n0 5 3 1 8 1\n1\n0\n5\n0 1 0 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 8 6\n4\n18 9 39 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 14 26 19\n6\n1 7 0 1 4 1\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 3 19\n6\n3 5 3 1 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 19\n6\n1 3 3 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 5\n4\n46 7 25 19\n6\n3 15 3 1 5 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 8 6\n4\n23 9 5 19\n6\n3 5 3 1 8 1\n1\n1\n5\n0 1 0 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 4\n4\n13 14 25 19\n6\n1 7 0 1 4 2\n1\n0\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n6 4 4 4\n4\n17 7 27 19\n6\n3 5 3 1 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 19\n6\n0 3 6 2 11 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 8 8 5\n4\n23 7 30 32\n6\n3 0 2 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 2 4 4\n4\n17 7 27 19\n6\n3 5 3 1 1 2\n1\n3\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 50 19\n6\n0 5 0 1 8 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 54 19\n6\n0 4 0 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 38 28\n6\n0 4 0 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 16\n6\n3 5 3 1 8 1\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 8\n4\n13 7 25 19\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 5 4\n4\n13 7 17 19\n6\n3 5 3 1 2 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n8 7 25 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n2 4 4 4\n4\n13 7 25 19\n6\n0 5 3 0 8 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 8\n4\n1 7 38 19\n6\n3 5 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 3 4 4\n4\n23 7 25 5\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 6\n4\n24 7 25 19\n6\n3 5 3 1 7 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 8 4 3\n4\n13 7 25 19\n6\n1 5 3 1 8 0\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 7 4 4\n4\n13 7 47 19\n6\n0 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 13 38 19\n6\n6 4 3 1 7 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n24 7 25 19\n6\n3 3 4 1 7 2\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1 2\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n1 4 4 4\n4\n13 11 25 19\n6\n3 5 3 1 7 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n5 7 25 21\n6\n0 5 3 1 13 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n0 4 4 4\n4\n24 7 25 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 3\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 8 4 4\n4\n13 7 48 55\n6\n1 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 2\n4\n13 7 25 19\n6\n0 5 3 2 4 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n22 5 16 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 1 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 7 5\n4\n23 7 25 0\n6\n3 0 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n46 7 25 19\n6\n3 9 3 1 5 1\n1\n4\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 4\n4\n13 7 17 19\n6\n3 5 3 0 0 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 18 13\n6\n0 5 3 2 8 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n46 7 12 19\n6\n3 9 3 1 5 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 8 6\n4\n18 9 39 19\n6\n3 5 3 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 14 26 19\n6\n1 7 0 1 4 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 0\n4\n13 7 3 19\n6\n3 5 3 1 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 4\n4\n13 14 25 19\n6\n1 7 0 1 4 2\n1\n0\n5\n0 0 0 0 1\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n6 4 4 4\n4\n5 7 27 19\n6\n3 5 3 1 1 2\n1\n2\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 5 4 2\n4\n13 7 25 19\n6\n0 3 5 2 11 1\n1\n2\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n4 8 8 5\n4\n23 7 32 32\n6\n3 0 2 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 2 4 4\n4\n17 7 27 19\n6\n1 5 3 1 1 2\n1\n3\n5\n0 0 1 0 0\n", "output": ["1\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 54 19\n6\n0 4 0 2 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 0 6 1\n4\n13 7 38 28\n6\n0 4 0 1 8 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 25 16\n6\n3 0 3 1 8 1\n1\n0\n5\n0 0 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n3 4 4 8\n4\n13 7 25 19\n6\n1 5 3 1 8 1\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1 2\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 5 4\n4\n13 7 29 19\n6\n3 5 3 1 2 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n8 7 25 19\n6\n0 2 3 1 8 1\n1\n1\n5\n0 0 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n1 4 4 4\n4\n13 7 25 19\n6\n0 5 3 1 8 1\n1\n0\n5\n0 0 0 0 1\n", "output": ["1\n1 2\n1\n1\n1\n"]}, {"input": "5\n4\n7 3 4 4\n4\n23 7 25 5\n6\n3 5 3 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 6\n4\n24 8 25 19\n6\n3 5 3 1 7 2\n1\n2\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 8 4 3\n4\n13 7 12 19\n6\n1 5 3 1 8 0\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 7 4 4\n4\n13 7 47 19\n6\n0 5 4 1 8 1\n1\n1\n5\n0 0 0 0 0\n", "output": ["1\n1\n1\n1\n1 2 3 4 5\n"]}, {"input": "5\n4\n4 4 4 4\n4\n13 7 17 19\n6\n3 5 3 1 1 2\n1\n1\n5\n1 2 0 0 0\n", "output": ["1 2 4\n1\n1\n1\n1\n"]}, {"input": "5\n4\n4 4 4 4\n4\n5 7 25 21\n6\n0 5 3 1 13 1\n1\n0\n5\n0 1 0 0 1\n", "output": ["1 2 4\n1\n1\n1\n1 2\n"]}, {"input": "5\n4\n0 4 4 4\n4\n24 7 37 19\n6\n3 5 3 1 7 2\n1\n1\n5\n0 0 0 0 0\n", "output": ["1 3\n1\n1\n1\n1 2 3 4 5\n"]}], "source_codes": ["import sys\n\ndef main():\n    input = sys.stdin.read\n    data = input().split()\n    \n    index = 0\n    t = int(data[index])\n    index += 1\n    results = []\n    \n    for _ in range(t):\n        n = int(data[index])\n        index += 1\n        a = list(map(int, data[index:index+n]))\n        index += n\n        \n        # Count how many times each bit is set\n        bit_count = [0] * 30\n        for num in a:\n            for i in range(30):\n                if num & (1 << i):\n                    bit_count[i] += 1\n                    \n        # Find all valid k values\n        valid_k = []\n        for k in range(1, n + 1):\n            valid = True\n            for count in bit_count:\n                if count % k != 0:\n                    valid = False\n                    break\n            if valid:\n                valid_k.append(k)\n                \n        # Format output without trailing space\n        results.append(' '.join(map(str, valid_k)))\n        \n    print('\\n'.join(results))\n\nif __name__ == \"__main__\":\n    main()"], "responses": ["\nimport sys\n\ndef main():\n    input = sys.stdin.read\n    data = input().split()\n    \n    index = 0\n    t = int(data[index])\n    index += 1\n    results = []\n    \n    for _ in range(t):\n        n = int(data[index])\n        index += 1\n        a = list(map(int, data[index:index+n]))\n        index += n\n        \n        # Count how many times each bit is set\n        bit_count = [0] * 30\n        for num in a:\n            for i in range(30):\n                if num & (1 << i):\n                    bit_count[i] += 1\n                    \n        # Find all valid k values\n        valid_k = []\n        for k in range(1, n + 1):\n            valid = True\n            for count in bit_count:\n                if count % k != 0:\n                    valid = False\n                    break\n            if valid:\n                valid_k.append(k)\n                \n        # Format output without trailing space\n        results.append(' '.join(map(str, valid_k)))\n        \n    print('\\n'.join(results))\n\nif __name__ == \"__main__\":\n    main()\n\n\n"], "prompt_tokens": [23517], "completion_tokens": [4735], "no_of_try": 1, "api_calls": 10, "is_solved": true, "language": "Python3", "task_id": 1601}
