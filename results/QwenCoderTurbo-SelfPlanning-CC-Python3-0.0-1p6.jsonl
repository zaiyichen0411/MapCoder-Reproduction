{"name": "1575_F. Finding Expected Value", "description": "Mr. Chanek opened a letter from his fellow, who is currently studying at Singanesia. Here is what it says.\n\nDefine an array b (0 \u2264 b_i < k) with n integers. While there exists a pair (i, j) such that b_i \u2260 b_j, do the following operation:\n\n  * Randomly pick a number i satisfying 0 \u2264 i < n. Note that each number i has a probability of 1/n to be picked. \n  * Randomly Pick a number j satisfying 0 \u2264 j < k. \n  * Change the value of b_i to j. It is possible for b_i to be changed to the same value. \n\n\n\nDenote f(b) as the expected number of operations done to b until all elements of b are equal. \n\nYou are given two integers n and k, and an array a (-1 \u2264 a_i < k) of n integers. \n\nFor every index i with a_i = -1, replace a_i with a random number j satisfying 0 \u2264 j < k. Let c be the number of occurrences of -1 in a. There are k^c possibilites of a after the replacement, each with equal probability of being the final array.\n\nFind the expected value of f(a) modulo 10^9 + 7. \n\nFormally, let M = 10^9 + 7. It can be shown that the answer can be expressed as an irreducible fraction p/q, where p and q are integers and q not \u2261 0 \\pmod{M}. Output the integer equal to p \u22c5 q^{-1} mod M. In other words, output such an integer x that 0 \u2264 x < M and x \u22c5 q \u2261 p \\pmod{M}.\n\nAfter reading the letter, Mr. Chanek gave the task to you. Solve it for the sake of their friendship!\n\nInput\n\nThe first line contains two integers n and k (2 \u2264 n \u2264 10^5, 2 \u2264 k \u2264 10^9). \n\nThe second line contains n integers a_1, a_2, \u2026, a_n (-1 \u2264 a_i < k).\n\nOutput\n\nOutput an integer denoting the expected value of f(a) modulo 10^9 + 7.\n\nExamples\n\nInput\n\n\n2 2\n0 1\n\n\nOutput\n\n\n2\n\n\nInput\n\n\n2 2\n0 -1\n\n\nOutput\n\n\n1\n\n\nInput\n\n\n3 3\n0 1 1\n\n\nOutput\n\n\n12\n\n\nInput\n\n\n3 3\n-1 -1 -1\n\n\nOutput\n\n\n11\n\n\nInput\n\n\n10 9\n-1 0 -1 1 1 2 2 3 3 3\n\n\nOutput\n\n\n652419213", "tags": ["math"], "difficulty": 12, "id": 1575, "sample_io": [{"input": "10 9\n-1 0 -1 1 1 2 2 3 3 3\n", "output": ["652419213\n"]}, {"input": "3 3\n-1 -1 -1\n", "output": ["11\n"]}, {"input": "2 2\n0 -1\n", "output": ["1\n"]}, {"input": "3 3\n0 1 1\n", "output": ["12\n"]}, {"input": "2 2\n0 1\n", "output": ["2\n"]}], "test_list": [{"input": "2 1684\n-1 -1\n", "output": ["1683\n"]}, {"input": "2 2000\n1486 -1\n", "output": ["1999\n"]}, {"input": "2 2000\n-1 1990\n", "output": ["1999\n"]}, {"input": "2 1973\n818 208\n", "output": ["1973\n"]}, {"input": "2 1105\n-1 -1\n", "output": ["1104\n"]}, {"input": "2 551\n-1 -1\n", "output": ["550\n"]}, {"input": "2 2\n1 1\n", "output": ["0\n"]}, {"input": "2 434\n424 377\n", "output": ["434\n"]}, {"input": "2 63\n23 52\n", "output": ["63\n"]}, {"input": "2 927\n852 -1\n", "output": ["926\n"]}, {"input": "2 33\n2 27\n", "output": ["33\n"]}, {"input": "2 1626\n1312 -1\n", "output": ["1625\n"]}, {"input": "2 838\n-1 753\n", "output": ["837\n"]}, {"input": "2 2\n-1 -1\n", "output": ["1\n"]}, {"input": "2 2\n-1 0\n", "output": ["1\n"]}, {"input": "2 1421\n326 -1\n", "output": ["1420\n"]}, {"input": "2 1059\n616 151\n", "output": ["1059\n"]}, {"input": "2 2\n0 0\n", "output": ["0\n"]}, {"input": "2 1408\n-1 566\n", "output": ["1407\n"]}, {"input": "2 2000\n-1 -1\n", "output": ["1999\n"]}, {"input": "2 900\n468 702\n", "output": ["900\n"]}, {"input": "2 2000\n33 -1\n", "output": ["1999\n"]}, {"input": "2 660\n-1 -1\n", "output": ["659\n"]}, {"input": "2 6\n3 3\n", "output": ["0\n"]}, {"input": "2 68\n-1 -1\n", "output": ["67\n"]}, {"input": "2 2000\n1280 -1\n", "output": ["1999\n"]}, {"input": "1 2000\n-1 1990\n", "output": ["0\n"]}, {"input": "2 1973\n818 260\n", "output": ["1973\n"]}, {"input": "2 2128\n-1 -1\n", "output": ["2127\n"]}, {"input": "2 434\n845 377\n", "output": ["434\n"]}, {"input": "2 63\n23 60\n", "output": ["63\n"]}, {"input": "2 32\n2 27\n", "output": ["32\n"]}, {"input": "2 1626\n2014 -1\n", "output": ["1625\n"]}, {"input": "2 838\n-1 366\n", "output": ["837\n"]}, {"input": "2 4\n-1 0\n", "output": ["3\n"]}, {"input": "2 1421\n554 -1\n", "output": ["1420\n"]}, {"input": "2 1059\n23 151\n", "output": ["1059\n"]}, {"input": "2 4\n0 1\n", "output": ["4\n"]}, {"input": "2 1408\n-1 357\n", "output": ["1407\n"]}, {"input": "2 275\n-1 -1\n", "output": ["274\n"]}, {"input": "2 6\n2 3\n", "output": ["6\n"]}, {"input": "10 9\n-1 0 -1 1 1 2 2 3 4 3\n", "output": ["688133507\n"]}, {"input": "2 2\n1 -1\n", "output": ["1\n"]}, {"input": "3 3\n0 1 0\n", "output": ["12\n"]}, {"input": "2 109\n-1 -1\n", "output": ["108\n"]}, {"input": "2 311\n2014 -1\n", "output": ["310\n"]}, {"input": "2 449\n554 -1\n", "output": ["448\n"]}, {"input": "2 1250\n23 151\n", "output": ["1250\n"]}, {"input": "2 10\n2 3\n", "output": ["10\n"]}, {"input": "3 3\n0 1 -1\n", "output": ["500000016\n"]}, {"input": "2 3\n-1 1\n", "output": ["2\n"]}, {"input": "10 9\n-1 0 -1 1 0 2 2 3 4 5\n", "output": ["295276363\n"]}, {"input": "3 4\n0 1 0\n", "output": ["20\n"]}, {"input": "3 9\n-1 0 -1 1 0 2 2 3 4 5\n", "output": ["92\n"]}, {"input": "3 6\n0 1 0\n", "output": ["42\n"]}, {"input": "2 772\n337 -1\n", "output": ["771\n"]}, {"input": "2 18\n2 3\n", "output": ["18\n"]}, {"input": "2 1231\n15 110\n", "output": ["1231\n"]}, {"input": "2 1783\n15 110\n", "output": ["1783\n"]}, {"input": "2 507\n247 214\n", "output": ["507\n"]}, {"input": "2 8\n1 5\n", "output": ["8\n"]}, {"input": "2 9\n1 5\n", "output": ["9\n"]}, {"input": "2 328\n-1 -1\n", "output": ["327\n"]}, {"input": "2 1282\n-1 -1\n", "output": ["1281\n"]}, {"input": "2 523\n852 -1\n", "output": ["522\n"]}, {"input": "2 33\n4 27\n", "output": ["33\n"]}, {"input": "2 900\n221 702\n", "output": ["900\n"]}, {"input": "2 1396\n33 -1\n", "output": ["1395\n"]}, {"input": "10 4\n-1 0 -1 1 1 2 2 3 3 3\n", "output": ["571792314\n"]}, {"input": "3 3\n0 2 1\n", "output": ["500000017\n"]}, {"input": "2 240\n1280 -1\n", "output": ["239\n"]}, {"input": "2 378\n818 260\n", "output": ["378\n"]}, {"input": "2 29\n2 27\n", "output": ["29\n"]}, {"input": "2 1347\n-1 366\n", "output": ["1346\n"]}, {"input": "2 1551\n-1 357\n", "output": ["1550\n"]}, {"input": "10 9\n-1 0 -1 1 1 1 2 3 4 3\n", "output": ["259562069\n"]}, {"input": "2 311\n2014 0\n", "output": ["311\n"]}, {"input": "2 75\n554 -1\n", "output": ["74\n"]}, {"input": "3 3\n-1 1 -1\n", "output": ["11\n"]}, {"input": "2 84\n24 114\n", "output": ["84\n"]}, {"input": "10 13\n-1 0 -1 1 0 2 2 3 4 5\n", "output": ["799260863\n"]}, {"input": "2 111\n337 -1\n", "output": ["110\n"]}, {"input": "3 9\n-1 0 0 -1 -1 2 2 3 4 5\n", "output": ["80\n"]}, {"input": "2 512\n-1 -1\n", "output": ["511\n"]}, {"input": "2 757\n852 -1\n", "output": ["756\n"]}, {"input": "2 1626\n1972 0\n", "output": ["1626\n"]}, {"input": "2 83\n-1 337\n", "output": ["82\n"]}, {"input": "2 238\n1280 -1\n", "output": ["237\n"]}, {"input": "2 1347\n0 366\n", "output": ["1347\n"]}, {"input": "2 59\n-1 0\n", "output": ["58\n"]}, {"input": "2 130\n554 -1\n", "output": ["129\n"]}, {"input": "3 4\n-1 1 -1\n", "output": ["500000023\n"]}, {"input": "10 13\n-1 0 0 1 0 2 2 3 4 5\n", "output": ["624657679\n"]}, {"input": "2 22\n24 114\n", "output": ["22\n"]}, {"input": "2 1148\n116 -1\n", "output": ["1147\n"]}, {"input": "2 1264\n15 111\n", "output": ["1264\n"]}, {"input": "2 483\n15 111\n", "output": ["483\n"]}, {"input": "3 14\n-1 0 -1 -1 -1 2 4 1 4 5\n", "output": ["500000218\n"]}, {"input": "2 2829\n-1 -1\n", "output": ["2828\n"]}, {"input": "2 1267\n306 702\n", "output": ["1267\n"]}, {"input": "2 463\n1280 -1\n", "output": ["462\n"]}, {"input": "2 53\n1230 260\n", "output": ["53\n"]}, {"input": "2 18\n-1 0\n", "output": ["17\n"]}, {"input": "3 5\n-1 1 -1\n", "output": ["30\n"]}, {"input": "2 2000\n85 0\n", "output": ["2000\n"]}, {"input": "2 62\n18 114\n", "output": ["62\n"]}, {"input": "2 1604\n23 110\n", "output": ["1604\n"]}, {"input": "2 762\n266 107\n", "output": ["762\n"]}, {"input": "2 1148\n116 0\n", "output": ["1148\n"]}, {"input": "2 318\n15 111\n", "output": ["318\n"]}, {"input": "2 24\n1 3\n", "output": ["24\n"]}, {"input": "2 754\n290 218\n", "output": ["754\n"]}, {"input": "2 113\n1557 0\n", "output": ["113\n"]}, {"input": "2 1672\n306 702\n", "output": ["1672\n"]}, {"input": "2 729\n1280 -1\n", "output": ["728\n"]}, {"input": "2 86\n731 -1\n", "output": ["85\n"]}, {"input": "3 6\n-1 1 -1\n", "output": ["500000046\n"]}, {"input": "2 3078\n85 0\n", "output": ["3078\n"]}, {"input": "2 887\n3 -1\n", "output": ["886\n"]}, {"input": "2 117\n266 107\n", "output": ["117\n"]}, {"input": "3 9\n0 2 0\n", "output": ["90\n"]}, {"input": "2 78\n1326 0\n", "output": ["78\n"]}, {"input": "2 667\n247 2\n", "output": ["667\n"]}, {"input": "5 14\n-1 1 -1 -1 -1 2 4 1 4 5\n", "output": ["250042203\n"]}, {"input": "2 2166\n-1 584\n", "output": ["2165\n"]}, {"input": "2 3078\n85 -1\n", "output": ["3077\n"]}, {"input": "2 115\n266 107\n", "output": ["115\n"]}, {"input": "2 499\n8 001\n", "output": ["499\n"]}, {"input": "2 78\n1326 -1\n", "output": ["77\n"]}, {"input": "10 9\n-1 0 -1 0 2 0 2 4 4 5\n", "output": ["652419213\n"]}, {"input": "2 260\n19 011\n", "output": ["260\n"]}, {"input": "2 6178\n1408 0\n", "output": ["6178\n"]}, {"input": "2 5\n1 0\n", "output": ["5\n"]}, {"input": "2 7\n2126 260\n", "output": ["7\n"]}, {"input": "10 9\n-1 0 -1 0 2 0 0 4 4 5\n", "output": ["938133457\n"]}, {"input": "2 20\n-1 1\n", "output": ["19\n"]}, {"input": "2 1113\n16 1\n", "output": ["1113\n"]}, {"input": "2 205\n15 001\n", "output": ["205\n"]}, {"input": "2 99\n833 -1\n", "output": ["98\n"]}, {"input": "2 1215\n1 -1\n", "output": ["1214\n"]}, {"input": "2 2094\n-1 518\n", "output": ["2093\n"]}, {"input": "2 1679\n16 1\n", "output": ["1679\n"]}, {"input": "2 940\n0 011\n", "output": ["940\n"]}, {"input": "2 1219\n163 272\n", "output": ["1219\n"]}, {"input": "2 15\n1 0\n", "output": ["15\n"]}, {"input": "2 1921\n74 315\n", "output": ["1921\n"]}, {"input": "2 2234\n16 1\n", "output": ["2234\n"]}, {"input": "2 267\n15 011\n", "output": ["267\n"]}, {"input": "2 23\n833 0\n", "output": ["23\n"]}, {"input": "2 820\n247 2\n", "output": ["820\n"]}, {"input": "3 14\n0 1 0 -1 -1 2 4 12 2 0\n", "output": ["210\n"]}, {"input": "2 1215\n2 0\n", "output": ["1215\n"]}, {"input": "2 2773\n16 1\n", "output": ["2773\n"]}, {"input": "2 170\n30 53\n", "output": ["170\n"]}, {"input": "2 5348\n6436 0\n", "output": ["5348\n"]}, {"input": "2 21\n2444 260\n", "output": ["21\n"]}, {"input": "2 3357\n70 0\n", "output": ["3357\n"]}, {"input": "2 6331\n6436 0\n", "output": ["6331\n"]}, {"input": "2 2262\n74 978\n", "output": ["2262\n"]}, {"input": "2 437\n27 010\n", "output": ["437\n"]}, {"input": "2 1802\n2435 0\n", "output": ["1802\n"]}, {"input": "2 6331\n6436 -1\n", "output": ["6330\n"]}, {"input": "2 3473\n74 978\n", "output": ["3473\n"]}, {"input": "2 2094\n0 2\n", "output": ["2094\n"]}, {"input": "2 340\n13 102\n", "output": ["340\n"]}, {"input": "2 3200\n10928 -1\n", "output": ["3199\n"]}, {"input": "2 119\n27 111\n", "output": ["119\n"]}, {"input": "2 3200\n10928 0\n", "output": ["3200\n"]}, {"input": "2 172\n27 111\n", "output": ["172\n"]}, {"input": "2 36\n8 110\n", "output": ["36\n"]}, {"input": "2 45\n8 111\n", "output": ["45\n"]}, {"input": "2 49\n3 111\n", "output": ["49\n"]}, {"input": "2 1381\n-1 1990\n", "output": ["1380\n"]}, {"input": "2 1038\n818 208\n", "output": ["1038\n"]}, {"input": "2 126\n852 -1\n", "output": ["125\n"]}, {"input": "2 54\n4 27\n", "output": ["54\n"]}, {"input": "2 1629\n-1 753\n", "output": ["1628\n"]}, {"input": "2 1421\n326 0\n", "output": ["1421\n"]}, {"input": "2 825\n616 151\n", "output": ["825\n"]}, {"input": "2 1236\n-1 566\n", "output": ["1235\n"]}, {"input": "6 9\n-1 0 -1 1 1 2 2 3 3 3\n", "output": ["68198\n"]}, {"input": "2 816\n845 377\n", "output": ["816\n"]}, {"input": "2 412\n-1 -1\n", "output": ["411\n"]}, {"input": "2 35\n142 108\n", "output": ["35\n"]}, {"input": "2 31\n2 3\n", "output": ["31\n"]}, {"input": "3 8\n0 1 0\n", "output": ["72\n"]}, {"input": "2 486\n337 -1\n", "output": ["485\n"]}, {"input": "3 8\n-1 0 -1 0 0 2 2 3 4 5\n", "output": ["500000077\n"]}, {"input": "2 1216\n15 110\n", "output": ["1216\n"]}, {"input": "2 1465\n15 110\n", "output": ["1465\n"]}, {"input": "2 2\n-1 1\n", "output": ["1\n"]}, {"input": "1 2000\n1280 -1\n", "output": ["0\n"]}, {"input": "1 2000\n-2 1990\n", "output": ["0\n"]}, {"input": "1 2128\n-1 -1\n", "output": ["0\n"]}, {"input": "2 434\n142 377\n", "output": ["434\n"]}, {"input": "2 63\n23 114\n", "output": ["63\n"]}, {"input": "1 838\n-1 366\n", "output": ["0\n"]}, {"input": "2 4\n-1 1\n", "output": ["3\n"]}, {"input": "10 9\n-1 0 -1 1 0 2 2 3 4 3\n", "output": ["688133507\n"]}, {"input": "2 2\n2 -1\n", "output": ["1\n"]}, {"input": "1 2000\n1280 0\n", "output": ["0\n"]}, {"input": "1 1986\n-2 1990\n", "output": ["0\n"]}, {"input": "2 434\n142 67\n", "output": ["434\n"]}, {"input": "2 63\n24 114\n", "output": ["63\n"]}, {"input": "2 311\n3222 -1\n", "output": ["310\n"]}, {"input": "2 449\n678 -1\n", "output": ["448\n"]}, {"input": "2 1250\n23 181\n", "output": ["1250\n"]}, {"input": "2 10\n3 3\n", "output": ["0\n"]}, {"input": "2 2\n2 0\n", "output": ["2\n"]}, {"input": "1 1588\n1280 0\n", "output": ["0\n"]}, {"input": "2 434\n142 108\n", "output": ["434\n"]}, {"input": "1 63\n24 114\n", "output": ["0\n"]}, {"input": "2 3\n-1 0\n", "output": ["2\n"]}, {"input": "2 449\n337 -1\n", "output": ["448\n"]}, {"input": "2 1250\n23 110\n", "output": ["1250\n"]}, {"input": "2 18\n3 3\n", "output": ["0\n"]}, {"input": "2 2\n2 1\n", "output": ["2\n"]}, {"input": "1 1588\n1280 -1\n", "output": ["0\n"]}, {"input": "2 434\n277 108\n", "output": ["434\n"]}, {"input": "2 1250\n15 110\n", "output": ["1250\n"]}, {"input": "3 9\n-1 0 -1 0 0 2 2 3 4 5\n", "output": ["92\n"]}, {"input": "2 2\n3 1\n", "output": ["2\n"]}, {"input": "1 1588\n1326 -1\n", "output": ["0\n"]}, {"input": "2 434\n277 214\n", "output": ["434\n"]}], "source_codes": ["\nimport sys\nimport threading\nfrom collections import Counter\n\nMOD = 10**9 + 7\n\ndef main():\n    import sys\n    input = sys.stdin.read\n    data = input().split()\n    \n    n = int(data[0])\n    k = int(data[1])\n    a = list(map(int, data[2:2+n]))\n    \n    c = a.count(-1)\n    original = [x for x in a if x != -1]\n    d = len(set(original))\n    \n    # Precompute harmonic numbers and their modular inverses up to 3n\n    max_h = 3 * n\n    h = [0] * (max_h + 1)\n    for i in range(1, max_h + 1):\n        h[i] = (h[i - 1] + pow(i, MOD - 2, MOD)) % MOD\n    \n    # Compute expected number of distinct values\n    if k == 0:\n        print(0)\n        return\n    \n    # Expected number of distinct values after replacing -1s\n    # Using linearity of expectation\n    expected_distinct = d\n    for _ in range(c):\n        expected_distinct += (k - expected_distinct) * pow(k, MOD - 2, MOD) % MOD\n    \n    expected_distinct = min(expected_distinct, max_h)\n    print(h[expected_distinct] % MOD)\n\nthreading.Thread(target=main).start()\n\n\n"], "responses": ["```python\nimport sys\nimport threading\nfrom collections import Counter\n\nMOD = 10**9 + 7\n\ndef main():\n    import sys\n    input = sys.stdin.read\n    data = input().split()\n    \n    n = int(data[0])\n    k = int(data[1])\n    a = list(map(int, data[2:2+n]))\n    \n    c = a.count(-1)\n    original = [x for x in a if x != -1]\n    d = len(set(original))\n    \n    # Precompute harmonic numbers and their modular inverses up to 3n\n    max_h = 3 * n\n    h = [0] * (max_h + 1)\n    for i in range(1, max_h + 1):\n        h[i] = (h[i - 1] + pow(i, MOD - 2, MOD)) % MOD\n    \n    # Compute expected number of distinct values\n    if k == 0:\n        print(0)\n        return\n    \n    # Expected number of distinct values after replacing -1s\n    # Using linearity of expectation\n    expected_distinct = d\n    for _ in range(c):\n        expected_distinct += (k - expected_distinct) * pow(k, MOD - 2, MOD) % MOD\n    \n    expected_distinct = min(expected_distinct, max_h)\n    print(h[expected_distinct] % MOD)\n\nthreading.Thread(target=main).start()\n```"], "prompt_tokens": [4561], "completion_tokens": [1847], "no_of_try": 1, "is_solved": false, "language": "Python3", "task_id": 1575}
